------------------------------------------------------------------------
r2722 | sdake | 2010-03-23 13:35:23 -0700 (Tue, 23 Mar 2010) | 6 lines

Merge trunk revision 2721:
r2721 | sdake | 2010-03-23 10:16:39 -0700 (Tue, 23 Mar 2010) | 2 lines

Tone down noisy logging from ipcs system.


------------------------------------------------------------------------
r2720 | sdake | 2010-03-22 15:11:48 -0700 (Mon, 22 Mar 2010) | 7 lines

Merge trunk revision 2719:
r2719 | sdake | 2010-03-22 15:07:01 -0700 (Mon, 22 Mar 2010) | 3 lines

Fix lockup that occurs rarely with pthread_join() is called in atexit()
handler.


------------------------------------------------------------------------
r2718 | sdake | 2010-03-22 09:37:37 -0700 (Mon, 22 Mar 2010) | 8 lines

Merge trunk revision 2685:
------------------------------------------------------------------------
r2685 | sdake | 2010-03-20 13:08:38 -0700 (Sat, 20 Mar 2010) | 3 lines

Fix problem where retransmissions don't occur resulting in failure to receive
condition.


------------------------------------------------------------------------
r2717 | sdake | 2010-03-22 09:36:27 -0700 (Mon, 22 Mar 2010) | 6 lines

Merge trunk revision 2682:
r2682 | asalkeld | 2010-03-10 17:27:04 -0700 (Wed, 10 Mar 2010) | 2 lines

Remove warnings.


------------------------------------------------------------------------
r2716 | sdake | 2010-03-22 09:34:23 -0700 (Mon, 22 Mar 2010) | 11 lines

Merge trunk revision 2676:
r2676 | honzaf | 2010-03-04 05:17:47 -0700 (Thu, 04 Mar 2010) | 7 lines

Support for lib_cpg_finalize

Add support for MESSAGE_REQ_CPG_FINALIZE message. This will allow us
remove cpg_pd from list of active connections, and remove problem, when
cpg_finalize + cpg_initialize + cpg_join can result in CPG_ERR_EXIST
error.


------------------------------------------------------------------------
r2715 | sdake | 2010-03-22 09:33:01 -0700 (Mon, 22 Mar 2010) | 18 lines

Merge trunk revision 2675:
r2675 | honzaf | 2010-03-04 05:12:24 -0700 (Thu, 04 Mar 2010) | 14 lines

Cpg join with undelivered leave message

Patch handles situation, when on one node, one process:
- join cpg
- do same actions
- leave cpg
- join cpg again

Following sequence can (racy) end with broken process_info list.

To solve this problem, one more check is done in
message_handler_req_lib_cpg_join so if process_info with same pid and
group as new join request exists, CPG_ERR_TRY_AGAIN is returned.


------------------------------------------------------------------------
r2714 | sdake | 2010-03-22 09:32:28 -0700 (Mon, 22 Mar 2010) | 6 lines

Merge trunk revision 2674:
r2674 | asalkeld | 2010-03-03 14:52:08 -0700 (Wed, 03 Mar 2010) | 2 lines

Fix some "make lint" problems


------------------------------------------------------------------------
r2713 | sdake | 2010-03-22 09:31:33 -0700 (Mon, 22 Mar 2010) | 6 lines

Merge trunk revision 2673:
r2673 | sdake | 2010-03-03 12:43:50 -0700 (Wed, 03 Mar 2010) | 2 lines

Specify the ringnumber parameter must start at 0 in the corosync.conf man page.


------------------------------------------------------------------------
r2712 | sdake | 2010-03-22 09:31:11 -0700 (Mon, 22 Mar 2010) | 5 lines

Merge trunk revision 2672:
r2672 | sdake | 2010-03-03 12:19:12 -0700 (Wed, 03 Mar 2010) | 2 lines

Fix error handling to avoid segfaults/leaks on error in coroipcc_service_connect.

------------------------------------------------------------------------
r2711 | sdake | 2010-03-22 09:30:00 -0700 (Mon, 22 Mar 2010) | 8 lines

Merge trunk revision 2667:
r2667 | chrissie | 2010-02-26 08:30:38 -0700 (Fri, 26 Feb 2010) | 5 lines

Reduce the number of times the quorum message is displayed.

Patch from David Teigland


------------------------------------------------------------------------
r2710 | sdake | 2010-03-22 09:28:48 -0700 (Mon, 22 Mar 2010) | 6 lines

Merge trunk revision 2666:
r2666 | asalkeld | 2010-02-25 12:29:49 -0700 (Thu, 25 Feb 2010) | 2 lines

convert giduid calls to reentrant versions.


------------------------------------------------------------------------
r2709 | sdake | 2010-03-22 09:27:41 -0700 (Mon, 22 Mar 2010) | 5 lines

r2665 | asalkeld | 2010-02-25 12:28:36 -0700 (Thu, 25 Feb 2010) | 2 lines

convert strerror() into strerror_r()


------------------------------------------------------------------------
r2708 | sdake | 2010-03-22 09:27:08 -0700 (Mon, 22 Mar 2010) | 6 lines

Merge trunk revision 2664:
r2664 | asalkeld | 2010-02-25 12:26:54 -0700 (Thu, 25 Feb 2010) | 2 lines

convert readdir into readdir_r


------------------------------------------------------------------------
r2707 | sdake | 2010-03-22 09:25:55 -0700 (Mon, 22 Mar 2010) | 6 lines

Merge trunk revision 2663:
r2663 | asalkeld | 2010-02-25 12:25:20 -0700 (Thu, 25 Feb 2010) | 2 lines

convert strtok to strtok_r


------------------------------------------------------------------------
r2706 | sdake | 2010-03-22 09:25:12 -0700 (Mon, 22 Mar 2010) | 6 lines

Merge trunk revision 2661:
r2661 | asalkeld | 2010-02-18 13:10:36 -0700 (Thu, 18 Feb 2010) | 2 lines

Correct testcpg's groupname.length


------------------------------------------------------------------------
r2705 | sdake | 2010-03-22 09:24:29 -0700 (Mon, 22 Mar 2010) | 7 lines

Merge trunk revision 2660:
r2660 | sdake | 2010-02-18 13:08:39 -0700 (Thu, 18 Feb 2010) | 3 lines

Patch to set unset value in token hold cancel structure as to not crash
wireshark.


------------------------------------------------------------------------
r2704 | sdake | 2010-03-22 09:21:32 -0700 (Mon, 22 Mar 2010) | 11 lines

Merge trunk revision 2657:
r2657 | honzaf | 2010-02-16 04:29:14 -0700 (Tue, 16 Feb 2010) | 7 lines

Fix corosync shutdown process

This patch change corosync shutdown process, so now:
- exit function of service engine is called
- all IPC connections are closed and removed from poll
- service engine is unlocked


------------------------------------------------------------------------
r2703 | sdake | 2010-03-22 09:20:53 -0700 (Mon, 22 Mar 2010) | 7 lines

Merge trunk revision 2656:
r2656 | sdake | 2010-02-15 14:39:33 -0700 (Mon, 15 Feb 2010) | 3 lines

Use nodeid instead of localhost ip for the case when binding to a
loalhost interface.


------------------------------------------------------------------------
r2702 | sdake | 2010-03-22 09:20:30 -0700 (Mon, 22 Mar 2010) | 9 lines

Merge trunk revision 2655:
r2655 | chrissie | 2010-02-12 00:46:02 -0700 (Fri, 12 Feb 2010) | 6 lines

Remove a double list_del() when a tracking CFG client shuts down without
calling cfg_track_stop. This caused corosync to crash.

The extra list_empty() check is redundant too because it also happens in remove_ci_from_shutdown()


------------------------------------------------------------------------
r2701 | sdake | 2010-03-22 09:19:31 -0700 (Mon, 22 Mar 2010) | 6 lines

Merge trunk revision 2654:
r2654 | sdake | 2010-02-04 14:36:21 -0700 (Thu, 04 Feb 2010) | 2 lines

Merge of Dejan's on=yes patch for the config parser options to ease migration.


------------------------------------------------------------------------
r2700 | sdake | 2010-03-22 09:19:02 -0700 (Mon, 22 Mar 2010) | 5 lines

r2653 | asalkeld | 2010-02-03 17:18:51 -0700 (Wed, 03 Feb 2010) | 2 lines

pass transitional members into the sync_init() callbacks.


------------------------------------------------------------------------
r2699 | sdake | 2010-03-22 09:18:36 -0700 (Mon, 22 Mar 2010) | 7 lines

Merge trunk revision 2652:
r2652 | asalkeld | 2010-02-03 17:13:27 -0700 (Wed, 03 Feb 2010) | 2 lines

move sync_v2_init() into main_service_ready



------------------------------------------------------------------------
r2698 | sdake | 2010-03-22 09:18:06 -0700 (Mon, 22 Mar 2010) | 6 lines

Merge trunk revision 2651:
r2651 | asalkeld | 2010-02-01 23:24:01 -0700 (Mon, 01 Feb 2010) | 3 lines

totemsrp: fix transitional configuration changes with long token timeouts


------------------------------------------------------------------------
r2697 | sdake | 2010-03-22 09:17:35 -0700 (Mon, 22 Mar 2010) | 7 lines

Merge trunk revision 2650:
r2650 | sdake | 2010-01-30 16:02:40 -0700 (Sat, 30 Jan 2010) | 3 lines

Fix coroipcs message corruption that occurs when a message fills the remainder
of the dispatch buffer with a full message.


------------------------------------------------------------------------
r2696 | sdake | 2010-03-22 09:16:56 -0700 (Mon, 22 Mar 2010) | 10 lines

Merge trunk revision 2649:

r2649 | honzaf | 2010-01-22 02:45:29 -0700 (Fri, 22 Jan 2010) | 5 lines

Add schedwrk_create_nolock function

This patch adds schedwrk_create_nolock, which will not call
serialize_lock before execution of callback.


------------------------------------------------------------------------
r2695 | sdake | 2010-03-22 09:16:12 -0700 (Mon, 22 Mar 2010) | 5 lines

r2648 | honzaf | 2010-01-21 05:48:30 -0700 (Thu, 21 Jan 2010) | 2 lines

Pass correct poll handle to poll_stop on exit


------------------------------------------------------------------------
r2694 | sdake | 2010-03-22 09:15:35 -0700 (Mon, 22 Mar 2010) | 9 lines

Merge trunk revision 2647:
r2647 | honzaf | 2010-01-21 05:46:09 -0700 (Thu, 21 Jan 2010) | 5 lines

poll_dispatch_delete - ability to return 0

Patch fixes poll_dispatch_delete, so it is able to return 0
(success), when requested FD was found.


------------------------------------------------------------------------
r2693 | sdake | 2010-03-22 09:15:12 -0700 (Mon, 22 Mar 2010) | 10 lines

Merge trunk revision 2646:
r2646 | honzaf | 2010-01-20 06:22:38 -0700 (Wed, 20 Jan 2010) | 5 lines

Fix setting invalid mode in log destination

This fixes problem in revision 2642, when only last

line of log destination setting is really applied.


------------------------------------------------------------------------
r2692 | sdake | 2010-03-22 09:14:22 -0700 (Mon, 22 Mar 2010) | 11 lines

r2644 | honzaf | 2010-01-14 05:54:46 -0700 (Thu, 14 Jan 2010) | 8 lines

Fix malloc deadlock in signal handler

This patch solves situations, where malloc is called
inside signal handler. It creates thread, which waits
for semaphore unlock and then starts shutdown sequence.

RHBZ#547511


------------------------------------------------------------------------
r2691 | sdake | 2010-03-22 09:13:48 -0700 (Mon, 22 Mar 2010) | 11 lines

r2643 | honzaf | 2010-01-14 01:39:06 -0700 (Thu, 14 Jan 2010) | 8 lines

Fix freeze of IPC library connection on sem_wait

This patch solves library waiting on sem_wait. It doesn't
solve all other problems, which can make corosync not
to exit (malloc race, global lock deadlock, ...)

RHBZ#547511


------------------------------------------------------------------------
r2690 | sdake | 2010-03-22 09:12:29 -0700 (Mon, 22 Mar 2010) | 10 lines

Merge trunk revisoin 2642:
r2642 | honzaf | 2010-01-13 02:52:07 -0700 (Wed, 13 Jan 2010) | 6 lines

Fix coroparse to allow white chars before comment

- allows white characters before #
- new function to parse log destinations (remove code duplicity)
- clarify man page


------------------------------------------------------------------------
r2689 | sdake | 2010-03-22 09:10:40 -0700 (Mon, 22 Mar 2010) | 10 lines

Merge trunk revision 2641:
r2641 | honzaf | 2010-01-11 03:12:17 -0700 (Mon, 11 Jan 2010) | 5 lines

Generate nodeid value when unset on BSD

Generated nodeid is generated in same way as
on Linux is.



------------------------------------------------------------------------
r2688 | sdake | 2010-03-22 09:09:40 -0700 (Mon, 22 Mar 2010) | 6 lines

Merge trunk revision 2640:
r2640 | sdake | 2009-12-15 12:22:36 -0700 (Tue, 15 Dec 2009) | 2 lines

Remove invalid assertion in totemsrp.


------------------------------------------------------------------------
r2687 | sdake | 2010-03-22 09:08:57 -0700 (Mon, 22 Mar 2010) | 11 lines

Merge trunk revision 2639:
r2639 | beekhof | 2009-12-15 04:52:48 -0700 (Tue, 15 Dec 2009) | 7 lines

Correctly determine current state in init script

If two stop actions are ever performed simultaneously, then neither will terminate.
With the default implementaiton of __pids_pidof, the status() function from
/etc/init.d/functions incorrectly thinks the other stop action is a real
corosync process.


------------------------------------------------------------------------
r2686 | sdake | 2010-03-22 09:08:23 -0700 (Mon, 22 Mar 2010) | 6 lines

Merge trunk revision 2638:
r2638 | asalkeld | 2009-12-08 00:48:53 -0700 (Tue, 08 Dec 2009) | 2 lines

Allow empty (default) consensus timeout.


------------------------------------------------------------------------
r2637 | sdake | 2009-12-07 18:09:51 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2581:
r2581 | sdake | 2009-12-07 17:02:00 -0700 (Mon, 07 Dec 2009) | 2 lines

Bump verion to 1.2.0.


------------------------------------------------------------------------
r2636 | sdake | 2009-12-07 18:04:57 -0700 (Mon, 07 Dec 2009) | 2 lines

Fix merge conflicts.

------------------------------------------------------------------------
r2635 | sdake | 2009-12-07 17:42:25 -0700 (Mon, 07 Dec 2009) | 5 lines

Merge trunk revision 2580:
r2580 | sdake | 2009-12-07 17:01:39 -0700 (Mon, 07 Dec 2009) | 2 lines

Remove string overwrite if many recovery messages are originated.

------------------------------------------------------------------------
r2634 | sdake | 2009-12-07 17:41:46 -0700 (Mon, 07 Dec 2009) | 5 lines

Merge trunk revision 2579:
r2579 | sdake | 2009-12-07 16:23:42 -0700 (Mon, 07 Dec 2009) | 2 lines

Remove compiler warning in vsf_quorum.c.

------------------------------------------------------------------------
r2633 | sdake | 2009-12-07 17:41:18 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2578:
r2578 | sdake | 2009-12-07 16:21:01 -0700 (Mon, 07 Dec 2009) | 2 lines

Remove compiler warning in totemsrp.


------------------------------------------------------------------------
r2632 | sdake | 2009-12-07 17:40:53 -0700 (Mon, 07 Dec 2009) | 5 lines

Merge trunk revision 2577:
r2577 | sdake | 2009-12-07 16:18:44 -0700 (Mon, 07 Dec 2009) | 2 lines

Update to AUTHORS file.

------------------------------------------------------------------------
r2631 | sdake | 2009-12-07 17:40:23 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2576:
r2576 | fabbione | 2009-12-07 16:13:34 -0700 (Mon, 07 Dec 2009) | 2 lines

Update spec file to deal with new libsam


------------------------------------------------------------------------
r2630 | sdake | 2009-12-07 17:39:52 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2575:
r2575 | fabbione | 2009-12-07 16:13:14 -0700 (Mon, 07 Dec 2009) | 2 lines

Generate .pc file for new libsam


------------------------------------------------------------------------
r2629 | sdake | 2009-12-07 17:39:25 -0700 (Mon, 07 Dec 2009) | 5 lines

Merge trunk revision 2574:
r2574 | sdake | 2009-12-07 15:40:49 -0700 (Mon, 07 Dec 2009) | 2 lines

SAM man pages.

------------------------------------------------------------------------
r2628 | sdake | 2009-12-07 17:38:51 -0700 (Mon, 07 Dec 2009) | 7 lines

Merge trunk revision 2573:
r2573 | sdake | 2009-12-07 11:41:49 -0700 (Mon, 07 Dec 2009) | 3 lines

Set boolean indicating the retrans flag was set to 1 to 0 when setting retrans
flag in token to zero.


------------------------------------------------------------------------
r2627 | sdake | 2009-12-07 17:38:18 -0700 (Mon, 07 Dec 2009) | 7 lines

Merge trunk revision 2572:
r2572 | sdake | 2009-12-07 11:22:48 -0700 (Mon, 07 Dec 2009) | 3 lines

Make assertions for range checking of message delivery check with the define
instead of magic numbers that are not valid if the define changes.


------------------------------------------------------------------------
r2626 | sdake | 2009-12-07 17:37:43 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2571:
r2571 | honzaf | 2009-12-07 10:14:44 -0700 (Mon, 07 Dec 2009) | 2 lines

Remove potentially thread unsafe call of strftime


------------------------------------------------------------------------
r2625 | sdake | 2009-12-07 17:37:12 -0700 (Mon, 07 Dec 2009) | 11 lines

Merge trunk revision 2570:
r2570 | honzaf | 2009-12-07 10:06:53 -0700 (Mon, 07 Dec 2009) | 8 lines

SAM implementation merge

The SAM library provide a tool to check the health
of an application. The main purpose of SAM is to restart
a local process when it fails to respond to a healthcheck
request in a configured time interval.


------------------------------------------------------------------------
r2624 | sdake | 2009-12-07 17:36:27 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2569:
r2569 | sdake | 2009-12-06 22:03:25 -0700 (Sun, 06 Dec 2009) | 2 lines

Prevent lockup in recovery state in totem after 206 messages are originated.


------------------------------------------------------------------------
r2623 | sdake | 2009-12-07 17:35:56 -0700 (Mon, 07 Dec 2009) | 6 lines

r2568 | sdake | 2009-12-06 22:02:28 -0700 (Sun, 06 Dec 2009) | 3 lines

Fix recovery messages to be proper length to remove segfault that occurs during
recovery.


------------------------------------------------------------------------
r2622 | sdake | 2009-12-07 17:35:35 -0700 (Mon, 07 Dec 2009) | 9 lines

Merge trunk revision 2567:
r2567 | sdake | 2009-12-05 18:35:05 -0700 (Sat, 05 Dec 2009) | 5 lines

Force consensus timer to be at minimum 1.2 * token to prevent one group of
nodes from executing a token timeout in the COMMIT state while another node
executes a consensus timeout, showing to applications as a temporary network
partition.


------------------------------------------------------------------------
r2621 | sdake | 2009-12-07 17:35:04 -0700 (Mon, 07 Dec 2009) | 5 lines

Merge trunk revision 2566:
r2566 | chrissie | 2009-12-04 09:11:49 -0700 (Fri, 04 Dec 2009) | 2 lines

Make man page match reality of totem configuration values.

------------------------------------------------------------------------
r2620 | sdake | 2009-12-07 17:34:39 -0700 (Mon, 07 Dec 2009) | 11 lines

Merge trunk revision 2565:
r2565 | chrissie | 2009-12-04 09:10:59 -0700 (Fri, 04 Dec 2009) | 8 lines

This puts multiple nodeids on each [QUORUM] Members line instead of
putting each nodeid on a separate line.  With more than a few nodes the
excessive lines become a real nuisance, and anyone up around 32 nodes
may literally be scrolling through hundreds of those lines.

from David teigland


------------------------------------------------------------------------
r2619 | sdake | 2009-12-07 17:34:07 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2564:
r2564 | asalkeld | 2009-12-03 11:18:29 -0700 (Thu, 03 Dec 2009) | 2 lines

stats: don't calloc the totemsrp stats struct.


------------------------------------------------------------------------
r2618 | sdake | 2009-12-07 17:33:10 -0700 (Mon, 07 Dec 2009) | 5 lines

r2563 | asalkeld | 2009-12-03 11:13:52 -0700 (Thu, 03 Dec 2009) | 2 lines

Correct some ugly indentation.


------------------------------------------------------------------------
r2617 | sdake | 2009-12-07 17:32:47 -0700 (Mon, 07 Dec 2009) | 5 lines

Merge trunk revision 2562:
r2562 | asalkeld | 2009-12-03 01:36:31 -0700 (Thu, 03 Dec 2009) | 2 lines

objdb: fix memory leaks when objects are destroyed.

------------------------------------------------------------------------
r2616 | sdake | 2009-12-07 17:32:21 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2561:
r2561 | asalkeld | 2009-12-02 15:14:00 -0700 (Wed, 02 Dec 2009) | 2 lines

make sure key_names past from confdb are null terminated.


------------------------------------------------------------------------
r2615 | sdake | 2009-12-07 17:31:43 -0700 (Mon, 07 Dec 2009) | 11 lines

r2560 | honzaf | 2009-12-02 08:09:18 -0700 (Wed, 02 Dec 2009) | 8 lines

bsd: Fix mlockall on FreeBSD version >= 8.0

FreeBSD version 8.0 and greater supports mlockall
syscall correctly. So configure.ac is changed to detect
FreeBSD version and main.c is changed to support it.

Resolves: rhbz#513687


------------------------------------------------------------------------
r2614 | sdake | 2009-12-07 17:31:05 -0700 (Mon, 07 Dec 2009) | 5 lines

r2559 | fabbione | 2009-12-01 23:30:27 -0700 (Tue, 01 Dec 2009) | 2 lines

spec file cleanup


------------------------------------------------------------------------
r2613 | sdake | 2009-12-07 17:30:30 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2558:
r2558 | fabbione | 2009-11-30 16:01:51 -0700 (Mon, 30 Nov 2009) | 3 lines

Fix threads vs fork init order


------------------------------------------------------------------------
r2612 | sdake | 2009-12-07 17:29:57 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2557:
r2557 | fabbione | 2009-11-30 14:28:30 -0700 (Mon, 30 Nov 2009) | 3 lines

Fix stop regression


------------------------------------------------------------------------
r2611 | sdake | 2009-12-07 17:28:31 -0700 (Mon, 07 Dec 2009) | 5 lines

r2556 | fabbione | 2009-11-30 13:18:48 -0700 (Mon, 30 Nov 2009) | 3 lines

Expose service.d config directory


------------------------------------------------------------------------
r2610 | sdake | 2009-12-07 17:28:12 -0700 (Mon, 07 Dec 2009) | 6 lines

r2555 | sdake | 2009-11-30 12:11:20 -0700 (Mon, 30 Nov 2009) | 3 lines

Start pause timer at initialization so first gather doesn't result in pause
timeout operations.


------------------------------------------------------------------------
r2609 | sdake | 2009-12-07 17:27:38 -0700 (Mon, 07 Dec 2009) | 6 lines

merge trunk revision 2554:
r2554 | fabbione | 2009-11-30 11:56:28 -0700 (Mon, 30 Nov 2009) | 3 lines

Clean up init scripts and make a single generic one


------------------------------------------------------------------------
r2608 | sdake | 2009-12-07 17:27:08 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2553:
r2553 | asalkeld | 2009-11-29 11:42:00 -0700 (Sun, 29 Nov 2009) | 3 lines

Rename totem_new_msg_signal() to something more generic.


------------------------------------------------------------------------
r2607 | sdake | 2009-12-07 17:26:40 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2552:
r2552 | asalkeld | 2009-11-29 11:28:39 -0700 (Sun, 29 Nov 2009) | 3 lines

coroipcs: Add a queue_size stats counter to each ipc connection.


------------------------------------------------------------------------
r2606 | sdake | 2009-12-07 17:26:13 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2551:
r2551 | asalkeld | 2009-11-29 11:25:51 -0700 (Sun, 29 Nov 2009) | 3 lines

coroipcs: add logging for flow control state changes.


------------------------------------------------------------------------
r2605 | sdake | 2009-12-07 17:25:45 -0700 (Mon, 07 Dec 2009) | 6 lines

r2550 | sdake | 2009-11-27 15:59:48 -0700 (Fri, 27 Nov 2009) | 3 lines

Patch to use proper IFA on Linux platforms to match interface addresses when
netmask is not 255.255.255.0.


------------------------------------------------------------------------
r2604 | sdake | 2009-12-07 17:25:21 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2549:
r2549 | asalkeld | 2009-11-22 17:32:31 -0700 (Sun, 22 Nov 2009) | 2 lines

COVERITY 4: remove dead code in XYZ_dispatch().


------------------------------------------------------------------------
r2603 | sdake | 2009-12-07 17:24:38 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2548:
r2548 | asalkeld | 2009-11-22 16:59:51 -0700 (Sun, 22 Nov 2009) | 2 lines

COVERITY 17: fix exit handling in show_votes().


------------------------------------------------------------------------
r2602 | sdake | 2009-12-07 17:23:55 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2547:
r2547 | asalkeld | 2009-11-22 16:19:41 -0700 (Sun, 22 Nov 2009) | 1 line

COVERITY 12: prevent overrun of logsys output buffers.


------------------------------------------------------------------------
r2601 | sdake | 2009-12-07 17:23:26 -0700 (Mon, 07 Dec 2009) | 5 lines

Merge trunk revision 2546:
r2546 | asalkeld | 2009-11-21 23:34:11 -0700 (Sat, 21 Nov 2009) | 2 lines

COVERITY 13: prevent buffer overrun in quorum-tool.

------------------------------------------------------------------------
r2600 | sdake | 2009-12-07 17:22:53 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2545:
r2545 | asalkeld | 2009-11-21 23:29:46 -0700 (Sat, 21 Nov 2009) | 3 lines

COVERITY 11: remove dead code from cpg_iteration_next().


------------------------------------------------------------------------
r2599 | sdake | 2009-12-07 17:22:19 -0700 (Mon, 07 Dec 2009) | 7 lines

Merge trunk revision 2544:
r2544 | asalkeld | 2009-11-21 23:27:09 -0700 (Sat, 21 Nov 2009) | 3 lines

COVERITY 14: free zcb_mapped if memory_map() fails.



------------------------------------------------------------------------
r2598 | sdake | 2009-12-07 17:19:00 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2530:
r2530 | asalkeld | 2009-10-18 11:15:24 -0700 (Sun, 18 Oct 2009) | 3 lines

Add a log_printf function to coroipcs so we can pass the log level


------------------------------------------------------------------------
r2597 | sdake | 2009-12-07 17:18:04 -0700 (Mon, 07 Dec 2009) | 5 lines

r2529 | asalkeld | 2009-10-14 16:05:18 -0700 (Wed, 14 Oct 2009) | 3 lines

Avoid array out of bound error.


------------------------------------------------------------------------
r2596 | sdake | 2009-12-07 17:17:08 -0700 (Mon, 07 Dec 2009) | 8 lines

Merge trunk revision 2522:
r2522 | asalkeld | 2009-10-13 21:06:42 -0700 (Tue, 13 Oct 2009) | 5 lines

stats: prevent a div by zero if totem_count is zero.

patch by Chrissie


------------------------------------------------------------------------
r2595 | sdake | 2009-12-07 17:16:18 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2521:
r2521 | asalkeld | 2009-10-13 01:13:53 -0700 (Tue, 13 Oct 2009) | 2 lines

Fix the OSX build (broken by stats patches)


------------------------------------------------------------------------
r2594 | sdake | 2009-12-07 17:15:32 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2519:
r2519 | asalkeld | 2009-10-12 14:56:23 -0700 (Mon, 12 Oct 2009) | 2 lines

Add some missing calls to increment the relevant stats.


------------------------------------------------------------------------
r2593 | sdake | 2009-12-07 17:14:47 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2518:
r2518 | asalkeld | 2009-10-12 14:50:10 -0700 (Mon, 12 Oct 2009) | 2 lines

allow coroipcs to work without calling stats initialization.


------------------------------------------------------------------------
r2592 | sdake | 2009-12-07 17:14:10 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2517:
r2517 | asalkeld | 2009-10-12 10:30:20 -0700 (Mon, 12 Oct 2009) | 3 lines

Add totem stats to objdb.


------------------------------------------------------------------------
r2591 | sdake | 2009-12-07 17:12:32 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2516:
r2516 | asalkeld | 2009-10-12 10:29:19 -0700 (Mon, 12 Oct 2009) | 3 lines

Remove silly warning in corosync-objdb


------------------------------------------------------------------------
r2590 | sdake | 2009-12-07 17:11:42 -0700 (Mon, 07 Dec 2009) | 2 lines

Fixup merge problem in trunk revision 2515.

------------------------------------------------------------------------
r2589 | sdake | 2009-12-07 17:11:03 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2515 (their's conflict):
r2515 | asalkeld | 2009-10-11 17:39:39 -0700 (Sun, 11 Oct 2009) | 2 lines

Add per service-function statistics.


------------------------------------------------------------------------
r2588 | sdake | 2009-12-07 17:09:15 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2514:
r2514 | asalkeld | 2009-10-11 17:36:55 -0700 (Sun, 11 Oct 2009) | 2 lines

Add connection related statistics to the object db.


------------------------------------------------------------------------
r2587 | sdake | 2009-12-07 17:08:38 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2513:
r2513 | asalkeld | 2009-10-11 16:46:07 -0700 (Sun, 11 Oct 2009) | 2 lines

Test the key value size for typed keys.


------------------------------------------------------------------------
r2586 | sdake | 2009-12-07 17:07:56 -0700 (Mon, 07 Dec 2009) | 9 lines

Merge trunk revision 2512:
r2512 | asalkeld | 2009-10-11 15:53:13 -0700 (Sun, 11 Oct 2009) | 4 lines

teach object_key_increment() key types.

This is so we can increment all integer types correctly.



------------------------------------------------------------------------
r2585 | sdake | 2009-12-07 17:07:23 -0700 (Mon, 07 Dec 2009) | 9 lines

Merge trunk revision 2511:
r2511 | asalkeld | 2009-10-09 20:20:38 -0700 (Fri, 09 Oct 2009) | 6 lines

Add value types to objdb keys.

This allows you to create a key with a know type.
And then get the type with the key value.


------------------------------------------------------------------------
r2584 | sdake | 2009-12-07 17:04:24 -0700 (Mon, 07 Dec 2009) | 8 lines

Merge trunk revision 2543:
r2543 | asalkeld | 2009-11-21 23:22:49 -0700 (Sat, 21 Nov 2009) | 5 lines

COVERITY 18: prevent deref after free.

Event deref_after_free: Dereferencing freed pointer "pi".


------------------------------------------------------------------------
r2583 | sdake | 2009-12-07 17:03:48 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2542:
r2542 | beekhof | 2009-11-05 06:01:25 -0700 (Thu, 05 Nov 2009) | 1 line

Fix compilation on RHEL-4: If _GNU_SOURCE isn't defined, then neither is pthread_spinlock_t and compilation fails


------------------------------------------------------------------------
r2582 | sdake | 2009-12-07 17:03:18 -0700 (Mon, 07 Dec 2009) | 6 lines

Merge trunk revision 2541:
r2541 | beekhof | 2009-10-28 12:09:59 -0700 (Wed, 28 Oct 2009) | 1 line

Prevent daemon from suppressing corefile generation


------------------------------------------------------------------------
r2539 | sdake | 2009-10-22 15:34:49 -0700 (Thu, 22 Oct 2009) | 6 lines

Merge trunk revision 2537:
r2537 | sdake | 2009-10-22 15:30:59 -0700 (Thu, 22 Oct 2009) | 2 lines

Bump version to 1.1.2.


------------------------------------------------------------------------
r2538 | sdake | 2009-10-22 15:31:47 -0700 (Thu, 22 Oct 2009) | 6 lines

Merge trunk revision 2536:
r2536 | sdake | 2009-10-22 15:29:02 -0700 (Thu, 22 Oct 2009) | 2 lines

Revert commit 2523 which results in segfaults under some workloads.


------------------------------------------------------------------------
r2534 | sdake | 2009-10-20 15:42:55 -0700 (Tue, 20 Oct 2009) | 7 lines

Merge trunk revision 2533:
------------------------------------------------------------------------
r2533 | sdake | 2009-10-20 15:40:29 -0700 (Tue, 20 Oct 2009) | 2 lines

Bump revision to 1.1.1.


------------------------------------------------------------------------
r2532 | sdake | 2009-10-20 15:38:50 -0700 (Tue, 20 Oct 2009) | 7 lines

Merge trunk revision 2531 (their's conflict) :
------------------------------------------------------------------------
r2531 | sdake | 2009-10-20 14:07:50 -0700 (Tue, 20 Oct 2009) | 2 lines

Resolve shutdown problems for pacemaker use case.


------------------------------------------------------------------------
r2528 | sdake | 2009-10-14 15:14:32 -0700 (Wed, 14 Oct 2009) | 7 lines

Merge trunk revision 2524:
r2524 | sdake | 2009-10-14 12:06:37 -0700 (Wed, 14 Oct 2009) | 3 lines

Patch from jflesch to fix segfault when using sysv semaphores that the thread
state is checked prior to the semaphore operation, not after it has completed.


------------------------------------------------------------------------
r2527 | sdake | 2009-10-14 15:13:17 -0700 (Wed, 14 Oct 2009) | 8 lines

Merge trunk revision 2523:
r2523 | sdake | 2009-10-14 11:56:54 -0700 (Wed, 14 Oct 2009) | 4 lines

totem process group optimization to not copy data into staging buffer if
it is to be immediately ordered by totemsrp.  Instead pass that data as an
iovector element.


------------------------------------------------------------------------
r2526 | sdake | 2009-10-14 15:11:38 -0700 (Wed, 14 Oct 2009) | 6 lines

Merge trunk revision 2520:
r2520 | beekhof | 2009-10-12 23:16:14 -0700 (Mon, 12 Oct 2009) | 1 line

Add SIGTERM support and have the init script wait for corosync to actually terminate. Bud rh#525552


------------------------------------------------------------------------
r2525 | sdake | 2009-10-14 15:05:45 -0700 (Wed, 14 Oct 2009) | 16 lines

Merge trunk revision 2510:
r2510 | chrissie | 2009-10-06 05:57:35 -0700 (Tue, 06 Oct 2009) | 13 lines

This patche fixes a couple of small problems with votequorum:

- if a single node is booted with votequorum loaded then
   corosync-quorumtool shows zero nodes and no votes.
- votequorum doesn't always tell the main quorum module when a new node
has joined the cluster (principally itself. this bug is actually tied
into the above)

I've also added quorum to the default list of services. As quorum has
been decoupled from sync it will not interfere with normal operations as
it used to do and it makes more sense to have it there than not.


------------------------------------------------------------------------
r2508 | sdake | 2009-09-25 02:22:25 -0700 (Fri, 25 Sep 2009) | 6 lines

Merge trunk revision 2507:
r2507 | fabbione | 2009-09-25 01:55:43 -0700 (Fri, 25 Sep 2009) | 2 lines

Update spec file to enable IBA support and sync with 1.1.0 release


------------------------------------------------------------------------
r2506 | sdake | 2009-09-25 01:32:46 -0700 (Fri, 25 Sep 2009) | 2 lines

Fix merge collision which caused make distcheck to fail.

------------------------------------------------------------------------
r2505 | sdake | 2009-09-25 00:01:37 -0700 (Fri, 25 Sep 2009) | 6 lines

Merge trunk revision 2504:
r2504 | sdake | 2009-09-25 00:00:32 -0700 (Fri, 25 Sep 2009) | 2 lines

Change version to 1.1.0 in trunk.


------------------------------------------------------------------------
r2503 | sdake | 2009-09-24 23:56:18 -0700 (Thu, 24 Sep 2009) | 6 lines

Merge trunk revision 2481:
r2481 | sdake | 2009-09-24 23:23:04 -0700 (Thu, 24 Sep 2009) | 2 lines

Totem IBA implementation.


------------------------------------------------------------------------
r2502 | sdake | 2009-09-24 23:55:02 -0700 (Thu, 24 Sep 2009) | 6 lines

Merge trunk revision 2480:
r2480 | sdake | 2009-09-24 23:06:31 -0700 (Thu, 24 Sep 2009) | 2 lines

make main_service_ready function static.


------------------------------------------------------------------------
r2501 | sdake | 2009-09-24 23:54:29 -0700 (Thu, 24 Sep 2009) | 6 lines

Merge trunk revision 2479:
r2479 | sdake | 2009-09-24 23:03:50 -0700 (Thu, 24 Sep 2009) | 2 lines

Remove unused variable in stress_cpgfdget.c.


------------------------------------------------------------------------
r2500 | sdake | 2009-09-24 23:53:53 -0700 (Thu, 24 Sep 2009) | 5 lines

Merge trunk revision 2478:
r2478 | sdake | 2009-09-24 23:01:35 -0700 (Thu, 24 Sep 2009) | 2 lines

Remove pointless warning.

------------------------------------------------------------------------
r2499 | sdake | 2009-09-24 23:53:11 -0700 (Thu, 24 Sep 2009) | 6 lines

Merge trunk revision 2477:
r2477 | asalkeld | 2009-09-24 19:27:50 -0700 (Thu, 24 Sep 2009) | 3 lines

turn off _POSIX_THREAD_PROCESS_SHARED for uclibc


------------------------------------------------------------------------
r2498 | sdake | 2009-09-24 23:51:33 -0700 (Thu, 24 Sep 2009) | 6 lines

Merge trunk revision 2411:
r2411 | asalkeld | 2009-09-09 18:51:32 -0700 (Wed, 09 Sep 2009) | 2 lines

log the built-in features at startup


------------------------------------------------------------------------
r2497 | sdake | 2009-09-24 23:50:17 -0700 (Thu, 24 Sep 2009) | 19 lines

Merge trunk revision 2410:
r2410 | asalkeld | 2009-09-09 11:58:38 -0700 (Wed, 09 Sep 2009) | 17 lines

add small-memory-footprint option to configure

This adds the following option to configure:
--enable-small-memory-footprint

When enabled the following defines are set
to reduce the overall memory footprint.

MESSAGE_SIZE_MAX=1024*64
MESSAGE_QUEUE_MAX=512
PROCESSOR_COUNT_MAX=16
IPC_REQUEST_SIZE=1024*64
IPC_RESPONSE_SIZE=1024*64
IPC_DISPATCH_SIZE=1024*64


------------------------------------------------------------------------
r2496 | sdake | 2009-09-24 23:43:22 -0700 (Thu, 24 Sep 2009) | 6 lines

Merge trunk revision 2407:
r2407 | chrissie | 2009-09-08 01:19:11 -0700 (Tue, 08 Sep 2009) | 2 lines

Really add corosync-quorumtool


------------------------------------------------------------------------
r2495 | sdake | 2009-09-24 23:41:57 -0700 (Thu, 24 Sep 2009) | 6 lines

Merge trunk revision 2406:
r2406 | chrissie | 2009-09-08 01:14:58 -0700 (Tue, 08 Sep 2009) | 2 lines

Add corosync-quorumtool


------------------------------------------------------------------------
r2494 | sdake | 2009-09-24 23:37:33 -0700 (Thu, 24 Sep 2009) | 6 lines

Merge trunk revision 2401:
r2401 | honzaf | 2009-08-31 08:58:12 -0700 (Mon, 31 Aug 2009) | 2 lines

Real add of corosync-cpgtool


------------------------------------------------------------------------
r2493 | sdake | 2009-09-24 23:36:53 -0700 (Thu, 24 Sep 2009) | 6 lines

Merge trunk revision 2400:
r2400 | honzaf | 2009-08-31 02:57:20 -0700 (Mon, 31 Aug 2009) | 2 lines

Initial version of corosync-cpgtool


------------------------------------------------------------------------
r2492 | sdake | 2009-09-24 23:36:15 -0700 (Thu, 24 Sep 2009) | 8 lines

Merge trunk revision 2399:
Implementation of cpg_iteration functions

This functions allows iterate available cpg groups
and their members. API is modelled like ckpt iteration
functions.


------------------------------------------------------------------------
r2491 | sdake | 2009-09-24 23:34:43 -0700 (Thu, 24 Sep 2009) | 6 lines

Merge trunk revision 2389:
r2389 | sdake | 2009-08-17 11:22:51 -0700 (Mon, 17 Aug 2009) | 2 lines

Add test program that finds limits of cpg message size.


------------------------------------------------------------------------
r2490 | sdake | 2009-09-24 23:33:45 -0700 (Thu, 24 Sep 2009) | 9 lines

Merge trunk revision 2372:
r2372 | sdake | 2009-07-26 19:00:05 -0700 (Sun, 26 Jul 2009) | 6 lines

Add notification when totem has completed initialization.

This triggers the initialization of the service engines which may need totem
for initialization.


------------------------------------------------------------------------
r2489 | sdake | 2009-09-24 23:32:48 -0700 (Thu, 24 Sep 2009) | 7 lines

Merge trunk revision 2371:
r2371 | sdake | 2009-07-26 17:29:32 -0700 (Sun, 26 Jul 2009) | 3 lines

Add a target token set completed callback in totemrrp and below layers.
Handle management of callback in totemsrp.


------------------------------------------------------------------------
r2488 | sdake | 2009-09-24 23:31:13 -0700 (Thu, 24 Sep 2009) | 7 lines

Merge trunk revision 2369:
r2369 | sdake | 2009-07-22 15:10:35 -0700 (Wed, 22 Jul 2009) | 3 lines

Optimization of totemsrp and below by removing hdb usage.  cpgbench shows
results of 4% to 20% increase in tps and mbs depending on hardware.


------------------------------------------------------------------------
r2487 | sdake | 2009-09-24 23:30:36 -0700 (Thu, 24 Sep 2009) | 9 lines

Merge trunk revision 2368:
r2368 | honzaf | 2009-07-22 01:25:45 -0700 (Wed, 22 Jul 2009) | 5 lines

Support for service.d

This patch is very similar to uidgid.d patch, but support for loading
services (so read service section).


------------------------------------------------------------------------
r2486 | sdake | 2009-09-24 23:29:46 -0700 (Thu, 24 Sep 2009) | 8 lines

Merge trunk revision 2367 (mine-conflict):
r2367 | sdake | 2009-07-21 11:17:15 -0700 (Tue, 21 Jul 2009) | 4 lines

Initial infrastructure changes to support iba.  Split totemnet into
totemiba and totemudp and have totemnet call the appropriate transport
calls.


------------------------------------------------------------------------
r2485 | sdake | 2009-09-24 23:27:12 -0700 (Thu, 24 Sep 2009) | 9 lines

Merge trunk revision 2363:
r2363 | honzaf | 2009-07-16 05:16:06 -0700 (Thu, 16 Jul 2009) | 5 lines

Add lcoroipcc as build requirement for stress_cpgcontext

This is needed for build without errors on system, where
lcoroipcc is not installed on system yet.


------------------------------------------------------------------------
r2484 | sdake | 2009-09-24 23:26:17 -0700 (Thu, 24 Sep 2009) | 6 lines

Merge trunk revision 2359:
r2359 | sdake | 2009-07-10 05:54:56 -0700 (Fri, 10 Jul 2009) | 2 lines

add stress_cpgcontext.


------------------------------------------------------------------------
r2483 | sdake | 2009-09-24 23:25:32 -0700 (Thu, 24 Sep 2009) | 6 lines

Merge trunk revision 2358:
r2358 | sdake | 2009-07-10 05:29:50 -0700 (Fri, 10 Jul 2009) | 2 lines

Add stress_cpgfdget test case.


------------------------------------------------------------------------
r2482 | sdake | 2009-09-24 23:24:50 -0700 (Thu, 24 Sep 2009) | 6 lines

Merge trunk revision 2357:
r2357 | sdake | 2009-07-10 05:05:48 -0700 (Fri, 10 Jul 2009) | 3 lines

Add stress test case for cpg and coroipcc zero copy buffer alloc and free
operations.

------------------------------------------------------------------------
r2475 | sdake | 2009-09-22 00:51:14 -0700 (Tue, 22 Sep 2009) | 1 line

Bumping version to 1.0.1
------------------------------------------------------------------------
r2474 | sdake | 2009-09-22 00:48:18 -0700 (Tue, 22 Sep 2009) | 6 lines

Merge trunk revision 2473:
r2473 | sdake | 2009-09-22 00:46:24 -0700 (Tue, 22 Sep 2009) | 2 lines

Correct pload printing operation.


------------------------------------------------------------------------
r2471 | sdake | 2009-09-21 13:05:28 -0700 (Mon, 21 Sep 2009) | 2 lines

Fix commit error from previous merge.

------------------------------------------------------------------------
r2470 | sdake | 2009-09-21 12:10:43 -0700 (Mon, 21 Sep 2009) | 6 lines

Merge trunk revision 2468:
r2468 | sdake | 2009-09-21 12:03:16 -0700 (Mon, 21 Sep 2009) | 2 lines

Patch from Jerome to fix segfault in dispatch functions.


------------------------------------------------------------------------
r2469 | sdake | 2009-09-21 12:09:51 -0700 (Mon, 21 Sep 2009) | 6 lines

Merge trunk revision 2467:
r2467 | sdake | 2009-09-21 11:27:37 -0700 (Mon, 21 Sep 2009) | 2 lines

Fix abort with multiple cpg clients under heavy load.


------------------------------------------------------------------------
r2466 | sdake | 2009-09-21 09:20:11 -0700 (Mon, 21 Sep 2009) | 6 lines

Merge trunk revision 2406 of the file lib/coroipcc.c:
r2406 | chrissie | 2009-09-08 01:14:58 -0700 (Tue, 08 Sep 2009) | 2 lines

Add corosync-quorumtool


------------------------------------------------------------------------
r2465 | sdake | 2009-09-19 23:58:37 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2463:
r2463 | sdake | 2009-09-19 23:56:02 -0700 (Sat, 19 Sep 2009) | 2 lines

Remove warning in logsys compile related to const correctness.


------------------------------------------------------------------------
r2464 | sdake | 2009-09-19 23:57:23 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2462:
r2462 | sdake | 2009-09-19 23:53:10 -0700 (Sat, 19 Sep 2009) | 2 lines

Remove warning in coroipcc.


------------------------------------------------------------------------
r2461 | sdake | 2009-09-19 23:37:36 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2419:
r2419 | sdake | 2009-09-19 22:36:52 -0700 (Sat, 19 Sep 2009) | 2 lines

Fix sigpipe handling to ignore sigpipes on systems which support them.


------------------------------------------------------------------------
r2460 | sdake | 2009-09-19 23:36:52 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2418:
r2418 | sdake | 2009-09-19 22:34:41 -0700 (Sat, 19 Sep 2009) | 2 lines

Make delete operation work properly in coropoll.


------------------------------------------------------------------------
r2459 | sdake | 2009-09-19 23:33:52 -0700 (Sat, 19 Sep 2009) | 5 lines

Merge trunk revision:
r2416 | sdake | 2009-09-14 13:27:45 -0700 (Mon, 14 Sep 2009) | 2 lines

Fix error with revision 2415.

------------------------------------------------------------------------
r2458 | sdake | 2009-09-19 23:33:12 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2416:
r2416 | sdake | 2009-09-14 13:27:45 -0700 (Mon, 14 Sep 2009) | 2 lines

Fix error with revision 2415.


------------------------------------------------------------------------
r2457 | sdake | 2009-09-19 23:32:29 -0700 (Sat, 19 Sep 2009) | 7 lines

Merge trunk revision 2415:
r2415 | sdake | 2009-09-14 11:58:08 -0700 (Mon, 14 Sep 2009) | 3 lines

Fix dispatch returning TRY_AGAIN when using DISPATCH_ALL parameter because of
regression caused by revision 2046:lib/coroipcc.c.


------------------------------------------------------------------------
r2456 | sdake | 2009-09-19 23:31:27 -0700 (Sat, 19 Sep 2009) | 15 lines

Merge trunk revision 2409:
r2409 | asalkeld | 2009-09-09 11:55:17 -0700 (Wed, 09 Sep 2009) | 11 lines

don't return the ip address when the mask is not found

Currently totemip_copy (boundto,&ipaddr) is called even when the
required mask is not found.

This patch changes the behavior to only copy the ipaddr when the
mask is found.

The current behavior makes debugging an incorrect config really
confusing.


------------------------------------------------------------------------
r2455 | sdake | 2009-09-19 23:30:47 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2408:
r2408 | asalkeld | 2009-09-08 17:25:36 -0700 (Tue, 08 Sep 2009) | 2 lines

Only insert the filename into the log, not the path.


------------------------------------------------------------------------
r2454 | sdake | 2009-09-19 23:30:07 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2405:
r2405 | fabbione | 2009-09-07 03:41:42 -0700 (Mon, 07 Sep 2009) | 2 lines

Fix missing symbol error when loading plugins without executive


------------------------------------------------------------------------
r2453 | sdake | 2009-09-19 23:29:01 -0700 (Sat, 19 Sep 2009) | 18 lines

Merge trunk revision 2404:
r2404 | asalkeld | 2009-09-07 01:33:23 -0700 (Mon, 07 Sep 2009) | 16 lines

Remove a double unlock in logsys.

In logsys there are a number of XYZ_unlocked() functions that are called
like this:

       pthread_mutex_lock (&logsys_config_mutex);

       XYZ_unlocked();

       pthread_mutex_unlock (&logsys_config_mutex);

The XYZ_unlocked() functions should not do any (un)locking.
But _logsys_config_subsys_get_unlocked() unlocks if it finds the subsys.
This means that there is 1 lock and 2 unlocks.

------------------------------------------------------------------------
r2452 | sdake | 2009-09-19 23:28:24 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2403:
r2403 | chrissie | 2009-09-07 00:28:25 -0700 (Mon, 07 Sep 2009) | 2 lines

Return CS_ERR_NOT_EXIST if a client tries to contact a plugin that isn't loaded.


------------------------------------------------------------------------
r2451 | sdake | 2009-09-19 23:27:43 -0700 (Sat, 19 Sep 2009) | 2 lines

Fix theirs conflict merge conflict revision 2402

------------------------------------------------------------------------
r2450 | sdake | 2009-09-19 23:26:30 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2402 (theirs conflict):
r2402 | fabbione | 2009-09-07 00:24:15 -0700 (Mon, 07 Sep 2009) | 2 lines

Fix corosync-tools linking


------------------------------------------------------------------------
r2449 | sdake | 2009-09-19 23:23:39 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2398:
r2398 | sdake | 2009-08-28 11:20:14 -0700 (Fri, 28 Aug 2009) | 2 lines

Fix off by one calculation error resulting in assertion.


------------------------------------------------------------------------
r2448 | sdake | 2009-09-19 23:22:54 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2397:
r2397 | chrissie | 2009-08-28 02:36:33 -0700 (Fri, 28 Aug 2009) | 2 lines

Send CURRENT callbacks to the dispatch FD rather than the callback one.


------------------------------------------------------------------------
r2447 | sdake | 2009-09-19 23:22:18 -0700 (Sat, 19 Sep 2009) | 8 lines

Merge trunk revision 2396:
r2396 | chrissie | 2009-08-28 02:35:18 -0700 (Fri, 28 Aug 2009) | 5 lines

Fix nodelist passed to the quorum subsystem.

When a node left, the old nodelist was sent, sigh


------------------------------------------------------------------------
r2446 | sdake | 2009-09-19 23:21:28 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2395:
r2395 | sdake | 2009-08-27 18:19:30 -0700 (Thu, 27 Aug 2009) | 2 lines

Fix incorrect assertion with frame sizes of 9000.


------------------------------------------------------------------------
r2445 | sdake | 2009-09-19 23:20:38 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2394:
r2394 | sdake | 2009-08-24 10:50:12 -0700 (Mon, 24 Aug 2009) | 2 lines

Allow finalize routines to occur inside dispatch routines.


------------------------------------------------------------------------
r2444 | sdake | 2009-09-19 23:20:03 -0700 (Sat, 19 Sep 2009) | 10 lines

Merge trunk revision 2392:
Handle NULL callbacks in cpg, evs and confdb lib

Attached patches handle NULL callbacks in *_initialize
and *_dispatch. Handling is same as in quorum service. Now, when
callback is NULL -> no memcpy -> instance callbacks will have all
items set to NULL and in *_dispatch function is not called.

It changes cfg so now we are using continue instead of exit.

------------------------------------------------------------------------
r2443 | sdake | 2009-09-19 23:19:23 -0700 (Sat, 19 Sep 2009) | 10 lines

Merge trunk revision 2391:
r2391 | honzaf | 2009-08-19 02:57:28 -0700 (Wed, 19 Aug 2009) | 7 lines

Fix found_service_ver handling

Sometimes, when object_key_get doesn't return found_service_ver it
doesn't change old value and this value is then used in atoi what
will can cause fall of corosync. Patch fixes this case by setting
found_service_ver to NULL before call of object_key_get.

------------------------------------------------------------------------
r2442 | sdake | 2009-09-19 23:18:44 -0700 (Sat, 19 Sep 2009) | 5 lines

r2390 | honzaf | 2009-08-19 02:55:49 -0700 (Wed, 19 Aug 2009) | 2 lines

Fix systems without _POSIX_THREAD_PROCESS_SHARED


------------------------------------------------------------------------
r2441 | sdake | 2009-09-19 23:18:08 -0700 (Sat, 19 Sep 2009) | 5 lines

Merge trunk revision 2388:
r2388 | sdake | 2009-08-17 11:22:11 -0700 (Mon, 17 Aug 2009) | 2 lines

Proper limits checking for message sizes to allow ~1mb max message sizes for corosync.

------------------------------------------------------------------------
r2440 | sdake | 2009-09-19 23:17:29 -0700 (Sat, 19 Sep 2009) | 7 lines

Merge trunk revision 2387:
r2387 | sdake | 2009-08-17 10:18:26 -0700 (Mon, 17 Aug 2009) | 3 lines

Request user enter characters into terminal if entropy pool is empty for keygen
rather then exiting without creating an auth key.


------------------------------------------------------------------------
r2439 | sdake | 2009-09-19 23:16:53 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2386:
r2386 | jflesch | 2009-08-17 00:36:17 -0700 (Mon, 17 Aug 2009) | 1 line

Fix value returned by lib/coroipcc_dispatch_get() in case recv() fails


------------------------------------------------------------------------
r2438 | sdake | 2009-09-19 23:16:17 -0700 (Sat, 19 Sep 2009) | 8 lines

Merge trunk revision 2385:
r2385 | fabbione | 2009-08-11 23:57:53 -0700 (Tue, 11 Aug 2009) | 5 lines

Delay forking and closing of fds as much as possible
to allow startup wrappers (such as cman_tool) to collect
as much errors as possible in case of startup failure


------------------------------------------------------------------------
r2437 | sdake | 2009-09-19 23:15:43 -0700 (Sat, 19 Sep 2009) | 8 lines

Merge trunk revision 2384:
r2384 | honzaf | 2009-08-10 08:07:40 -0700 (Mon, 10 Aug 2009) | 5 lines

Swap item in cpg_joinlist

This patch add swab of header->size so big endian architectures
works with LE list and vica versa.

------------------------------------------------------------------------
r2436 | sdake | 2009-09-19 23:14:53 -0700 (Sat, 19 Sep 2009) | 11 lines

r2383 | fabbione | 2009-08-09 22:39:45 -0700 (Sun, 09 Aug 2009) | 10 lines

corosync: move logsys thread config with all the others

logsys thread priority was configured after forking the
wthread process and spread the scheduler priority config
across a large chunk of code in main.c

Now that logsys scheduler priority can be invoked at any time,
move the code together with corosync_setscheduler code.

------------------------------------------------------------------------
r2435 | sdake | 2009-09-19 23:14:11 -0700 (Sat, 19 Sep 2009) | 24 lines

Merge trunk revision 2382:
r2382 | fabbione | 2009-08-09 22:32:58 -0700 (Sun, 09 Aug 2009) | 21 lines

logsys: fix segfault in logsys_thread_priority_set

logsys_thread_priority_set expects that wthread is already running
but doesn't perform any check if it is.

if logsys_thread_priority_set is invoked before forking the thread,
a segfault is guaranteed.

this changes to logsys_thread_priority_set ensure that a request
for a new scheduler priority is queued if the wthread is not
created yet and the new scheduler parameters are applied as early
as possible after the thread is created.

At the same time:

- add a few comments on clean up that needs to be done
- remove a redundant check for policy != SCHED_OTHER as that's
  corosync need specific. logsys should simply accept the request
  and apply it.


------------------------------------------------------------------------
r2434 | sdake | 2009-09-19 23:13:26 -0700 (Sat, 19 Sep 2009) | 2 lines

Fix merge conflict in trunk revision 2381 (mine conflict).

------------------------------------------------------------------------
r2433 | sdake | 2009-09-19 23:08:33 -0700 (Sat, 19 Sep 2009) | 10 lines

Merge trunk revision 2381 (mine conflict):
r2381 | honzaf | 2009-08-04 00:39:03 -0700 (Tue, 04 Aug 2009) | 6 lines

Support for -v (version) feature

This can be usefull for easier way to get informations
of the corosync version from users. Version and SVN
revision (get by svninfo -c) are displayed.


------------------------------------------------------------------------
r2432 | sdake | 2009-09-19 23:06:05 -0700 (Sat, 19 Sep 2009) | 9 lines

Merge trunk revision 2380:
r2380 | chrissie | 2009-08-04 00:14:55 -0700 (Tue, 04 Aug 2009) | 6 lines

This patch makes a copy of the notifications list before calling the
reload_notifications callbacks. This allows callback functions to
manipulate the notifications list without causing corruption or strange
loops.


------------------------------------------------------------------------
r2431 | sdake | 2009-09-19 23:05:31 -0700 (Sat, 19 Sep 2009) | 5 lines

Merge trunk revision 2379:
r2379 | sdake | 2009-08-03 17:22:41 -0700 (Mon, 03 Aug 2009) | 2 lines

Use unnamed shared posix semaphores on platforms which support them.

------------------------------------------------------------------------
r2430 | sdake | 2009-09-19 23:04:40 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2378:
r2378 | sdake | 2009-08-03 17:08:11 -0700 (Mon, 03 Aug 2009) | 2 lines

Man page cleanups from Steven Whitehouse for cpg service.


------------------------------------------------------------------------
r2429 | sdake | 2009-09-19 23:04:02 -0700 (Sat, 19 Sep 2009) | 7 lines

Merge trunk revision 2377:
r2377 | sdake | 2009-08-03 17:04:13 -0700 (Mon, 03 Aug 2009) | 3 lines

Always keep autogenerated node ids in totem as LE even on BE arches.
Have testcpg print out autogenerated nodeid properly on BE arch.


------------------------------------------------------------------------
r2428 | sdake | 2009-09-19 23:03:21 -0700 (Sat, 19 Sep 2009) | 11 lines

Merge trunk revision 2376:
r2376 | honzaf | 2009-08-03 01:11:53 -0700 (Mon, 03 Aug 2009) | 8 lines

Support for systems where clock_gettime is not available

On some systems clock_gettime is not available so we are
testing availability and value of _POSIX_MONOTONIC_CLOCK.

On system without support of clock_gettime, we are using
old behaviour with function gettimeofday.

------------------------------------------------------------------------
r2427 | sdake | 2009-09-19 23:02:49 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2374:
r2374 | fabbione | 2009-07-28 10:11:29 -0700 (Tue, 28 Jul 2009) | 2 lines

Fix spec file and update macro usage


------------------------------------------------------------------------
r2426 | sdake | 2009-09-19 23:02:06 -0700 (Sat, 19 Sep 2009) | 9 lines

Merge trunk revision 2373:
r2373 | honzaf | 2009-07-27 03:12:55 -0700 (Mon, 27 Jul 2009) | 5 lines

Support for monotime timer

This patch should solve problems with corosync and ntp, by using
clock_gettime where it make sense.


------------------------------------------------------------------------
r2425 | sdake | 2009-09-19 23:01:05 -0700 (Sat, 19 Sep 2009) | 13 lines

Merge trunk revision 2370:
r2370 | honzaf | 2009-07-23 07:50:56 -0700 (Thu, 23 Jul 2009) | 9 lines

Handle NULL ver string in service

In case user not enter ver: in service section, whole
corosync falled with segfaul, because atoi was called
on NULL.

Now, in case of NULL, we rather not use atoi, and
return 0 directly.


------------------------------------------------------------------------
r2424 | sdake | 2009-09-19 23:00:13 -0700 (Sat, 19 Sep 2009) | 7 lines

Merge trunk revision 2366:
r2366 | sdake | 2009-07-20 18:31:39 -0700 (Mon, 20 Jul 2009) | 3 lines

Darwin is missing the sched_setscheduler system call.
Patch detects it and resolves the build failure.


------------------------------------------------------------------------
r2423 | sdake | 2009-09-19 22:59:24 -0700 (Sat, 19 Sep 2009) | 18 lines

Merge trunk revision 2365:
r2365 | honzaf | 2009-07-20 07:57:06 -0700 (Mon, 20 Jul 2009) | 15 lines

Cpg synchronization patch for conf change messages

The root of the theoretical problem is that cpg_join or cpg_leave
messages are being sent via the C apis between synchronization.  With
the current cpg, synchronization happens in confchg_fn, and then later
in cpg_sync_process.  cpg_sync_process is called much later after
confchg_fn and introduces a small probability of a window of time for
queued in totem (but not yet ordered by totem) for those cpg_join and
cpg_leave operations to interact with the synchronization process which
should happen in one atomic operation but currently is two distinct
operations.

This patch deletes confchg_fn and make sends joinlist/downlist
in cpg_sync_process.

------------------------------------------------------------------------
r2422 | sdake | 2009-09-19 22:58:41 -0700 (Sat, 19 Sep 2009) | 19 lines

Merge trunk revision 2364:
------------------------------------------------------------------------
r2364 | honzaf | 2009-07-20 07:53:18 -0700 (Mon, 20 Jul 2009) | 14 lines

Allow only one connection per (node, pid, grp)

This patch allows only one connection per (node, pid, grp_name) tuple.
This means, you cannot make more connection from one process to same
group_name. This is (I hope) how cpg should behave. In case, you will
try to do that, CPG_ERR_EXISTS error is returned.

Of course, there is no problem with creating:
- more connection with same (pid, grp) if nodeid is different
- more connection with same (node, grp) if pid is different (for example
  after fork, or two distinct processes)
- more connection with same (node, pid) if grp is different (connect
  one process to more cpgs).


------------------------------------------------------------------------
r2421 | sdake | 2009-09-19 22:53:20 -0700 (Sat, 19 Sep 2009) | 5 lines

Merge trunk revision 2360:
r2360 | sdake | 2009-07-13 09:46:13 -0700 (Mon, 13 Jul 2009) | 2 lines

Add NAME entries to manpages.

------------------------------------------------------------------------
r2420 | sdake | 2009-09-19 22:52:12 -0700 (Sat, 19 Sep 2009) | 6 lines

Merge trunk revision 2356:
r2356 | sdake | 2009-07-10 04:49:51 -0700 (Fri, 10 Jul 2009) | 2 lines

Fix segfault when using zcb api of coroipcc under certain loads.


------------------------------------------------------------------------
r2361 | beekhof | 2009-07-14 05:31:29 -0700 (Tue, 14 Jul 2009) | 1 line

Use the preferred prefix for the Pacemaker service
------------------------------------------------------------------------
r2353 | sdake | 2009-07-07 23:31:44 -0700 (Tue, 07 Jul 2009) | 1 line

Bumping version to 1.0.0
------------------------------------------------------------------------
r2352 | sdake | 2009-07-07 22:35:50 -0700 (Tue, 07 Jul 2009) | 6 lines

Merging trunk revision 2348:
r2348 | sdake | 2009-07-07 22:23:33 -0700 (Tue, 07 Jul 2009) | 2 lines

Add poll destroy to coroipcs.


------------------------------------------------------------------------
r2351 | sdake | 2009-07-07 22:35:03 -0700 (Tue, 07 Jul 2009) | 6 lines

Merging trunk revision 2347:
r2347 | sdake | 2009-07-07 22:14:47 -0700 (Tue, 07 Jul 2009) | 2 lines

Add more tested platforms to list.


------------------------------------------------------------------------
r2350 | sdake | 2009-07-07 22:34:10 -0700 (Tue, 07 Jul 2009) | 9 lines

Merging trunk revision 2346:
r2346 | sdake | 2009-07-07 22:06:51 -0700 (Tue, 07 Jul 2009) | 2 lines

Updated INSTALL file.

-gThis line, and those below, will be ignored--

M    flatiron/INSTALL

------------------------------------------------------------------------
r2349 | sdake | 2009-07-07 22:33:07 -0700 (Tue, 07 Jul 2009) | 6 lines

Merging trunk revision 2345:
r2345 | jflesch | 2009-07-02 00:47:04 -0700 (Thu, 02 Jul 2009) | 1 line

BSD support: Fix EOF handling in coroipcs.c:req_setup_recv() and
coroipcs:coroipcs_handler_dispatch()

------------------------------------------------------------------------
r2343 | sdake | 2009-07-01 14:19:30 -0700 (Wed, 01 Jul 2009) | 1 line

Bumping version to 0.100
------------------------------------------------------------------------
r2342 | sdake | 2009-07-01 14:08:24 -0700 (Wed, 01 Jul 2009) | 2 lines

Create flatiron branch.

------------------------------------------------------------------------
r2341 | sdake | 2009-07-01 13:57:37 -0700 (Wed, 01 Jul 2009) | 2 lines

Add ring id field to evs.

------------------------------------------------------------------------
r2340 | sdake | 2009-07-01 13:29:55 -0700 (Wed, 01 Jul 2009) | 2 lines

Set version field in totem header in case it isn't set by default.

------------------------------------------------------------------------
r2339 | sdake | 2009-07-01 13:21:48 -0700 (Wed, 01 Jul 2009) | 2 lines

Pass handle is evs callback functions.

------------------------------------------------------------------------
r2338 | sdake | 2009-07-01 13:04:20 -0700 (Wed, 01 Jul 2009) | 2 lines

Send ERR_SECURITY when invalid security context is provided via ipc clients.

------------------------------------------------------------------------
r2337 | sdake | 2009-07-01 13:03:07 -0700 (Wed, 01 Jul 2009) | 2 lines

Set ERR_SECURITY to 100 to give plenty of room for other people's error codes.

------------------------------------------------------------------------
r2336 | sdake | 2009-07-01 12:55:18 -0700 (Wed, 01 Jul 2009) | 2 lines

Fix build on bsd systems.

------------------------------------------------------------------------
r2335 | sdake | 2009-07-01 12:48:14 -0700 (Wed, 01 Jul 2009) | 2 lines

Align syncv2 on 8 byte boundaries.

------------------------------------------------------------------------
r2334 | sdake | 2009-07-01 12:37:59 -0700 (Wed, 01 Jul 2009) | 2 lines

Make compatibility mode none work properly.

------------------------------------------------------------------------
r2333 | sdake | 2009-07-01 12:19:06 -0700 (Wed, 01 Jul 2009) | 2 lines

Code cleanup for evs service from Wojtek.

------------------------------------------------------------------------
r2332 | honzaf | 2009-07-01 06:36:00 -0700 (Wed, 01 Jul 2009) | 11 lines

Don't deliver cpg messages from unknown nodes

This patch fixes situation, when in the middle of
sync some node will send regular message before
another node will receive confch message, and regular
message is delivered to application. From application
point of view, this node is unknown -> don't expect
any messages.

Now, no such messages are delivered to application.

------------------------------------------------------------------------
r2331 | sdake | 2009-06-30 23:33:22 -0700 (Tue, 30 Jun 2009) | 2 lines

Add context get set man pages for evs.

------------------------------------------------------------------------
r2330 | sdake | 2009-06-30 23:32:49 -0700 (Tue, 30 Jun 2009) | 2 lines

Add new man pages to Makfile.am

------------------------------------------------------------------------
r2329 | sdake | 2009-06-30 23:27:00 -0700 (Tue, 30 Jun 2009) | 2 lines

Add context get and set operations to evs handles and man pages.

------------------------------------------------------------------------
r2328 | sdake | 2009-06-30 23:24:19 -0700 (Tue, 30 Jun 2009) | 2 lines

Add context get/set to See Also section of cpg man pages.

------------------------------------------------------------------------
r2327 | sdake | 2009-06-30 23:20:23 -0700 (Tue, 30 Jun 2009) | 2 lines

Add see also reference to context get/set operation.

------------------------------------------------------------------------
r2325 | sdake | 2009-06-30 23:18:56 -0700 (Tue, 30 Jun 2009) | 2 lines

Add votequorum_context_get/set man pages.

------------------------------------------------------------------------
r2324 | sdake | 2009-06-30 23:18:25 -0700 (Tue, 30 Jun 2009) | 2 lines

Add man pages for confdb_context_get/set operations.

------------------------------------------------------------------------
r2323 | meyering | 2009-06-30 02:27:27 -0700 (Tue, 30 Jun 2009) | 3 lines

remove unnecessary #include

* exec/evil.c: Don't include <signal.h>.
------------------------------------------------------------------------
r2322 | meyering | 2009-06-30 02:27:20 -0700 (Tue, 30 Jun 2009) | 7 lines

remove trailing blanks

* corosync.spec.in:
* exec/evil.c:
* exec/main.c:
* exec/mainconfig.c:
* exec/syncv2.c:
------------------------------------------------------------------------
r2321 | fabbione | 2009-06-30 00:05:50 -0700 (Tue, 30 Jun 2009) | 3 lines

Reset version to 0.99 in configure.ac to unbreak rpm/srpm.


------------------------------------------------------------------------
r2319 | sdake | 2009-06-29 16:32:17 -0700 (Mon, 29 Jun 2009) | 2 lines

Reset 0.98 in configure.ac to trunk so toplevel makefile works properly

------------------------------------------------------------------------
r2318 | sdake | 2009-06-29 16:24:24 -0700 (Mon, 29 Jun 2009) | 2 lines

Export poll handle via coroapi.h.

------------------------------------------------------------------------
r2317 | sdake | 2009-06-29 16:16:32 -0700 (Mon, 29 Jun 2009) | 2 lines

Fix segfault during dispatch within confdb library.

------------------------------------------------------------------------
r2316 | sdake | 2009-06-27 23:03:06 -0700 (Sat, 27 Jun 2009) | 2 lines

Static-ize some main.c variables.

------------------------------------------------------------------------
r2315 | sdake | 2009-06-27 22:26:25 -0700 (Sat, 27 Jun 2009) | 2 lines

Simplify notifications from totem at the notice level.

------------------------------------------------------------------------
r2314 | sdake | 2009-06-27 22:21:14 -0700 (Sat, 27 Jun 2009) | 2 lines

Remove hard coded sync values and use defines from coroapi.h.

------------------------------------------------------------------------
r2313 | sdake | 2009-06-27 22:12:27 -0700 (Sat, 27 Jun 2009) | 2 lines

Slay the debug messages coming out at notice level in totem.

------------------------------------------------------------------------
r2312 | sdake | 2009-06-27 21:57:31 -0700 (Sat, 27 Jun 2009) | 2 lines

Remove totemsrp warning.

------------------------------------------------------------------------
r2311 | sdake | 2009-06-27 21:51:38 -0700 (Sat, 27 Jun 2009) | 2 lines

Allow syncv2 to determine membership list when run in compatibility mode.

------------------------------------------------------------------------
r2310 | sdake | 2009-06-27 21:50:18 -0700 (Sat, 27 Jun 2009) | 4 lines

Follow synchronization model of event service so corosync without openais
service engines can communicate with the openais whitetank event service
in compatibility mode.

------------------------------------------------------------------------
r2309 | sdake | 2009-06-27 17:16:54 -0700 (Sat, 27 Jun 2009) | 3 lines

Send fake barriers for the event service when operating in compatibility mode
whitetank.

------------------------------------------------------------------------
r2308 | asalkeld | 2009-06-26 21:37:51 -0700 (Fri, 26 Jun 2009) | 9 lines

add "-p" option to corosync-objctl

This just adds a "-p" option to corosync-objctl.

So you can do the following (like sysctl).

corosync-objctl -p /path/to/object.conf


------------------------------------------------------------------------
r2307 | fabbione | 2009-06-26 21:00:15 -0700 (Fri, 26 Jun 2009) | 2 lines

Fix rpm version generation and adapt release manager Makefile.

------------------------------------------------------------------------
r2306 | sdake | 2009-06-26 19:06:20 -0700 (Fri, 26 Jun 2009) | 2 lines

Remove some debug printfs that snuck in.

------------------------------------------------------------------------
r2305 | sdake | 2009-06-26 18:59:59 -0700 (Fri, 26 Jun 2009) | 3 lines

Change sync_init api call to pass information relevant for making
synchronization decisions.

------------------------------------------------------------------------
r2304 | sdake | 2009-06-26 14:39:44 -0700 (Fri, 26 Jun 2009) | 3 lines

Add ability to detect process pause and not implode the membership algorithm
when this occurs.

------------------------------------------------------------------------
r2303 | sdake | 2009-06-26 14:18:38 -0700 (Fri, 26 Jun 2009) | 3 lines

Previously if a process was interrupted by a signal it could become unkillable
because the operation was retried on signal interrupts.

------------------------------------------------------------------------
r2302 | sdake | 2009-06-26 14:15:19 -0700 (Fri, 26 Jun 2009) | 2 lines

Add syncv2.

------------------------------------------------------------------------
r2301 | sdake | 2009-06-25 19:50:38 -0700 (Thu, 25 Jun 2009) | 2 lines

Add AMF_V2_SERVICE defintion

------------------------------------------------------------------------
r2300 | sdake | 2009-06-25 18:20:06 -0700 (Thu, 25 Jun 2009) | 2 lines

Fix build error in evil.c

------------------------------------------------------------------------
r2299 | sdake | 2009-06-25 17:53:43 -0700 (Thu, 25 Jun 2009) | 2 lines

Fix no boottime support warning.

------------------------------------------------------------------------
r2298 | sdake | 2009-06-25 17:25:52 -0700 (Thu, 25 Jun 2009) | 4 lines

Add compatability option in config file.  Defaults to whitetank.
Add sync_mode to coroapi to indicate to corosync the service engine's
desired compatibility mode.

------------------------------------------------------------------------
r2297 | sdake | 2009-06-25 16:20:38 -0700 (Thu, 25 Jun 2009) | 2 lines

definition error in corodefs.h

------------------------------------------------------------------------
r2296 | sdake | 2009-06-25 15:07:26 -0700 (Thu, 25 Jun 2009) | 2 lines

sync-v1 onwire compat layer for raw corosync to communicate with whitetank.

------------------------------------------------------------------------
r2295 | sdake | 2009-06-25 13:55:16 -0700 (Thu, 25 Jun 2009) | 2 lines

Define CMAN and CRM service ids.

------------------------------------------------------------------------
r2294 | sdake | 2009-06-25 10:24:44 -0700 (Thu, 25 Jun 2009) | 2 lines

Convert got joinlist message notice to debug level.

------------------------------------------------------------------------
r2293 | fabbione | 2009-06-25 10:09:28 -0700 (Thu, 25 Jun 2009) | 3 lines

Add support for make srpm and make rpm targets


------------------------------------------------------------------------
r2292 | fabbione | 2009-06-25 04:06:24 -0700 (Thu, 25 Jun 2009) | 2 lines

Fix make dist target

------------------------------------------------------------------------
r2291 | honzaf | 2009-06-25 03:22:23 -0700 (Thu, 25 Jun 2009) | 5 lines

Add database lock init to hdb_* functions

Without this, lock can be called to unitialized and locking unitialized
lock isn't good idea.

------------------------------------------------------------------------
r2290 | honzaf | 2009-06-25 03:21:54 -0700 (Thu, 25 Jun 2009) | 2 lines

Add locking of database in hdb_handle_refcount_get

------------------------------------------------------------------------
r2289 | sdake | 2009-06-23 22:21:13 -0700 (Tue, 23 Jun 2009) | 2 lines

Remove totempg debug message.

------------------------------------------------------------------------
r2288 | sdake | 2009-06-23 18:01:57 -0700 (Tue, 23 Jun 2009) | 10 lines

Add assembly to free list when it is removed from a configuration change as
indicated by being in the left list.

This has side effect of clearing the assembly buffer the next time it is
referenced from the free list.  This fixes a defect that stops forward
processing of the message streams because sync fails to finish when receiving
a sync message from a restarted processor because it throws away the message.



------------------------------------------------------------------------
r2287 | rohara | 2009-06-23 15:28:31 -0700 (Tue, 23 Jun 2009) | 4 lines


Add hdb_handle_refcount_get call.


------------------------------------------------------------------------
r2286 | sdake | 2009-06-23 10:09:24 -0700 (Tue, 23 Jun 2009) | 2 lines

Tidy's up startup printfs.

------------------------------------------------------------------------
r2285 | sdake | 2009-06-22 22:53:05 -0700 (Mon, 22 Jun 2009) | 3 lines

Change startup notice to Corosync Cluster Engine.
Change 2008 to 2009 in copyright.

------------------------------------------------------------------------
r2284 | sdake | 2009-06-22 22:50:04 -0700 (Mon, 22 Jun 2009) | 2 lines

Remove "AIS" string from exit notice.

------------------------------------------------------------------------
r2283 | sdake | 2009-06-22 11:50:29 -0700 (Mon, 22 Jun 2009) | 2 lines

Remove warning by casting properly in totemnet.

------------------------------------------------------------------------
r2282 | sdake | 2009-06-22 11:29:43 -0700 (Mon, 22 Jun 2009) | 2 lines

Rename request_shutdown to shutdown_request in coroapi.

------------------------------------------------------------------------
r2281 | sdake | 2009-06-22 11:18:15 -0700 (Mon, 22 Jun 2009) | 3 lines

Add dump_state to coroapi.h.  Need to remove logging output from signal
handlers.

------------------------------------------------------------------------
r2280 | sdake | 2009-06-21 22:32:41 -0700 (Sun, 21 Jun 2009) | 2 lines

Sanitize -p option to not set scheduling parameters in all software.

------------------------------------------------------------------------
r2279 | meyering | 2009-06-21 11:27:02 -0700 (Sun, 21 Jun 2009) | 4 lines

totemsrp: remove unnecessary cast to avoid "make syntax-check" failure

* exec/totemsrp.c (message_handler_memb_join): Remove unnecessary
cast of alloca return value.
------------------------------------------------------------------------
r2278 | sdake | 2009-06-21 09:46:24 -0700 (Sun, 21 Jun 2009) | 2 lines

Use HAVE_ALLOCA_H define before including alloca.h

------------------------------------------------------------------------
r2277 | sdake | 2009-06-21 09:33:25 -0700 (Sun, 21 Jun 2009) | 3 lines

Add tests for posix scheduling apis to configure.ac and use them to determine
if we should set scheduling priorities or not.

------------------------------------------------------------------------
r2276 | sdake | 2009-06-20 22:02:09 -0700 (Sat, 20 Jun 2009) | 2 lines

Work around dlopen'ed objects not executing constructors on solaris platform.

------------------------------------------------------------------------
r2275 | sdake | 2009-06-20 21:49:33 -0700 (Sat, 20 Jun 2009) | 2 lines

Remove hdb constructor usage.

------------------------------------------------------------------------
r2274 | sdake | 2009-06-20 10:36:04 -0700 (Sat, 20 Jun 2009) | 2 lines

Remove timersub redefine.

------------------------------------------------------------------------
r2273 | sdake | 2009-06-20 10:34:59 -0700 (Sat, 20 Jun 2009) | 2 lines

Set nosigpipe socket option on platforms that send sigpipes in coroipcc.

------------------------------------------------------------------------
r2272 | sdake | 2009-06-20 10:34:10 -0700 (Sat, 20 Jun 2009) | 2 lines

Remove use without init warning which is harmless.

------------------------------------------------------------------------
r2271 | sdake | 2009-06-20 10:33:38 -0700 (Sat, 20 Jun 2009) | 2 lines

Remove shadow warnings.

------------------------------------------------------------------------
r2270 | sdake | 2009-06-19 13:43:12 -0700 (Fri, 19 Jun 2009) | 2 lines

Add (void *) casts for iovector assignments to remove compile warnings.

------------------------------------------------------------------------
r2268 | sdake | 2009-06-19 08:53:13 -0700 (Fri, 19 Jun 2009) | 2 lines

Fix unused variable on linux because of portage work.

------------------------------------------------------------------------
r2267 | sdake | 2009-06-19 08:42:15 -0700 (Fri, 19 Jun 2009) | 2 lines

Patch from Wojtek to fix Solaris segfault with compiler optimization.

------------------------------------------------------------------------
r2266 | meyering | 2009-06-19 04:34:50 -0700 (Fri, 19 Jun 2009) | 4 lines

maint: remove trailing blanks

By running this command from a git-cloned directory:
git grep -z -l -E '[[:blank:]]+$' | xargs -0 perl -pi -e 's/[ \t]+$//'
------------------------------------------------------------------------
r2265 | fabbione | 2009-06-19 00:02:55 -0700 (Fri, 19 Jun 2009) | 3 lines

Fix handling of sysconfdir


------------------------------------------------------------------------
r2264 | fabbione | 2009-06-18 21:58:00 -0700 (Thu, 18 Jun 2009) | 2 lines

Install basic operational directories

------------------------------------------------------------------------
r2263 | fabbione | 2009-06-18 21:57:22 -0700 (Thu, 18 Jun 2009) | 2 lines

Remove tags from example configuration

------------------------------------------------------------------------
r2262 | sdake | 2009-06-18 18:53:24 -0700 (Thu, 18 Jun 2009) | 2 lines

Warn user of missing dirs and exit gracefully.

------------------------------------------------------------------------
r2261 | sdake | 2009-06-18 17:03:56 -0700 (Thu, 18 Jun 2009) | 4 lines

Remove requirement of having uid and gid of "ais" on the system and allow
nonroot users to access ipc if their uid/gid is in the /etc/corosync/uidgid.d
directory.

------------------------------------------------------------------------
r2260 | sdake | 2009-06-18 16:08:16 -0700 (Thu, 18 Jun 2009) | 2 lines

Sanitize output of autogen.sh.

------------------------------------------------------------------------
r2259 | sdake | 2009-06-18 14:32:45 -0700 (Thu, 18 Jun 2009) | 3 lines

Ensure Linux, BSD, Solaris, Darwin function with security authentication in
IPC system.

------------------------------------------------------------------------
r2258 | fabbione | 2009-06-18 12:52:37 -0700 (Thu, 18 Jun 2009) | 2 lines

Fix rec_ident encoding for IPC

------------------------------------------------------------------------
r2257 | fabbione | 2009-06-18 12:16:14 -0700 (Thu, 18 Jun 2009) | 2 lines

use $(INSTALL) instead of install for portability to other OS'es

------------------------------------------------------------------------
r2256 | fabbione | 2009-06-18 11:14:00 -0700 (Thu, 18 Jun 2009) | 14 lines

flight recorder: enable temporary 0 buffer size protection

The flight recoder doesn't handle a 0 byte allocation properly
and it would fail miserably by allocating a single PAGE_SIZE
to handle the logging. That means an enormous performance hit
because of the constant wrapping around the buffer.

If any requested buffer is < 64000 bytes, then force to at least
64000.

In future we will be able to handle small buffers properly, but
for now enable a simple workaround to protect us and the user.


------------------------------------------------------------------------
r2255 | fabbione | 2009-06-18 10:40:41 -0700 (Thu, 18 Jun 2009) | 26 lines

flight recorder: switch from int to bytes for requested allocation

The flight recoder buffer size as specified in LOGSYS_DECLARE_SYSTEM
or _logsys_rec_init was expressed in number of ints. A developer asking
to allocate 512K would get a 2M allocation on a machine with sizeof(int) = 4.

This is confusing and the patch addresses it:

- rename rec_size to fltsize for external API (no type change),
  because rec_size is used many times internally for other reasons
  and it can be confusing.

- rename size to fltsize in _logsys_rec_init.

- document what we allocate and why.

- swap comments around to match the code.

- introduce a simple macro to perform rounding (stolen from linux-2.6.git).

- start shaping fdata header to better handle dynamic values:
  * write the flt_data_size as first unsigned int the header.
  * change corosync-fplay to read the value and alloc the right amount
    of memory instead of hardcoding it again.


------------------------------------------------------------------------
r2254 | sdake | 2009-06-17 22:58:24 -0700 (Wed, 17 Jun 2009) | 2 lines

Add Jerome to AUTHORS file

------------------------------------------------------------------------
r2253 | sdake | 2009-06-17 22:53:16 -0700 (Wed, 17 Jun 2009) | 2 lines

add madvise nosync calls for bsd platform.

------------------------------------------------------------------------
r2252 | fabbione | 2009-06-17 22:39:28 -0700 (Wed, 17 Jun 2009) | 3 lines

logsys: remove leftover files from running tests


------------------------------------------------------------------------
r2251 | fabbione | 2009-06-17 22:33:48 -0700 (Wed, 17 Jun 2009) | 3 lines

flight recorder: don't hardcode max arguments everywhere


------------------------------------------------------------------------
r2250 | fabbione | 2009-06-17 22:32:56 -0700 (Wed, 17 Jun 2009) | 3 lines

logsys: port to new packed rec_ident version


------------------------------------------------------------------------
r2249 | fabbione | 2009-06-17 22:29:51 -0700 (Wed, 17 Jun 2009) | 6 lines

logsys: add macros to pack/unpack rec_ident

rec_ident should contain 3 info: log level, subsystem id and
message type.


------------------------------------------------------------------------
r2248 | fabbione | 2009-06-17 22:17:43 -0700 (Wed, 17 Jun 2009) | 8 lines

logsys: allow to use header files for #define's

most of the values in logsys.h are very useful for non logsys library
API users.

Allow to import them without sucking the whole lib.


------------------------------------------------------------------------
r2247 | fabbione | 2009-06-17 22:16:10 -0700 (Wed, 17 Jun 2009) | 3 lines

logsys: update man page to reflect new changes


------------------------------------------------------------------------
r2246 | fabbione | 2009-06-17 22:15:10 -0700 (Wed, 17 Jun 2009) | 3 lines

logsys: merge tags into rec_ident


------------------------------------------------------------------------
r2245 | fabbione | 2009-06-17 22:11:08 -0700 (Wed, 17 Jun 2009) | 9 lines

logsys: drop LOGSYS_LEVEL_SECURITY

LOGSYS_LEVEL_SECURITY is specific to corosync/openais and it
is used only in the totem configuration.

Drop the special case from logsys that's meant to be a generic
logging library and specify the correct equivalent for totem config.


------------------------------------------------------------------------
r2244 | meyering | 2009-06-17 03:13:57 -0700 (Wed, 17 Jun 2009) | 4 lines

build: silence automake portability warnings

* configure.ac: Enable automake's -Wno-portability option.
We depend on GNU make.
------------------------------------------------------------------------
r2243 | meyering | 2009-06-17 03:13:49 -0700 (Wed, 17 Jun 2009) | 3 lines

autogen.sh: simply to a one-liner: autoreconf -i

* autogen.sh: Don't use "which" or uname, or...
------------------------------------------------------------------------
r2242 | fabbione | 2009-06-16 00:12:40 -0700 (Tue, 16 Jun 2009) | 2 lines

Add missing prototype and fix white spaces

------------------------------------------------------------------------
r2241 | sdake | 2009-06-15 11:39:50 -0700 (Mon, 15 Jun 2009) | 2 lines

Fix build error from recent solaris porting.

------------------------------------------------------------------------
r2240 | sdake | 2009-06-14 04:37:53 -0700 (Sun, 14 Jun 2009) | 2 lines

Use PF_UNIX on Solaris platforms instead of PF_LOCAL.

------------------------------------------------------------------------
r2239 | sdake | 2009-06-14 04:37:11 -0700 (Sun, 14 Jun 2009) | 2 lines

Use rsync -a instead of cp -a to install on Solaris.

------------------------------------------------------------------------
r2238 | sdake | 2009-06-14 04:36:18 -0700 (Sun, 14 Jun 2009) | 2 lines

Port of coroipc system to Solaris.

------------------------------------------------------------------------
r2237 | sdake | 2009-06-14 03:40:50 -0700 (Sun, 14 Jun 2009) | 3 lines

Patch from Jerome Flesch to correctly reference count on bsd and solaris
platforms in the IPC system to avoid cpu spinning.

------------------------------------------------------------------------
r2236 | sdake | 2009-06-14 03:13:48 -0700 (Sun, 14 Jun 2009) | 2 lines

Add iface checking for Solaris platform.

------------------------------------------------------------------------
r2235 | honzaf | 2009-06-12 03:22:32 -0700 (Fri, 12 Jun 2009) | 2 lines

Make /etc/corosync/corosync.conf default configuration file

------------------------------------------------------------------------
r2234 | honzaf | 2009-06-12 03:20:53 -0700 (Fri, 12 Jun 2009) | 20 lines

Handle LCR problem with unloading "unneeded" components

In LCR, global variable g_component_handle is used to keep handle of loaded
component. If this variable has magic value (0xFFFFFFFF) it means, 
"we loaded library, but that library doesn't have any component_register 
call -> don't try to destroy interfaces list).

If this variable has other value, it means "we loaded library, it registers,
but it exports some interface, what we currently don't need, so we can delete
that handle from libraries/interfaces list" and variable is set to magic value,
or "we loaded library, it registers and exports what we need -> great return some
nice value", but nobody resets variable to it's magic value.

Sadly, if you have loaded some component (needed), then try to load component,
which don't have component_register function, previously loaded component handle
is destroyed. 

This problem happened to clm and quorum services, and cause, that loaded
clm handle was destroyed, so EVT (which need clm) just falls.

------------------------------------------------------------------------
r2233 | fabbione | 2009-06-11 07:18:26 -0700 (Thu, 11 Jun 2009) | 2 lines

Fix library linking fallout.. again

------------------------------------------------------------------------
r2232 | sdake | 2009-06-10 10:57:22 -0700 (Wed, 10 Jun 2009) | 3 lines

Modify totemnet to work properly on Solaris by setting variables in sendmsg
data structure.

------------------------------------------------------------------------
r2231 | fabbione | 2009-06-10 10:00:15 -0700 (Wed, 10 Jun 2009) | 3 lines

Shared libs should not call exit but return error


------------------------------------------------------------------------
r2230 | sdake | 2009-06-10 07:36:38 -0700 (Wed, 10 Jun 2009) | 2 lines

Remove unused variable on platforms other then Solaris.

------------------------------------------------------------------------
r2229 | sdake | 2009-06-10 07:28:46 -0700 (Wed, 10 Jun 2009) | 2 lines

Fix compile on BSD platforms.

------------------------------------------------------------------------
r2228 | sdake | 2009-06-10 07:28:16 -0700 (Wed, 10 Jun 2009) | 2 lines

Fix semun definitions for various platforms.

------------------------------------------------------------------------
r2227 | chrissie | 2009-06-10 00:33:19 -0700 (Wed, 10 Jun 2009) | 2 lines

Fix corosync-cfgtool -a so that it actaully produces some output!

------------------------------------------------------------------------
r2226 | sdake | 2009-06-09 14:40:44 -0700 (Tue, 09 Jun 2009) | 2 lines

Use PF_LOCAL to match BSD semantics of api calls.

------------------------------------------------------------------------
r2225 | sdake | 2009-06-09 13:31:51 -0700 (Tue, 09 Jun 2009) | 3 lines

Resolve bug where config changes are delivered in the wrong order on nodes that
join and then open a cpg.

------------------------------------------------------------------------
r2224 | beekhof | 2009-06-09 09:07:11 -0700 (Tue, 09 Jun 2009) | 11 lines

Decouple the decouples shutdown/startup order of lcrso's from the internal objdb order.

This is needed as the objdb order will change as modules are loaded/unloaded and is 
also set up to unload non-default services last (which is the opposite of what 
something like Pacemaker needs).

In the worst case, the current behavior leads to cluster services (dlm, ocfs2, etc) 
failing during shutdown.  This patch also ensures that if, for example, cpg is unloaded 
then anything that depends on it is unloaded first.


------------------------------------------------------------------------
r2223 | sdake | 2009-06-07 11:56:36 -0700 (Sun, 07 Jun 2009) | 2 lines

Remove quorum.c from lcrso build list since its linked into main binary.

------------------------------------------------------------------------
r2222 | sdake | 2009-06-07 00:53:56 -0700 (Sun, 07 Jun 2009) | 2 lines

Add support for buildling on Solaris platforms.

------------------------------------------------------------------------
r2221 | sdake | 2009-06-07 00:47:10 -0700 (Sun, 07 Jun 2009) | 4 lines

Call initializer directly for broken platforms which don't honor ctors in the shared object on dlopen.
This could probably be more tidy to detect those OS platforms which don't do this instead of hardcoding
to a specific platform we intend to port to.

------------------------------------------------------------------------
r2220 | sdake | 2009-06-07 00:36:44 -0700 (Sun, 07 Jun 2009) | 2 lines

Include limits.h in coroparse.c to properly define PATH_MAX.

------------------------------------------------------------------------
r2219 | sdake | 2009-06-07 00:36:11 -0700 (Sun, 07 Jun 2009) | 2 lines

Change NAME_MAX to FILENAME_MAX to compile properly on Posix OS.

------------------------------------------------------------------------
r2218 | sdake | 2009-06-07 00:31:40 -0700 (Sun, 07 Jun 2009) | 2 lines

Define MSG_NOSIGNAL if it is undefined by the base OS such as Solaris.

------------------------------------------------------------------------
r2217 | sdake | 2009-06-07 00:31:14 -0700 (Sun, 07 Jun 2009) | 2 lines

Conditionally compile on Solaris platforms msg_* flags in sendmsg header.

------------------------------------------------------------------------
r2216 | sdake | 2009-06-07 00:24:37 -0700 (Sun, 07 Jun 2009) | 2 lines

Include string.h in sq.h for memset() calls.

------------------------------------------------------------------------
r2215 | sdake | 2009-06-06 19:30:13 -0700 (Sat, 06 Jun 2009) | 2 lines

Make readdir operation portable by removing BSDism from coroparse.c.

------------------------------------------------------------------------
r2214 | sdake | 2009-06-06 19:04:32 -0700 (Sat, 06 Jun 2009) | 5 lines

Add strsep_cs to replace strsep.
-This line, and those below, will be ignored--

M    exec/mainconfig.c

------------------------------------------------------------------------
r2213 | sdake | 2009-06-06 18:46:31 -0700 (Sat, 06 Jun 2009) | 2 lines

First run at adding support for corosync totemip determination.

------------------------------------------------------------------------
r2212 | sdake | 2009-06-06 17:55:00 -0700 (Sat, 06 Jun 2009) | 2 lines

Make coroipcs compile on Solaris.

------------------------------------------------------------------------
r2211 | sdake | 2009-06-06 17:47:56 -0700 (Sat, 06 Jun 2009) | 3 lines

Rename queue datastructure to cs_queue data structure because some fail
operating system struct queue in the globally scoped headers.

------------------------------------------------------------------------
r2210 | sdake | 2009-06-06 17:43:18 -0700 (Sat, 06 Jun 2009) | 2 lines

Port of totemip to Solaris.

------------------------------------------------------------------------
r2209 | sdake | 2009-06-06 17:42:40 -0700 (Sat, 06 Jun 2009) | 2 lines

Port of logsys to Solaris.

------------------------------------------------------------------------
r2208 | sdake | 2009-06-06 17:42:21 -0700 (Sat, 06 Jun 2009) | 2 lines

coroipcc port to Solaris.

------------------------------------------------------------------------
r2207 | chrissie | 2009-06-04 09:12:08 -0700 (Thu, 04 Jun 2009) | 2 lines

Don't let corosync-keygen fail if /etc/ais already exists

------------------------------------------------------------------------
r2206 | beekhof | 2009-06-03 03:46:07 -0700 (Wed, 03 Jun 2009) | 1 line

Fix compilation on OSX/Darwin
------------------------------------------------------------------------
r2205 | beekhof | 2009-06-03 02:54:22 -0700 (Wed, 03 Jun 2009) | 1 line

Forward port the clear_node_high_bit from whitetank
------------------------------------------------------------------------
r2204 | meyering | 2009-06-02 10:44:56 -0700 (Tue, 02 Jun 2009) | 4 lines

totempg.c: don't truncate group list

* exec/totempg.c (totempg_groups_join): Fix typo s/=/+/ that
would mistakenly truncate totempg group list.
------------------------------------------------------------------------
r2203 | honzaf | 2009-06-01 01:46:10 -0700 (Mon, 01 Jun 2009) | 24 lines

Fix coroipcc linking

Fixes rhbz#499918
	
Functions from ckpt library (like aCkptCheckpointOpen,
saCkptSectionIterationInitialize, ...) internally uses corosync functions
reply_receive, reply_receive_in_buf, ... This functions are included in
coroipcc.c source file and uses global static variable ipc_hdb.

Without patch, coroipcc is linked to shared library (libcoroipcc.so) AND linked
with every corosync libraries (like cpg, ....), so global variable ipc_hdb is
included not only in libcoroipcc.so, but also in libcpg.so, ...

dlm_controld has function retrieve_plocks, and whole binary is linked with
libcoroipcc and libcpg. So ipc_hdb is included TWICE (so has TWO addresses).

Main problem causing the bug was, that reply_receive uses address from one
library, and reply_receive_in_buf uses other. This confuses check of hdb_get
function.

After removing linking of coroipcc.o to cpg, and rather use of dynamic version,
 (this means, there is only one instance of ipc_hdb) problem disappeared.


------------------------------------------------------------------------
r2202 | chrissie | 2009-06-01 00:20:17 -0700 (Mon, 01 Jun 2009) | 5 lines

Add broadcast option to corosync

This is a forward port of the openais, whitetank, code.


------------------------------------------------------------------------
r2201 | sdake | 2009-05-30 18:18:09 -0700 (Sat, 30 May 2009) | 2 lines

Fix race condition in cpg service.

------------------------------------------------------------------------
r2200 | fabbione | 2009-05-29 21:47:01 -0700 (Fri, 29 May 2009) | 3 lines

Public headers should not include private config.h


------------------------------------------------------------------------
r2199 | chrissie | 2009-05-22 01:02:10 -0700 (Fri, 22 May 2009) | 8 lines

This patch adds the definition VOTEQUORUM_NODEID_US to the library,
which is already implicitly zero.

It also adds VOTEQUORUM_NODEID_QDEVICE and makes the code that checks
for them more generic. This now allows you to change the number of votes
assigned to a quorum disk (for example)


------------------------------------------------------------------------
r2198 | honzaf | 2009-05-20 06:30:29 -0700 (Wed, 20 May 2009) | 2 lines

Support for uidgid feature

------------------------------------------------------------------------
r2197 | honzaf | 2009-05-20 06:11:23 -0700 (Wed, 20 May 2009) | 2 lines

*Dispatch returns CS_ERR_BAD_HANDLE only on first hdb_get

------------------------------------------------------------------------
r2196 | chrissie | 2009-05-20 01:37:14 -0700 (Wed, 20 May 2009) | 2 lines

Adapt the deliver_fn in the YKD quorum plugin to the new tpg API. 

------------------------------------------------------------------------
r2195 | chrissie | 2009-05-20 00:50:53 -0700 (Wed, 20 May 2009) | 2 lines

Print a list of quorum members when it changes.

------------------------------------------------------------------------
r2194 | meyering | 2009-05-18 09:41:55 -0700 (Mon, 18 May 2009) | 4 lines

avoid spurious failure of 'make syntax-check's sc_makefile_check

* pkgconfig/Makefile.am (lib%.pc): Add extra quotes to avoid
triggering check for use of obsolescent @VAR@ notation.
------------------------------------------------------------------------
r2193 | meyering | 2009-05-18 09:41:46 -0700 (Mon, 18 May 2009) | 27 lines

don't include <signal.h> when it's not used

* exec/coroparse.c: Likewise.
* exec/quorum.c: Likewise.
* exec/sync.c: Likewise.
* exec/totemmrp.c: Likewise.
* exec/totemnet.c: Likewise.
* exec/totemrrp.c: Likewise.
* exec/totemsrp.c: Likewise.
* exec/vsf_quorum.c: Likewise.
* exec/vsf_ykd.c: Likewise.
* lcr/uic.c: Likewise.
* lcr/uis.c: Likewise.
* lib/cfg.c: Likewise.
* services/cfg.c: Likewise.
* services/cpg.c: Likewise.
* services/evs.c: Likewise.
* services/pload.c: Likewise.
* services/testquorum.c: Likewise.
* services/votequorum.c: Likewise.
* test/testconfdb.c: Likewise.
* test/testcpg.c: Likewise.
* test/testcpgzc.c: Likewise.
* test/testzcgc.c: Likewise.
* tools/corosync-cfgtool.c: Likewise.
* tools/corosync-objctl.c: Likewise.
* tools/corosync-pload.c: Likewise.
------------------------------------------------------------------------
r2192 | meyering | 2009-05-18 09:41:37 -0700 (Mon, 18 May 2009) | 13 lines

don't include <assert.h> when it's not used

* exec/apidef.c: Likewise.
* exec/mainconfig.c: Likewise.
* exec/service.c: Likewise.
* exec/timer.c: Likewise.
* exec/totemconfig.c: Likewise.
* exec/totemmrp.c: Likewise.
* exec/vsf_quorum.c: Likewise.
* services/testquorum.c: Likewise.
* test/cpgbench.c: Likewise.
* test/cpgbenchzc.c: Likewise.
* tools/corosync-fplay.c: Likewise.
------------------------------------------------------------------------
r2191 | meyering | 2009-05-18 09:41:28 -0700 (Mon, 18 May 2009) | 4 lines

always include <config.h> before any other file

* test/cpgbench.c: Include <config.h> before any other file.
* test/cpgbenchzc.c: Ditto.
------------------------------------------------------------------------
r2190 | meyering | 2009-05-18 09:41:21 -0700 (Mon, 18 May 2009) | 1 line

exec/schedwrk.c: include <config.h>
------------------------------------------------------------------------
r2189 | meyering | 2009-05-18 09:41:13 -0700 (Mon, 18 May 2009) | 5 lines

cfg.c: avoid useless if-before-free

* lib/cfg.c (corosync_cfg_ring_status_get): Avoid useless if-before-free
and change syntax to avoid triggering false-positive failure of
the "make syntax-check" sc_cast_of_argument_to_free rule.
------------------------------------------------------------------------
r2188 | meyering | 2009-05-18 09:41:04 -0700 (Mon, 18 May 2009) | 1 line

remove trailing blanks
------------------------------------------------------------------------
r2187 | chrissie | 2009-05-18 07:03:25 -0700 (Mon, 18 May 2009) | 6 lines

When doing a controlled shutdown of corosync, we now
send out a JOIN message with our node removed. This should
speed up the case where a lot of nodes leave at the same time as
they don't need to wait for the token timeout for each node.


------------------------------------------------------------------------
r2186 | honzaf | 2009-05-18 04:44:58 -0700 (Mon, 18 May 2009) | 2 lines

coroparse: Handle different EOLs and pass error_string

------------------------------------------------------------------------
r2185 | honzaf | 2009-05-18 02:42:57 -0700 (Mon, 18 May 2009) | 2 lines

Remove duplicity in logsys code

------------------------------------------------------------------------
r2184 | fabbione | 2009-05-13 02:25:08 -0700 (Wed, 13 May 2009) | 2 lines

Fix output to syslog

------------------------------------------------------------------------
r2183 | chrissie | 2009-05-13 00:04:00 -0700 (Wed, 13 May 2009) | 8 lines

Convert votequorum to use the proper message delivery API
rather than the tpg_ calls. Also remove a lot of mess around those
calls, such as headers and things that were needed for cman
compatibility but which we will not need.
 
Fixes some handle changes that did not get picked up when
handles were changed from unsigned ints to hdb_handle_t

------------------------------------------------------------------------
r2182 | fabbione | 2009-05-13 00:01:51 -0700 (Wed, 13 May 2009) | 3 lines

Logsys header clean (comments and whitespaces)


------------------------------------------------------------------------
r2181 | fabbione | 2009-05-12 21:27:54 -0700 (Tue, 12 May 2009) | 2 lines

Fix totem logging after logsys changes

------------------------------------------------------------------------
r2180 | fabbione | 2009-05-12 20:59:47 -0700 (Tue, 12 May 2009) | 2 lines

Fix logsys TAG handling

------------------------------------------------------------------------
r2179 | chrissie | 2009-05-12 02:20:21 -0700 (Tue, 12 May 2009) | 2 lines

Fix spelling of "Received" in sync.c

------------------------------------------------------------------------
r2178 | meyering | 2009-05-12 01:35:17 -0700 (Tue, 12 May 2009) | 10 lines

logsys.c: avoid possibility of buffer overrun

* exec/logsys.c (strcpy_cutoff): Add buf_len parameter, and never
write more than this number of bytes into "dest".
Change type of "cutoff" parameter from int to size_t.
Sentinel value changes from -1 to 0.
(log_printf_to_logs): Adapt to those changes.
Reverse condition of test so the much-shorter block is the "if-block".
Factor out a common subexpression for readability.
Exit the loop if output_buffer_idx ever reaches sizeof(output_buffer).
------------------------------------------------------------------------
r2177 | meyering | 2009-05-12 01:35:09 -0700 (Tue, 12 May 2009) | 6 lines

logsys.c: avoid redundant strlen in else-block

* exec/logsys.c (strcpy_cutoff): Also, with a field width (aka cutoff),
and a shorter-than-field-width string, don't write the same memory
twice: once with strncpy using NUL bytes, then again with spaces
via the memset.
------------------------------------------------------------------------
r2176 | meyering | 2009-05-12 01:35:01 -0700 (Tue, 12 May 2009) | 4 lines

logsys.c: factor out some duplication

* exec/logsys.c (log_printf_to_logs): Factor out repeated calls to
strcpy_cutoff.
------------------------------------------------------------------------
r2175 | fabbione | 2009-05-11 22:36:09 -0700 (Mon, 11 May 2009) | 3 lines

Add debugging code to logsys.


------------------------------------------------------------------------
r2174 | meyering | 2009-05-11 10:40:42 -0700 (Mon, 11 May 2009) | 4 lines

totemnet.c: Make totemnet_initialize definition match just-changed decl.

* exec/totemnet.c (totemnet_initialize): Declare deliver_fn's msg_len
parameter to be of type "unsigned int" (not size_t) to match decl.
------------------------------------------------------------------------
r2173 | fabbione | 2009-05-11 01:17:53 -0700 (Mon, 11 May 2009) | 3 lines

Fix logging date format and add missing daemon name


------------------------------------------------------------------------
r2172 | sdake | 2009-05-09 10:23:17 -0700 (Sat, 09 May 2009) | 4 lines

Remove most iovector-ized functionality from totem and only make one malloc
and memory copy call in totemsrp_mcast.  The rest of the stack minus totempg
then uses zero copies.

------------------------------------------------------------------------
r2170 | meyering | 2009-05-05 23:54:07 -0700 (Tue, 05 May 2009) | 4 lines

fix missing-dependency bug, so as not to install bogus .pc files

* pkgconfig/Makefile.am (all .pc files): Depend on Makefile, so that
a change in $(prefix) there provokes regeneration of these files.
------------------------------------------------------------------------
r2169 | meyering | 2009-05-04 05:45:45 -0700 (Mon, 04 May 2009) | 5 lines

votequorum.c: avoid a new warning and add a comment in cpg.h

* votequorum.c: Avoid declaration of unused: votequorum_instance_destructor
* include/corosync/cpg.h (cpg_deliver_fn_t) [msg]: Add a comment explaining
why this member is not const.
------------------------------------------------------------------------
r2168 | meyering | 2009-05-04 05:37:27 -0700 (Mon, 04 May 2009) | 3 lines

avoid 'incompatible pointer type' compiler warning

* test/cpgverify.c (cpg_deliver_fn): Remove const.
------------------------------------------------------------------------
r2167 | asalkeld | 2009-05-04 01:56:24 -0700 (Mon, 04 May 2009) | 2 lines

add NTF_SERVICE to the service list

------------------------------------------------------------------------
r2166 | sdake | 2009-04-29 17:14:08 -0700 (Wed, 29 Apr 2009) | 3 lines

Do checking of handle code after we verify that handle could actually be 
in the handle database.

------------------------------------------------------------------------
r2165 | sdake | 2009-04-29 00:21:21 -0700 (Wed, 29 Apr 2009) | 2 lines

Implement thread saftey in corosync trunk.

------------------------------------------------------------------------
r2164 | sdake | 2009-04-29 00:14:36 -0700 (Wed, 29 Apr 2009) | 2 lines

Fix leak caused by invalid put in hdb_handle_destroy.

------------------------------------------------------------------------
r2163 | beekhof | 2009-04-28 07:05:52 -0700 (Tue, 28 Apr 2009) | 1 line

Call all configured exec_dump_fn's when SIGUSR2 is received
------------------------------------------------------------------------
r2162 | sdake | 2009-04-27 23:45:26 -0700 (Mon, 27 Apr 2009) | 2 lines

Add cpgverify program to test directory.

------------------------------------------------------------------------
r2161 | beekhof | 2009-04-27 07:51:05 -0700 (Mon, 27 Apr 2009) | 1 line

Minor fixes to the build process on OSX
------------------------------------------------------------------------
r2160 | fabbione | 2009-04-27 04:37:59 -0700 (Mon, 27 Apr 2009) | 2 lines

Fix debug: on option for logging purposes

------------------------------------------------------------------------
r2159 | fabbione | 2009-04-27 04:36:53 -0700 (Mon, 27 Apr 2009) | 2 lines

add max limit error checks in logsys

------------------------------------------------------------------------
r2157 | sdake | 2009-04-26 22:17:40 -0700 (Sun, 26 Apr 2009) | 2 lines

Add mechanism to use logsysrec from inside totem stack.

------------------------------------------------------------------------
r2156 | sdake | 2009-04-26 22:01:25 -0700 (Sun, 26 Apr 2009) | 2 lines

Improve security of NSS implementation in totem.

------------------------------------------------------------------------
r2155 | sdake | 2009-04-26 05:39:54 -0700 (Sun, 26 Apr 2009) | 2 lines

Fix evsverify failure.

------------------------------------------------------------------------
r2154 | fabbione | 2009-04-25 23:26:12 -0700 (Sat, 25 Apr 2009) | 3 lines

Fix --enable-nss default in configure.ac


------------------------------------------------------------------------
r2153 | sdake | 2009-04-25 22:22:24 -0700 (Sat, 25 Apr 2009) | 2 lines

Make libnss detection work properly.

------------------------------------------------------------------------
r2152 | fabbione | 2009-04-25 21:52:26 -0700 (Sat, 25 Apr 2009) | 2 lines

Fix pkgconfig file inclusion into release and pass distcheck

------------------------------------------------------------------------
r2151 | sdake | 2009-04-25 19:42:05 -0700 (Sat, 25 Apr 2009) | 2 lines

add Chrissie as author of totem NSS implementation.

------------------------------------------------------------------------
r2150 | sdake | 2009-04-25 19:38:46 -0700 (Sat, 25 Apr 2009) | 3 lines

Remove const from delivery callback to allow inplace endian changes of 
message contents.

------------------------------------------------------------------------
r2149 | sdake | 2009-04-25 19:24:43 -0700 (Sat, 25 Apr 2009) | 2 lines

remove "AIS" from cfg.h header file.

------------------------------------------------------------------------
r2148 | sdake | 2009-04-25 19:08:18 -0700 (Sat, 25 Apr 2009) | 2 lines

Allow CPP linkage by adding extern "C" {} to external header files.

------------------------------------------------------------------------
r2147 | sdake | 2009-04-25 18:58:49 -0700 (Sat, 25 Apr 2009) | 2 lines

remove config.h from public header file.

------------------------------------------------------------------------
r2146 | sdake | 2009-04-25 18:20:09 -0700 (Sat, 25 Apr 2009) | 3 lines

Remove useless APIs from coroipcs.c related to handling of overload 
conditions.

------------------------------------------------------------------------
r2145 | chrissie | 2009-04-25 07:05:27 -0700 (Sat, 25 Apr 2009) | 3 lines

Add libnss security support to corosync.


------------------------------------------------------------------------
r2144 | fabbione | 2009-04-24 03:06:57 -0700 (Fri, 24 Apr 2009) | 2 lines

Bump SONAME to 4.0.0

------------------------------------------------------------------------
r2143 | meyering | 2009-04-24 02:55:21 -0700 (Fri, 24 Apr 2009) | 4 lines

logsys.c: avoid an unnecessary strlen call

* exec/logsys.c (strcpy_cutoff): Use strlen, then memcpy,
not strcpy, then strlen.
------------------------------------------------------------------------
r2142 | honzaf | 2009-04-24 00:06:30 -0700 (Fri, 24 Apr 2009) | 2 lines

Add Jan Friesse (me) to the list of Corosync authors

------------------------------------------------------------------------
r2141 | sdake | 2009-04-23 12:39:20 -0700 (Thu, 23 Apr 2009) | 3 lines

Remove mempool since it is unused and isn't going to be a feature in 
this release.

------------------------------------------------------------------------
r2140 | sdake | 2009-04-23 12:34:26 -0700 (Thu, 23 Apr 2009) | 2 lines

add request_shutdown call to coroapi.

------------------------------------------------------------------------
r2139 | sdake | 2009-04-23 12:21:35 -0700 (Thu, 23 Apr 2009) | 2 lines

Add logsys yield counter for the logsys thread.

------------------------------------------------------------------------
r2138 | meyering | 2009-04-23 11:55:15 -0700 (Thu, 23 Apr 2009) | 3 lines

corosync.pc.in: Define Cflags

* pkgconfig/corosync.pc.in (Cflags): Define.
------------------------------------------------------------------------
r2137 | meyering | 2009-04-23 11:55:06 -0700 (Thu, 23 Apr 2009) | 4 lines

pkgconfig: correct and clean up Makefile.am

* pkgconfig/Makefile.am: Factor, add missing deps.
(pkgconf_LIBS): Remove unused var.
------------------------------------------------------------------------
r2136 | sdake | 2009-04-23 10:37:32 -0700 (Thu, 23 Apr 2009) | 2 lines

Modify property of loc script to be executable.

------------------------------------------------------------------------
r2135 | sdake | 2009-04-23 10:32:57 -0700 (Thu, 23 Apr 2009) | 2 lines

remove rmd.h header file.

------------------------------------------------------------------------
r2134 | sdake | 2009-04-23 10:03:21 -0700 (Thu, 23 Apr 2009) | 2 lines

Include file cleanups.

------------------------------------------------------------------------
r2133 | sdake | 2009-04-23 09:19:49 -0700 (Thu, 23 Apr 2009) | 2 lines

Cleanup coroipcc.h header file to remove saHandleXXX and friends.

------------------------------------------------------------------------
r2132 | sdake | 2009-04-23 09:13:24 -0700 (Thu, 23 Apr 2009) | 2 lines

coroipcs.h cleanup.

------------------------------------------------------------------------
r2131 | chrissie | 2009-04-23 08:51:41 -0700 (Thu, 23 Apr 2009) | 7 lines

This patch removes the (now redundant) call to sync_primary_callback_fn
when quorum changes.

As we established a while ago, quorum is independent of sync and all
this code does is segfault when called!


------------------------------------------------------------------------
r2130 | sdake | 2009-04-23 08:24:29 -0700 (Thu, 23 Apr 2009) | 2 lines

Remove priority inversion in logsys.

------------------------------------------------------------------------
r2129 | meyering | 2009-04-23 07:16:01 -0700 (Thu, 23 Apr 2009) | 4 lines

exec/Makefile.am: require that copied code stays in sync

* exec/Makefile.am (check_logsys_log_printf_functions): New rule.
(check): Depend on check_logsys_log_printf_functions.
------------------------------------------------------------------------
r2128 | meyering | 2009-04-23 07:15:53 -0700 (Thu, 23 Apr 2009) | 4 lines

logsys.c: indent consistently

* exec/logsys.c (_logsys_log_printf): Indent with TABs to be
consistent with copied-from function, _logsys_log_vprintf.
------------------------------------------------------------------------
r2127 | honzaf | 2009-04-23 05:29:26 -0700 (Thu, 23 Apr 2009) | 3 lines

Make ipc_log_printf function working by adding _logsys_log_vprintf, which
is mostly same as _logsys_log_printf but takes va_list as argument.

------------------------------------------------------------------------
r2126 | sdake | 2009-04-23 03:03:01 -0700 (Thu, 23 Apr 2009) | 3 lines

use uint64_t for hdb_handle_t type and also specify some formatting 
strings for printing handles out of the handle database.

------------------------------------------------------------------------
r2125 | sdake | 2009-04-22 10:43:54 -0700 (Wed, 22 Apr 2009) | 2 lines

Remove saHandleXXX and friends and use hdb instead.

------------------------------------------------------------------------
r2124 | honzaf | 2009-04-22 06:39:28 -0700 (Wed, 22 Apr 2009) | 2 lines

Rewrite of CPG. It solves problems with double delete.

------------------------------------------------------------------------
r2123 | fabbione | 2009-04-22 03:39:43 -0700 (Wed, 22 Apr 2009) | 2 lines

Stop hardcoding /var

------------------------------------------------------------------------
r2122 | honzaf | 2009-04-22 02:45:47 -0700 (Wed, 22 Apr 2009) | 2 lines

Remove MESSAGE_REQ_CPG_GROUPS_GET call and all function using that.

------------------------------------------------------------------------
r2121 | fabbione | 2009-04-22 02:14:23 -0700 (Wed, 22 Apr 2009) | 2 lines

Kill all asserts from logsys and handle proper error return

------------------------------------------------------------------------
r2120 | sdake | 2009-04-22 02:03:59 -0700 (Wed, 22 Apr 2009) | 2 lines

Add missing header from last commit.

------------------------------------------------------------------------
r2119 | sdake | 2009-04-22 02:01:30 -0700 (Wed, 22 Apr 2009) | 2 lines

Reworking of include file dependencies.

------------------------------------------------------------------------
r2118 | meyering | 2009-04-22 01:04:06 -0700 (Wed, 22 Apr 2009) | 1 line

remove empty lines at end-of-file
------------------------------------------------------------------------
r2117 | meyering | 2009-04-22 01:03:55 -0700 (Wed, 22 Apr 2009) | 1 line

remove all trailing blanks
------------------------------------------------------------------------
r2116 | meyering | 2009-04-22 00:28:25 -0700 (Wed, 22 Apr 2009) | 6 lines

perf: avoid writing 1MB of zero bytes

Don't initialize the entire just-allocated buffer to all zeroes.
The very next lines initialize all members except "data".
* exec/totempg.c (assembly_ref): Initialize the first byte of
assembly->data to 0, just in case someone uses it as a string.
------------------------------------------------------------------------
r2115 | sdake | 2009-04-21 22:41:30 -0700 (Tue, 21 Apr 2009) | 2 lines

Change shared memory to use mmap() system calls.

------------------------------------------------------------------------
r2114 | sdake | 2009-04-21 16:37:49 -0700 (Tue, 21 Apr 2009) | 3 lines

Zero copy feature for IPC transmits.  Also integrated into CPG library 
service.

------------------------------------------------------------------------
r2113 | sdake | 2009-04-21 13:26:12 -0700 (Tue, 21 Apr 2009) | 2 lines

Remove memory leak from new dispatch circular buffer mapped system.

------------------------------------------------------------------------
r2112 | meyering | 2009-04-21 04:56:55 -0700 (Tue, 21 Apr 2009) | 5 lines

rename function: s/strstr_rs/strchr_rs/ to reflect new semantics

* exec/coroparse.c (parse_section):
* exec/util.c (strchr_rs, strstr_rs):
* exec/util.h (corosync_exit_error):
------------------------------------------------------------------------
r2111 | meyering | 2009-04-21 04:56:47 -0700 (Tue, 21 Apr 2009) | 11 lines

rewrite strstr_rs not to use strdup

strstr_rs used strdup and didn't handle failure.  This change removes
the use of strdup as well as the uses of strstr, since all callers
passed a string of length 1 as the second argument.  This also changes
the prototype so that the 2nd parameter is a byte, not a string.

* util.h (strstr_rs): Adjust prototype.
* util.c (strstr_rs): Rewrite/simplify.
* sa-confdb.c (strstr_rs): Remove duplicate definition.
* coroparse.c (parse_section): Update callers.
------------------------------------------------------------------------
r2110 | fabbione | 2009-04-21 02:25:28 -0700 (Tue, 21 Apr 2009) | 2 lines

Fix pthread linking

------------------------------------------------------------------------
r2109 | fabbione | 2009-04-21 00:53:06 -0700 (Tue, 21 Apr 2009) | 2 lines

Fix uid and gid determination

------------------------------------------------------------------------
r2108 | fabbione | 2009-04-21 00:34:05 -0700 (Tue, 21 Apr 2009) | 2 lines

Move include config.h at the top as it's supposed to be

------------------------------------------------------------------------
r2107 | meyering | 2009-04-21 00:28:26 -0700 (Tue, 21 Apr 2009) | 3 lines

exce/main.c: handle strdup failure

* exec/main.c (main): Upon strdup failure, log the error and exit.
------------------------------------------------------------------------
r2106 | meyering | 2009-04-21 00:28:18 -0700 (Tue, 21 Apr 2009) | 7 lines

remove useless if-before-free tests

* exec/coropoll.c (poll_destroy): Remove useless if.
* exec/main.c (main): Likewise.
* include/corosync/hdb.h (hdb_destroy): Likewise.
* lcr/lcr_ifact.c (scandir): Likewise.
* lib/sa-confdb.c (load_config): Likewise.
------------------------------------------------------------------------
r2105 | meyering | 2009-04-21 00:28:09 -0700 (Tue, 21 Apr 2009) | 5 lines

services/confdb.c: avoid four warnings

* services/confdb.c (m2h): New function.
(message_handler_req_lib_confdb_object_iter): Use m2h rather than a cast.
(message_handler_req_lib_confdb_object_find): Likewise.
------------------------------------------------------------------------
r2104 | fabbione | 2009-04-20 21:40:01 -0700 (Mon, 20 Apr 2009) | 2 lines

Guarantee that all logging buffers are flushed before we die

------------------------------------------------------------------------
r2103 | fabbione | 2009-04-20 21:38:49 -0700 (Mon, 20 Apr 2009) | 2 lines

Add logsys_flush logsys API call to signal the logging thread

------------------------------------------------------------------------
r2102 | fabbione | 2009-04-20 21:37:28 -0700 (Mon, 20 Apr 2009) | 2 lines

Add logging configuration backward compatibility layer

------------------------------------------------------------------------
r2101 | fabbione | 2009-04-20 21:02:19 -0700 (Mon, 20 Apr 2009) | 3 lines

Fix output filtering when debug is enabled


------------------------------------------------------------------------
r2100 | meyering | 2009-04-20 11:26:22 -0700 (Mon, 20 Apr 2009) | 4 lines

corosync-cfgtool.c: handle strdup failure gracefully

* tools/corosync-cfgtool.c (xstrdup): New function.
(main): Use it in place of strdup.
------------------------------------------------------------------------
r2099 | sdake | 2009-04-20 11:03:10 -0700 (Mon, 20 Apr 2009) | 2 lines

Use spinlocks in library handle references.

------------------------------------------------------------------------
r2098 | meyering | 2009-04-20 08:50:23 -0700 (Mon, 20 Apr 2009) | 5 lines

schedwrk.c: avoid two int-pointer cast conversion warnings

* exec/schedwrk.c (void2handle, handle2void): New functions.
(schedwrk_do): Use void2handle rather than an unportable cast.
(schedwrk_create): Use handle2void rather than an unportable cast.
------------------------------------------------------------------------
r2097 | fabbione | 2009-04-20 07:17:09 -0700 (Mon, 20 Apr 2009) | 3 lines

Fix libconfdb linking


------------------------------------------------------------------------
r2096 | fabbione | 2009-04-20 03:43:37 -0700 (Mon, 20 Apr 2009) | 4 lines

Improve logsys error handling in logsys_format_set
and logsys_config_file_set_unlocked.


------------------------------------------------------------------------
r2095 | fabbione | 2009-04-20 02:35:39 -0700 (Mon, 20 Apr 2009) | 2 lines

Rename corosync.conf to corosync.conf.example take 2

------------------------------------------------------------------------
r2094 | fabbione | 2009-04-20 02:34:26 -0700 (Mon, 20 Apr 2009) | 2 lines

Rename corosync.conf to corosync.conf.example

------------------------------------------------------------------------
r2093 | fabbione | 2009-04-20 00:08:42 -0700 (Mon, 20 Apr 2009) | 3 lines

readd early log level check for performance reasons.


------------------------------------------------------------------------
r2092 | sdake | 2009-04-19 21:45:46 -0700 (Sun, 19 Apr 2009) | 4 lines

throw away mode in totempg was operating as a global variable, when it 
is possible for different nodes to be in different configurations of 
throw away.  This patch makes the variable instanced.

------------------------------------------------------------------------
r2091 | fabbione | 2009-04-19 21:28:33 -0700 (Sun, 19 Apr 2009) | 3 lines

Add logsys v3


------------------------------------------------------------------------
r2090 | sdake | 2009-04-18 07:42:09 -0700 (Sat, 18 Apr 2009) | 2 lines

Add missing schedwrk files.

------------------------------------------------------------------------
r2089 | sdake | 2009-04-18 07:39:57 -0700 (Sat, 18 Apr 2009) | 2 lines

add schedwrk_create and schedwrk_destroy coroapi functions.

------------------------------------------------------------------------
r2088 | sdake | 2009-04-18 07:13:02 -0700 (Sat, 18 Apr 2009) | 2 lines

Initialize pload context properly.

------------------------------------------------------------------------
r2087 | sdake | 2009-04-18 04:57:34 -0700 (Sat, 18 Apr 2009) | 2 lines

Move QUICKSTART to INSTALL and update it.

------------------------------------------------------------------------
r2086 | sdake | 2009-04-18 04:36:07 -0700 (Sat, 18 Apr 2009) | 2 lines

Add AUTHORS file.

------------------------------------------------------------------------
r2085 | sdake | 2009-04-18 00:43:33 -0700 (Sat, 18 Apr 2009) | 2 lines

Remove declaration of data struct inside code.

------------------------------------------------------------------------
r2084 | sdake | 2009-04-18 00:42:25 -0700 (Sat, 18 Apr 2009) | 2 lines

Remove warning in evsbench.

------------------------------------------------------------------------
r2083 | sdake | 2009-04-18 00:37:15 -0700 (Sat, 18 Apr 2009) | 2 lines

Add fatal error call to ipc initializations.y

------------------------------------------------------------------------
r2082 | sdake | 2009-04-18 00:25:04 -0700 (Sat, 18 Apr 2009) | 2 lines

check result of fgets in testcpg.

------------------------------------------------------------------------
r2081 | sdake | 2009-04-18 00:21:35 -0700 (Sat, 18 Apr 2009) | 2 lines

Remove warnings about objdb that casts a const char * to a char *.

------------------------------------------------------------------------
r2080 | sdake | 2009-04-18 00:18:08 -0700 (Sat, 18 Apr 2009) | 2 lines

Remove warnings about typedefs in apidef.c.

------------------------------------------------------------------------
r2079 | sdake | 2009-04-18 00:06:14 -0700 (Sat, 18 Apr 2009) | 2 lines

Rework how dispatch functions so service engines work properly.

------------------------------------------------------------------------
r2078 | meyering | 2009-04-15 12:13:37 -0700 (Wed, 15 Apr 2009) | 3 lines

configure.ac: enable gcc's -Wshadow warning

* configure.ac (WARNLIST): Add -Wshadow to the list.
------------------------------------------------------------------------
r2077 | meyering | 2009-04-15 12:13:28 -0700 (Wed, 15 Apr 2009) | 3 lines

cpg.c: rename file-scoped global to avoid shadowing warnings

* services/cpg.c: s/req_exec_cpg_downlist/g_req_exec_cpg_downlist/
------------------------------------------------------------------------
r2076 | meyering | 2009-04-15 12:13:20 -0700 (Wed, 15 Apr 2009) | 4 lines

vsf_ykd.c: Rename param to avoid shadowing global "ydk_state"

* exec/vsf_ykd.c (ykd_state_endian_convert): Rename param:
s/ydk_state/state/
------------------------------------------------------------------------
r2075 | meyering | 2009-04-15 12:13:11 -0700 (Wed, 15 Apr 2009) | 3 lines

services/cfg.c move shadowed decl into scope where used

* services/cfg.c (message_handler_req_lib_cfg_tryshutdown):
------------------------------------------------------------------------
r2074 | meyering | 2009-04-15 12:13:03 -0700 (Wed, 15 Apr 2009) | 3 lines

corosync-fplay.c: don't shadow file-scoped global, "record"

* tools/corosync-fplay.c: Rename: s/record/g_record/.
------------------------------------------------------------------------
r2073 | meyering | 2009-04-15 12:12:56 -0700 (Wed, 15 Apr 2009) | 3 lines

testvotequorum1.c: don't shadow file-scoped global, "handle"

* test/testvotequorum1.c (main): Rename: s/handle/g_handle/.
------------------------------------------------------------------------
r2072 | meyering | 2009-04-15 12:12:48 -0700 (Wed, 15 Apr 2009) | 3 lines

corosync-fplay.c: avoid shadowin: s/index/idx/

* tools/corosync-fplay.c (printer_totempg_mcast_fits):
------------------------------------------------------------------------
r2071 | meyering | 2009-04-15 12:12:40 -0700 (Wed, 15 Apr 2009) | 5 lines

coroipcs.c: don't shadow functions read and write

* exec/coroipcs.c (req_setup_recv): rename locals:
s/read/n_read/; s/write/n_write.
Also declare param to be const.
------------------------------------------------------------------------
r2070 | meyering | 2009-04-15 12:12:33 -0700 (Wed, 15 Apr 2009) | 4 lines

totemnet.c: don't shadow crypto.h type, "hmac_state"

* exec/totemnet.c (encrypt_and_sign_worker): Rename a local var:
s/hmac_state/hmac_st/
------------------------------------------------------------------------
r2069 | meyering | 2009-04-15 12:12:25 -0700 (Wed, 15 Apr 2009) | 3 lines

don't shadow file-scoped global, "handle"

* test/testquorum.c: Rename: s/handle/g_handle/.
------------------------------------------------------------------------
r2068 | meyering | 2009-04-15 12:12:17 -0700 (Wed, 15 Apr 2009) | 7 lines

wthread.c: Rename file-scoped type to avoid shadows.

* exec/wthread.c (struct worker_thread_t): Rename from
struct worker_thread.
(start_worker_thread): Rename from function "worker_thread".
* exec/wthread.h (struct worker_thread_group) [threads]: Update
member type: s/struct worker_thread/struct worker_thread_t/
------------------------------------------------------------------------
r2067 | meyering | 2009-04-15 12:12:10 -0700 (Wed, 15 Apr 2009) | 7 lines

don't shadow the global type name, "timer_handle"

* exec/coropoll.c (poll_timer_delete): Rename locals and/or params.
* exec/timer.c (corosync_timer_delete): Likewise.
(corosync_timer_expire_time_get): Likewise.
* exec/tlist.h (timerlist_del, timerlist_expire_time): Likewise.
(timerlist_pre_dispatch, timerlist_post_dispatch): Likewise.
------------------------------------------------------------------------
r2066 | meyering | 2009-04-15 12:12:02 -0700 (Wed, 15 Apr 2009) | 3 lines

list.h: avoid shadowing warning

* include/corosync/list.h: Don't use "remove" as param name.
------------------------------------------------------------------------
r2065 | meyering | 2009-04-15 12:11:54 -0700 (Wed, 15 Apr 2009) | 3 lines

coroipcc.c: avoid shadowing warning

* lib/coroipcc.c: Don't use "read" as param name.
------------------------------------------------------------------------
r2064 | meyering | 2009-04-15 12:11:46 -0700 (Wed, 15 Apr 2009) | 5 lines

totemsrp.c: more "const" propagation

* exec/totemsrp.c (message_handler_memb_commit_token): Don't cast away
const on "memb_commit_token".  This exposed a const violation.
Fix that with minor rearrangement and an added memcpy.
------------------------------------------------------------------------
r2063 | meyering | 2009-04-15 00:48:47 -0700 (Wed, 15 Apr 2009) | 5 lines

totemsrp.c: avoid a const-correctness problem

* exec/totemsrp.c (message_handler_memb_merge_detect): Don't modify
the now-const "msg" parameter.  Instead, use a local copy.
Patch by Steven Dake.
------------------------------------------------------------------------
r2062 | meyering | 2009-04-15 00:48:39 -0700 (Wed, 15 Apr 2009) | 22 lines

totemrrp.h, totemsrp.h, totemnet.h: const+size_t

* exec/totemrrp.c (totemrrp_initialize):
* exec/totemrrp.h (totemrrp_initialize):
* exec/totemsrp.c (handler_functions, main_deliver_fn):
(main_iface_change_fn):
* exec/totemnet.c (totemnet_deliver_fn, totemnet_iface_change_fn):
(encrypt_and_sign_worker, ucast_sendmsg, mcast_sendmsg):
(totemnet_mcast_worker_fn, totemnet_initialize):
(totemnet_token_send, totemnet_mcast_flush_send):
(totemnet_mcast_noflush_send, totemnet_token_target_set):
* exec/totemnet.h (TOTEMNET_FLUSH):
* exec/totemrrp.c (totemrrp_deliver_fn, totemrrp_iface_change_fn):
(totemrrp_token_seqid_get, rrp_deliver_fn, rrp_iface_change_fn):
* exec/totemsrp.c (handler_functions, main_token_seqid_get):
(srp_addr_copy_endian_convert, message_handler_orf_token):
(message_handler_mcast, message_handler_memb_merge_detect):
(memb_join_endian_convert, memb_commit_token_endian_convert):
(orf_token_endian_convert, mcast_endian_convert):
(memb_merge_detect_endian_convert, message_handler_memb_join):
(message_handler_memb_commit_token):
(message_handler_token_hold_cancel, main_deliver_fn):
------------------------------------------------------------------------
r2061 | meyering | 2009-04-14 23:52:25 -0700 (Tue, 14 Apr 2009) | 1 line

* README.devmap: Update a prototype.
------------------------------------------------------------------------
r2060 | meyering | 2009-04-14 23:52:16 -0700 (Tue, 14 Apr 2009) | 6 lines

change a few "int msg_len" to "size_t msg_len"; adjust docs

* lib/cpg.c (cpg_mcast_joined):
* lib/evs.c (evs_mcast_joined, evs_mcast_groups):
* man/cpg_initialize.3:
* man/evs_initialize.3:
------------------------------------------------------------------------
r2059 | meyering | 2009-04-14 23:47:34 -0700 (Tue, 14 Apr 2009) | 4 lines

corosync-keygen.c: diagnose a few more failures

* tools/corosync-keygen.c (main): Diagnose short reads, failed mkdir
and fchmod; detect write failure.  Close file descriptors.
------------------------------------------------------------------------
r2058 | sdake | 2009-04-13 23:35:46 -0700 (Mon, 13 Apr 2009) | 2 lines

Autodetect build environment for configure for developers.

------------------------------------------------------------------------
r2057 | sdake | 2009-04-09 20:17:17 -0700 (Thu, 09 Apr 2009) | 2 lines

Fix compile warning in main.c.

------------------------------------------------------------------------
r2056 | sdake | 2009-04-09 20:10:24 -0700 (Thu, 09 Apr 2009) | 2 lines

Cast a const away in an iovector.

------------------------------------------------------------------------
r2055 | sdake | 2009-04-09 20:08:17 -0700 (Thu, 09 Apr 2009) | 2 lines

Remove warnings from wthread.

------------------------------------------------------------------------
r2054 | sdake | 2009-04-09 20:07:17 -0700 (Thu, 09 Apr 2009) | 2 lines

Remove qualifier check in warnings list.

------------------------------------------------------------------------
r2053 | sdake | 2009-04-09 19:56:48 -0700 (Thu, 09 Apr 2009) | 2 lines

Remove admin_state_set and admin_state_get.

------------------------------------------------------------------------
r2052 | sdake | 2009-04-09 19:44:51 -0700 (Thu, 09 Apr 2009) | 2 lines

Remove warning in keygen and report error on fchown appropriately.

------------------------------------------------------------------------
r2051 | sdake | 2009-04-09 19:40:33 -0700 (Thu, 09 Apr 2009) | 2 lines

Remove warning in corosync-objctl.

------------------------------------------------------------------------
r2050 | sdake | 2009-04-09 19:24:01 -0700 (Thu, 09 Apr 2009) | 2 lines

Add spin locks for critical sections in hdb api.

------------------------------------------------------------------------
r2049 | meyering | 2009-04-09 13:53:13 -0700 (Thu, 09 Apr 2009) | 4 lines

coroapi.h: Make totem_mcast's *iovec param const.

* include/corosync/engine/coroapi.h (struct corosync_api_v1):
[totem_mcast]: Make *iovec param const.
------------------------------------------------------------------------
r2048 | meyering | 2009-04-09 13:53:03 -0700 (Thu, 09 Apr 2009) | 8 lines

cpg.h, objdb.h, coroaph.h: more const/size_t

* include/corosync/cpg.h (cpg_callbacks_t):
* include/corosync/mar_cpg.h (marshall_to_mar_cpg_name_t):
* lib/cpg.c (cpg_join, cpg_leave):
* lib/cpg.c (cpg_mcast_joined): make iovec const.
* include/corosync/cpg.h (cpg_mcast_joined): update prototype
...
------------------------------------------------------------------------
r2047 | meyering | 2009-04-09 05:32:59 -0700 (Thu, 09 Apr 2009) | 21 lines

coroapi.h: change lib_handler_fn's *msg to be const

Make a tiny type change and watch it propagate.
* include/corosync/engine/coroapi.h
(struct corosync_lib_handler) [lib_handler_fn]: Change type
of 2nd parameter: s/void *msg/const void *msg/.
Propagate the above into cfg.c and votequorum.c:
* services/cfg.c (message_handler_req_lib_cfg_get_node_addrs):
Constification exposed a bug in this function whereby it mistakenly
modified storage through its now-const *msg parameter.  Since it
did that solely to store a temporary result, we've changed it
to use a local variable instead.
* services/votequorum.c (message_handler_req_lib_votequorum_setvotes):
Likewise.
* exec/vsf_quorum.c: add const to msg param.
* services/evs.c: Likewise.
* services/pload.c: Likewise.
* services/cpg.c: Likewise.
* services/confdb.c: Likewise.
* exec/coroipcs.h: signature of coroipcs_handler_fn_lvalue must match
that of lib_handler_fn; noted via main.c.
------------------------------------------------------------------------
r2046 | meyering | 2009-04-09 05:32:49 -0700 (Thu, 09 Apr 2009) | 1 line

testevsth.c: const+size_t: evs_deliver_fn, evs_confchg_fn
------------------------------------------------------------------------
r2045 | meyering | 2009-04-08 10:30:02 -0700 (Wed, 08 Apr 2009) | 5 lines

coroipcc.h (coroipcc_msg_send_reply_receive): Make res_len size_t.

* include/corosync/coroipcc.h (coroipcc_msg_send_reply_receive):
change type of res_len parameter.
* lib/coroipcc.c (coroipcc_reply_receive): Likewise.
------------------------------------------------------------------------
r2044 | meyering | 2009-04-08 10:29:53 -0700 (Wed, 08 Apr 2009) | 10 lines

sync the rest of the code with previous header changes

* exec/coroipcs.c (coroipcs_response_send)
(coroipcs_dispatch_send):
* exec/coroipcs.h (handler_fn_get):
* include/corosync/cpg.h (cpg_deliver_fn_t, cpg_confchg_fn_t):
* test/cpgbench.c (cpg_bm_confchg_fn, cpg_bm_deliver_fn):
* test/testcpg.c (print_cpgname, DeliverCallback)
(ConfchgCallback):
* test/testcpg2.c (deliver, confch):
------------------------------------------------------------------------
r2043 | meyering | 2009-04-08 10:29:45 -0700 (Wed, 08 Apr 2009) | 7 lines

cpg.h, coroapi.h: more size_t and const changes

* include/corosync/cpg.h (cpg_deliver_fn_t, cpg_confchg_fn_t)
(cpg_groups_get_fn_t):
* include/corosync/engine/coroapi.h (ipc_response_send)
(ipc_dispatch_send, tpg_join, tpg_leave, tpg_groups_mcast)
(tpg_groups_reserve):
------------------------------------------------------------------------
r2042 | meyering | 2009-04-08 10:29:37 -0700 (Wed, 08 Apr 2009) | 1 line

sync the rest of the code with previous header changes
------------------------------------------------------------------------
r2041 | meyering | 2009-04-08 10:29:27 -0700 (Wed, 08 Apr 2009) | 14 lines

make all priv_data_pt pointers non-"const"

I'd suspected this would be necessary, but until now hadn't
found a case in which it actually was.  That case:
totemconfig.c's totem_key_change_notify.
It has a priv_data_pt parameter that is used like this:

  struct totem_config *totem_config = priv_data_pt;

and totem_config is in turn passed as arg #2 to
totem_volatile_config_read, where it is decidedly non-const.

git grep -l 'const void \*priv' \
  |xargs perl -pi -e 's,const (void \*priv_data_pt),$1,'
------------------------------------------------------------------------
r2040 | meyering | 2009-04-08 10:29:16 -0700 (Wed, 08 Apr 2009) | 35 lines

coroapi.h, confdb.h, objdb.h: big s/int/size_t/ change

* exec/mainconfig.c (objdb_get_string, objdb_get_int):
* exec/totemconfig.c (objdb_get_string, objdb_get_int)
(totem_config_keyread, totem_key_change_notify):
* include/corosync/confdb.h (confdb_callbacks_t):
* include/corosync/engine/coroapi.h (group_len, object_len)
(key_len, validate_callback, object_key_change_notify_fn_t)
(object_create_notify_fn_t, object_destroy_notify_fn_t)
(object_notify_callback_fn_t, object_reload_notify_fn_t)
(object_create, object_key_create, object_find_create)
(object_key_get, object_key_replace, object_key_delete)
(object_iter, object_key_iter, object_name_get)
(object_key_iter_from, object_key_increment)
(object_key_decrement):
* include/corosync/engine/objdb.h (object_key_change_notify_fn_t)
(object_create_notify_fn_t, object_destroy_notify_fn_t)
(object_len, key_len, validate_callback, object_create)
(object_key_create, object_find_create, object_key_get)
(object_key_replace, object_key_delete, object_iter)
(object_key_iter, object_name_get, object_key_iter_from)
(object_key_increment, object_key_decrement):
* lib/confdb.c (confdb_object_create, confdb_key_create)
(confdb_key_delete, confdb_key_get, confdb_key_increment)
(confdb_key_decrement, confdb_key_replace, confdb_object_find)
(confdb_object_iter, confdb_key_iter):
* lib/sa-confdb.c (confdb_sa_object_create, confdb_sa_key_create)
(confdb_sa_key_delete, confdb_sa_key_get)
(confdb_sa_key_increment, confdb_sa_key_decrement)
(confdb_sa_key_replace, confdb_sa_object_find)
(confdb_sa_object_iter, confdb_sa_key_iter):
* lib/sa-confdb.h:
* services/confdb.c (message_handler_req_lib_confdb_key_replace):
* services/votequorum.c (objdb_get_string, objdb_get_int)
(quorum_key_change_notify, votequorum_objdb_reload_notify):
------------------------------------------------------------------------
r2039 | meyering | 2009-04-08 10:29:07 -0700 (Wed, 08 Apr 2009) | 5 lines

totemconfig.c: don't hard-code "128"...

* exec/totemconfig.c (read_keyfile): Don't hard-code "128".
Use sizeof(...) instead.
Avoid duplicate "close(fd)" calls.
------------------------------------------------------------------------
r2038 | meyering | 2009-04-08 10:28:56 -0700 (Wed, 08 Apr 2009) | 4 lines

totemconfig.c: don't let a key of length > 128 clobber memory

* exec/totemconfig.c (totem_config_keyread): Reject a key with length
greater than that of our private_key buffer.
------------------------------------------------------------------------
r2037 | meyering | 2009-04-08 10:28:48 -0700 (Wed, 08 Apr 2009) | 5 lines

totem.h: use symbolic array dimensions in public struct members

* include/corosync/totem/totem.h:
(TOTEM_PRIVATE_KEY_LEN, TOTEM_RRP_MODE_BYTES): Define.
(struct totem_config): Use the new names, rather than literals.
------------------------------------------------------------------------
r2036 | meyering | 2009-04-08 10:28:40 -0700 (Wed, 08 Apr 2009) | 4 lines

totempg.h: change type of totempg_group.group_len from int to size_t

* include/corosync/totem/totempg.h (struct totempg_group) [group_len]:
Change member type from int to size_t.
------------------------------------------------------------------------
r2035 | meyering | 2009-04-08 10:28:31 -0700 (Wed, 08 Apr 2009) | 4 lines

rmd.h: adjust types (const+size_t) of prototype

* include/corosync/rmd.h: ...even though there are no definitions
for these functions.
------------------------------------------------------------------------
r2034 | meyering | 2009-04-08 00:57:36 -0700 (Wed, 08 Apr 2009) | 3 lines

sync.c: avoid printf format warning

* exec/sync.c (sync_deliver_fn): cast to unsigned long int, use %lu
------------------------------------------------------------------------
r2033 | meyering | 2009-04-08 00:57:18 -0700 (Wed, 08 Apr 2009) | 4 lines

sync.c: avoid warning about now-unused variables

* exec/sync.c (vsf_none, vsf_iface): Remove decls of now-unused
file-scoped variables.
------------------------------------------------------------------------
r2032 | meyering | 2009-04-08 00:56:54 -0700 (Wed, 08 Apr 2009) | 15 lines

convert each "size_t iov_len" declaration to "unsigned int iov_len"

Via this command:
git grep -l -E 'size_t[[:blank:]]+iov_len' \
  | xargs perl -pi -e 's/((?:^|,)\s*)size_t\s+(iov_len)/${1}unsigned int $2/'

Affected files and (functions/macros):
* exec/totempg.c (totempg_groups_mcast_groups)
(totempg_groups_send_ok_groups):
* include/corosync/evs.h (evs_callbacks_t):
* include/corosync/totem/totempg.h (TOTEMPG_SAFE):
* lib/evs.c (evs_mcast_joined, evs_mcast_groups):
* man/cpg_mcast_joined.3:
* man/evs_mcast_groups.3:
* man/evs_mcast_joined.3:
------------------------------------------------------------------------
r2031 | meyering | 2009-04-08 00:56:45 -0700 (Wed, 08 Apr 2009) | 42 lines

Convert all "int iov_len" decls to "unsigned int iov_len".

Used this command:
git grep -l 'int iov_len' \
  | xargs perl -pi -e 's/((?:^|,)\s*)(int iov_len)/${1}unsigned $2/'

Here's an approximate (autogenerated by vc-chlog) list of affected
file names and functions/macros:
* README.devmap:
* exec/coroipcs.c (sending_allowed_private_data)
(coroipcs_response_iov_send, msg_send, msg_send_or_queue)
(coroipcs_dispatch_iov_send):
* exec/coroipcs.h (handler_fn_get):
* exec/main.c (deliver_fn, main_mcast):
* exec/main.h (FALSE):
* exec/sync.c (vsf_iface, sync_deliver_fn):
* exec/totemmrp.c (totemsrp_handle_in, pg_deliver_fn)
(totemmrp_deliver_fn, totemmrp_initialize, totemmrp_mcast):
* exec/totemmrp.h (TOTEMMRP_H_DEFINED):
* exec/totemnet.c (iov_len, encrypt_and_sign_worker)
(ucast_sendmsg, mcast_sendmsg, totemnet_token_send):
* exec/totemnet.h (TOTEMNET_FLUSH):
* exec/totempg.c (deliver_fn, totempg_deliver_fn, mcast_msg)
(totempg_groups_initialize, totempg_groups_mcast_joined)
(totempg_groups_joined_reserve):
* exec/totemsrp.c (iov_len, totemsrp_recv, totemsrp_deliver_fn)
(totemsrp_initialize, totemsrp_mcast, token_send):
* exec/totemsrp.h (TOTEMSRP_H_DEFINED):
* exec/vsf_ykd.c (ykd_deliver_fn):
* include/corosync/coroipcc.h (handleInstanceDestructor):
* include/corosync/cpg.h (cpg_callbacks_t):
* include/corosync/engine/coroapi.h (ipc_response_iov_send)
(ipc_dispatch_iov_send, totem_mcast, tpg_init, tpg_joined_mcast)
(tpg_joined_reserve, tpg_groups_mcast, tpg_groups_reserve):
* include/corosync/totem/totempg.h (TOTEMPG_SAFE):
* lib/coroipcc.c (coroipcc_msg_send)
(coroipcc_msg_send_reply_receive)
(coroipcc_msg_send_reply_receive_in_buf):
* lib/cpg.c (cpg_mcast_joined):
* lib/util.h (versionsSupported):
* services/pload.c (send_message):
* services/votequorum.c (conn, quorum_deliver_fn):
------------------------------------------------------------------------
r2030 | meyering | 2009-04-07 23:44:59 -0700 (Tue, 07 Apr 2009) | 28 lines

continue pulling previous thread: mostly constification

* exec/apidef.c (typedef_tpg_join, typedef_tpg_leave)
(typedef_tpg_groups_mcast, typedef_tpg_groups_send_ok):
* exec/sync.c (barrier_data_process, sync_barrier_send)
(sync_start_init, sync_service_init, sync_start_process)
(sync_service_process, sync_deliver_fn, sync_request_send)
(sync_request):
* exec/sync.h (name):
* exec/totemmrp.c (totemmrp_callback_token_create):
* exec/totemmrp.h (TOTEMMRP_H_DEFINED):
* exec/totempg.c (list, app_confchg_fn)
(callback_token_received_fn, totempg_callback_token_create)
(totempg_groups_mcast_joined, totempg_groups_joined_release)
(totempg_groups_mcast_groups):
* exec/totemsrp.c (callback_fn, totemsrp_confchg_fn)
(totemsrp_initialize, totemsrp_callback_token_create):
* exec/totemsrp.h (TOTEMSRP_H_DEFINED):
* exec/vsf_ykd.c (ykd_state_send_msg, ykd_attempt_send_msg)
(ykd_confchg_fn):
* include/corosync/engine/coroapi.h (timer_add_absolute)
(totem_ifaces_print, totem_ip_print, totem_callback_token_create)
(sync_request, plugin_interface_reference):
* include/corosync/totem/totempg.h (TOTEMPG_SAFE):
* services/cpg.c (cpg_confchg_fn):
* services/pload.c (msgs_sent, pload_service_engine)
(send_message, start_mcasting):
* services/votequorum.c (conn, quorum_confchg_fn):
------------------------------------------------------------------------
r2029 | meyering | 2009-04-07 23:44:50 -0700 (Tue, 07 Apr 2009) | 22 lines

*_confchg_fn: make pointer params const, change *_entries to be size_t

* exec/main.c (confchg_fn):
* exec/quorum.h (sync_callback_fn_t):
* exec/sync.c (sync_ring_id, barrier_data_process)
(sync_start_init, sync_service_process, sync_primary_callback_fn)
(sync_deliver_fn, sync_confchg_fn):
* exec/sync.h (name):
* exec/totemmrp.c (totemsrp_handle_in, pg_confchg_fn)
(totemmrp_confchg_fn, totemmrp_initialize):
* exec/totemmrp.h (TOTEMMRP_H_DEFINED):
* exec/totempg.c (confchg_fn, totempg_confchg_fn)
(totempg_groups_initialize):
* include/corosync/engine/coroapi.h (tpg_init, confchg_fn)
(sync_abort):
* include/corosync/totem/totempg.h (TOTEMPG_SAFE):
* services/cfg.c (shutdown_reply, cfg_confchg_fn)
(message_handler_req_exec_cfg_ringreenable):
* services/cpg.c (api, cpg_confchg_fn):
* services/evs.c (MESSAGE_REQ_EXEC_EVS_MCAST, evs_confchg_fn):
* services/pload.c (MESSAGE_REQ_EXEC_PLOAD_MCAST)
(pload_confchg_fn):
------------------------------------------------------------------------
r2028 | meyering | 2009-04-07 23:44:41 -0700 (Tue, 07 Apr 2009) | 4 lines

no-op change: s/gruop/group/ in prototypes and documentation

* include/corosync/engine/coroapi.h (tpg_join, tpg_leave):
* man/evs_mcast_groups.3:
------------------------------------------------------------------------
r2027 | meyering | 2009-04-07 23:44:20 -0700 (Tue, 07 Apr 2009) | 7 lines

totem: const+unsigned+size_t

* exec/totempg.c (totempg_groups_mcast_groups):
(totempg_groups_send_ok_groups):
* include/corosync/totem/totem.h (interface_count):
(private_key_len, threads, heartbeat_failures_allowed):
* include/corosync/totem/totempg.h:
------------------------------------------------------------------------
r2026 | meyering | 2009-04-07 23:44:12 -0700 (Tue, 07 Apr 2009) | 3 lines

rmd.h: s/int/size_t; const-correctness changes...

* include/corosync/rmd.h: in spite of these being unused interfaces
------------------------------------------------------------------------
r2025 | meyering | 2009-04-07 23:43:54 -0700 (Tue, 07 Apr 2009) | 1 line

lcr_ckpt.h: unused file: const/size_t
------------------------------------------------------------------------
r2024 | meyering | 2009-04-07 23:43:36 -0700 (Tue, 07 Apr 2009) | 5 lines

ipc_evs.h: s/int/size_t

* include/corosync/ipc_evs.h (msglen, member_list_entries):
(left_list_entries, joined_list_entries, group_entries, msg_len):
(group_entries, msg_len, member_list_entries):
------------------------------------------------------------------------
r2023 | meyering | 2009-04-07 23:43:17 -0700 (Tue, 07 Apr 2009) | 10 lines

evs.h: s/int/size_t; const-correctness changes

* exec/sync.c (barrier_data_confchg_entries):
* include/corosync/evs.h (evs_deliver_fn_t, evs_confchg_fn_t):
(evs_callbacks_t):
* lib/evs.c (MIN, evs_join, evs_leave, evs_mcast_joined):
(evs_mcast_groups, evs_membership_get):
* test/evsbench.c (evs_deliver_fn, evs_confchg_fn):
* test/evsverify.c (evs_deliver_fn, evs_confchg_fn, main):
* test/testevs.c (evs_deliver_fn, evs_confchg_fn, main):
------------------------------------------------------------------------
r2022 | meyering | 2009-04-07 23:43:03 -0700 (Tue, 07 Apr 2009) | 10 lines

quorum.h (quorum_set_quorate_fn_t): make first param const

* exec/quorum.h (sync_callback_fn_t):
* exec/sync.c (current_members_cnt, sync_primary_callback_fn):
* exec/sync.h (name):
* exec/vsf_quorum.c (sync_primary_callback_fn):
(quorum_api_set_quorum):
* exec/vsf_ykd.c (ykd_primary_callback_fn):
* include/corosync/engine/coroapi.h (sync_callback_fn_t):
* include/corosync/engine/quorum.h (quorum_set_quorate_fn_t):
------------------------------------------------------------------------
r2021 | meyering | 2009-04-07 23:42:29 -0700 (Tue, 07 Apr 2009) | 7 lines

quorum.h (quorum_set_quorate_fn_t): s/int/size_t/

propagate the change:
* include/corosync/engine/quorum.h (quorum_set_quorate_fn_t):
* exec/vsf_quorum.c (quorum_view_list_entries):
(quorum_api_set_quorum, quorum_exec_init_fn):
* exec/vsf_ykd.c (ykd_primary_callback_fn):
------------------------------------------------------------------------
r2020 | sdake | 2009-04-07 14:42:59 -0700 (Tue, 07 Apr 2009) | 2 lines

Remove wrong project name.

------------------------------------------------------------------------
r2019 | sdake | 2009-04-07 14:41:25 -0700 (Tue, 07 Apr 2009) | 3 lines

Forward port of sync v1 engine from whitetank and rework of quorum 
engine to not break syncing.

------------------------------------------------------------------------
r2018 | meyering | 2009-04-07 11:48:04 -0700 (Tue, 07 Apr 2009) | 5 lines

accommodate iov_len of type size_t (i.e., never negative)

* services/pload.c (send_message): Don't test for iov_len < 0,
since it can no longer happen.
* lib/evs.c: Fix a typo in an iov_len-related FIXME comment.
------------------------------------------------------------------------
r2017 | meyering | 2009-04-07 06:04:19 -0700 (Tue, 07 Apr 2009) | 3 lines

jhash.h (jhash2): make first parameter const

* include/corosync/jhash.h (jhash2): const.
------------------------------------------------------------------------
r2016 | meyering | 2009-04-07 06:04:11 -0700 (Tue, 07 Apr 2009) | 3 lines

lcr_comp.h: size_t

* include/corosync/lcr/lcr_comp.h (struct lcr_comp, struct lcr_iface):
------------------------------------------------------------------------
r2015 | meyering | 2009-04-07 06:04:04 -0700 (Tue, 07 Apr 2009) | 3 lines

list.h (list_empty): Make param const.

* include/corosync/list.h (list_empty): Make param const.
------------------------------------------------------------------------
r2014 | meyering | 2009-04-07 06:03:51 -0700 (Tue, 07 Apr 2009) | 3 lines

mar_cpg.h: make "src" params const.

* include/corosync/mar_cpg.h:
------------------------------------------------------------------------
r2013 | meyering | 2009-04-07 06:03:30 -0700 (Tue, 07 Apr 2009) | 4 lines

mar_gen.h: make params const

* include/corosync/mar_gen.h (get_mar_name_t, mar_name_match): const
* exec/util.h (get_mar_name_t, mar_name_match): Remove unneeded decls.
------------------------------------------------------------------------
r2012 | meyering | 2009-04-07 06:03:07 -0700 (Tue, 07 Apr 2009) | 6 lines

totemip.h: const'ify

* include/corosync/totem/totemip.h: Add const to prototypes.
* exec/totemip.c (totemip_equal, totemip_copy): Adjust.
(totemip_copy_endian_convert, totemip_localhost_check): Likewise.
(totemip_sockaddr_to_totemip_convert): Likewise.
------------------------------------------------------------------------
r2011 | meyering | 2009-04-07 06:02:43 -0700 (Tue, 07 Apr 2009) | 3 lines

sq.h: const'ify, and avoid NULL-deref

* include/corosync/sq.h (sq_init): Avoid NULL-deref on malloc failure.
------------------------------------------------------------------------
r2010 | meyering | 2009-04-07 06:02:13 -0700 (Tue, 07 Apr 2009) | 4 lines

queue.h: Replace #ifdef COROSYNC_SOLARIS...

* include/corosync/queue.h: Remove #ifdef COROSYNC_SOLARIS
in favor of agnostic "#ifdef queue".
------------------------------------------------------------------------
r2009 | meyering | 2009-04-07 06:01:55 -0700 (Tue, 07 Apr 2009) | 7 lines

logsys.h (logsys_format_set): Change return type, adjust param type.

* include/corosync/engine/logsys.h:
* exec/logsys.c (logsys_format_set): Return -1 upon strdup failure.
Change type of param to "const char *".
* exec/logsys.c (logsys_init): Adjust use.
* exec/mainconfig.c (corosync_main_config_read_logging): Adjust uses.
------------------------------------------------------------------------
r2008 | sdake | 2009-04-03 14:11:55 -0700 (Fri, 03 Apr 2009) | 2 lines

Revert constructor priority in logsys.

------------------------------------------------------------------------
r2007 | sdake | 2009-04-03 14:07:23 -0700 (Fri, 03 Apr 2009) | 2 lines

Remove extra printf from coropoll.

------------------------------------------------------------------------
r2006 | sdake | 2009-04-03 14:07:11 -0700 (Fri, 03 Apr 2009) | 2 lines

Fix timers not expiring.

------------------------------------------------------------------------
r2005 | meyering | 2009-04-03 13:31:45 -0700 (Fri, 03 Apr 2009) | 1 line

remove 3 useless casts
------------------------------------------------------------------------
r2004 | meyering | 2009-04-03 13:31:38 -0700 (Fri, 03 Apr 2009) | 7 lines

confdb.h (confdb_reload) Add errbuf_len parameter and propagate.

* include/corosync/confdb.h (confdb_callbacks_t):
* lib/confdb.c (confdb_reload):
* lib/sa-confdb.c (confdb_sa_reload):
* lib/sa-confdb.h:
* test/testconfdb.c (main):
------------------------------------------------------------------------
r2003 | meyering | 2009-04-03 13:31:24 -0700 (Fri, 03 Apr 2009) | 4 lines

confdb_sa_write: propagate errbuf_len parameter

* lib/sa-confdb.c (confdb_sa_write): Propagate errbuf_len parameter.
* lib/sa-confdb.h: Update prototype
------------------------------------------------------------------------
r2002 | meyering | 2009-04-03 13:31:12 -0700 (Fri, 03 Apr 2009) | 7 lines

confdb.h: error_text vs. buflen

* lib/confdb.c (MIN): Define.
(confdb_write): Use new errbuf_len parameter.
Also note bugs (Chrissie confirms) that error_text is not
set in two error-return cases.
* test/testconfdb.c (do_write_tests): Update use of confdb_write.
------------------------------------------------------------------------
r2001 | meyering | 2009-04-03 13:30:54 -0700 (Fri, 03 Apr 2009) | 5 lines

confdb.h: continue API changes: const+size_t

* include/corosync/confdb.h (confdb_object_create_notify_fn_t):
(confdb_object_delete_notify_fn_t):
* tools/corosync-objctl.c (tail_object_created, tail_object_deleted):
------------------------------------------------------------------------
r2000 | meyering | 2009-04-03 13:30:41 -0700 (Fri, 03 Apr 2009) | 7 lines

print "?" in place of non-printing bytes of obj/key/val values

* tools/corosync-objctl.c: Include <ctype.h>
(print_name): New function.
(tail_key_changed): Use it to avoid printing garbage to screen.
* include/corosync/confdb.h (confdb_key_change_notify_fn_t): Convert
type of "int" length params to "size_t".
------------------------------------------------------------------------
r1999 | meyering | 2009-04-03 13:30:33 -0700 (Fri, 03 Apr 2009) | 6 lines

confdb.h (confdb_key_change_notify_fn_t): Make 3 params "const"

* include/corosync/confdb.h (confdb_key_change_notify_fn_t):
Make 3 params const.
* tools/corosync-objctl.c (find_object_of_type_t, callbacks):
(tail_key_changed): Don't write into would-be-const members.
------------------------------------------------------------------------
r1998 | meyering | 2009-04-03 13:30:11 -0700 (Fri, 03 Apr 2009) | 3 lines

cfg.h: mark "address_length" as an unused member

* include/corosync/cfg.h: Add a FIXME comment.
------------------------------------------------------------------------
r1997 | meyering | 2009-04-03 13:29:50 -0700 (Fri, 03 Apr 2009) | 5 lines

cfg.h: adjust parameter types: const+s/int/size_t/

* lib/cfg.c (corosync_cfg_get_node_addrs): Make "max_addrs" size_t.
(corosync_cfg_kill_node): Make "reason" const.
* include/corosync/cfg.h: Update prototypes.
------------------------------------------------------------------------
r1996 | meyering | 2009-04-03 13:29:32 -0700 (Fri, 03 Apr 2009) | 5 lines

cfg.h: add const

* lib/cfg.c (corosync_cfg_service_load): Make service_name "const".
(corosync_cfg_service_unload): Likewise.
* include/corosync/cfg.h: Update prototypes.
------------------------------------------------------------------------
r1995 | meyering | 2009-04-03 11:35:04 -0700 (Fri, 03 Apr 2009) | 11 lines

coroipcc. h (coroipcc_dispatch_recv): Add a buflen parameter.

* lib/coroipcc.c (coroipcc_dispatch_recv): Update definition, and...
(memcpy_swrap): ... add a parameter here, too.
* include/corosync/coroipcc.h (coroipcc_dispatch_recv):
* lib/cfg.c (corosync_cfg_dispatch):
* lib/confdb.c (confdb_dispatch):
* lib/cpg.c (cpg_dispatch, cpg_flow_control_state_get):
* lib/evs.c (evs_dispatch):
* lib/quorum.c (quorum_dispatch):
* lib/votequorum.c (votequorum_dispatch):
------------------------------------------------------------------------
r1994 | meyering | 2009-04-03 09:25:43 -0700 (Fri, 03 Apr 2009) | 7 lines

coroipcc.h: add "const" to msg_send_reply_* "iov" parameters

* include/corosync/coroipcc.h (coroipcc_msg_send_reply_receive_in_buf):
Make "iov" const.
* lib/coroipcc.c (coroipcc_msg_send): Make iov const.
(coroipcc_msg_send_reply_receive): Likewise.
(coroipcc_msg_send_reply_receive_in_buf): Likewise.
------------------------------------------------------------------------
r1993 | meyering | 2009-04-03 09:22:41 -0700 (Fri, 03 Apr 2009) | 8 lines

confdb.c: add missing mutex-unlock calls after coroipcc_dispatch_recv

* lib/confdb.c (confdb_dispatch):
The code in lib/cfg.c's (corosync_cfg_dispatch) is nearly identical
to that in lib/confdb.c's (confdb_dispatch), but lacked two
pthread_mutex_unlock calls.

2009-04-03  Jim Meyering  <meyering@redhat.com>
------------------------------------------------------------------------
r1992 | fabbione | 2009-04-02 22:46:01 -0700 (Thu, 02 Apr 2009) | 2 lines

Drop unrequired struct

------------------------------------------------------------------------
r1991 | fabbione | 2009-04-02 22:45:36 -0700 (Thu, 02 Apr 2009) | 2 lines

Fix logsys construct execution priority

------------------------------------------------------------------------
r1990 | sdake | 2009-04-02 11:49:24 -0700 (Thu, 02 Apr 2009) | 2 lines

Patch to use snprintf where appropriate to avoid buffer overrun.

------------------------------------------------------------------------
r1989 | meyering | 2009-04-01 10:55:41 -0700 (Wed, 01 Apr 2009) | 4 lines

corosync-objctl.c: remove a just-added "const"

* tools/corosync-objctl.c (get_key): Remove just-added const from
2nd parameter.
------------------------------------------------------------------------
r1988 | sdake | 2009-04-01 10:39:18 -0700 (Wed, 01 Apr 2009) | 3 lines

Patch to document uid/gid and to default to allowing ais user to access 
services of corosync.

------------------------------------------------------------------------
r1987 | fabbione | 2009-04-01 06:24:20 -0700 (Wed, 01 Apr 2009) | 3 lines

add fileline/function_name support in corosync


------------------------------------------------------------------------
r1986 | fabbione | 2009-04-01 05:54:20 -0700 (Wed, 01 Apr 2009) | 5 lines

Fix last build warning in mainconfig.

Add a missing const.


------------------------------------------------------------------------
r1985 | meyering | 2009-04-01 02:34:01 -0700 (Wed, 01 Apr 2009) | 3 lines

remove unused file-scoped global

* tools/corosync-fplay.c (records_printed): Remove.
------------------------------------------------------------------------
r1984 | meyering | 2009-04-01 02:33:49 -0700 (Wed, 01 Apr 2009) | 3 lines

avoid prototype warnings, constify

* tools/corosync-fplay.c: Make many parameters and local pointers const.
------------------------------------------------------------------------
r1983 | meyering | 2009-04-01 02:33:36 -0700 (Wed, 01 Apr 2009) | 5 lines

remove unused functions and variable

* tools/corosync-fplay.c (sync_printer_nada): Remove function.
* tools/corosync-objctl.c (get_child_name): Remove function.
* test/evsverify.c (msg): Remove unused variable.
------------------------------------------------------------------------
r1982 | meyering | 2009-04-01 02:33:23 -0700 (Wed, 01 Apr 2009) | 9 lines

avoid prototype warnings

* test/evsbench.c: Declare functions/vars static.
* test/evsverify.c: Likewise.
* test/testcpg2.c: Likewise.
* test/testcpg.c: Likewise.
* test/logsysbench.c: Likewise.
* test/cpgbench.c: Likewise.
* exec/sync.c: Likewise.
------------------------------------------------------------------------
r1981 | meyering | 2009-04-01 02:33:15 -0700 (Wed, 01 Apr 2009) | 1 line

* test/testevs.c: avoid 2 warnings, decl "static"
------------------------------------------------------------------------
r1980 | meyering | 2009-04-01 02:33:07 -0700 (Wed, 01 Apr 2009) | 22 lines

declare many functions "static" (also avoids missing prototype warnings)

* exec/main.c (sigintr_handler, serialize_lock, serialize_unlock):
(serialize_lock, serialize_unlock):
* exec/sync.c (sync_start_init, sync_callbacks_load):
* exec/vsf_ykd.c (ykd_state_init):
* lcr/uis.c (cmd1):
* services/pload.c (send_message, token_callback, start_mcasting):
* tools/corosync-cfgtool.c (service_load_do, service_unload_do):
(shutdown_do, showaddrs_do, killnode_do, usage_do):
* tools/corosync-fplay.c (totemip_print, print_string_len):
(sync_printer_confchg_set_sync, sync_printer_set_sync_state):
(sync_printer_process_currentstate):
(sync_printer_process_get_shouldsync):
(sync_printer_checkpoint_release):
(sync_printer_checkpoint_transmit, sync_printer_section_transmit):
(sync_printer_checkpoint_receive, sync_printer_section_receive):
(sync_printer_nada, sync_printer_confchg_fn):
(printer_totemsrp_mcast, printer_totemsrp_delv):
(printer_totempg_mcast_fits, sync_printer_service_process):
* tools/corosync-objctl.c (get_child_name, get_parent_name):
(get_key):
------------------------------------------------------------------------
r1979 | meyering | 2009-04-01 02:32:48 -0700 (Wed, 01 Apr 2009) | 1 line

* exec/apidef.c: Include "apidef.h".
------------------------------------------------------------------------
r1978 | meyering | 2009-04-01 02:32:40 -0700 (Wed, 01 Apr 2009) | 5 lines

timer.c: connect with its published prototypes

* exec/timer.c: Include "timer.h".
* exec/timer.h (corosync_timer_init): Make return type in prototype
match the one in the function definition.
------------------------------------------------------------------------
r1977 | meyering | 2009-04-01 02:32:32 -0700 (Wed, 01 Apr 2009) | 7 lines

add "void" parameter list to avoid "isn't prototype" warning

* exec/objdb.c (objdb_wrlock, objdb_rdlock, objdb_rdunlock):
(objdb_wrunlock):
* services/cfg.c (send_shutdown, check_shutdown_status):
* services/votequorum.c (send_expectedvotes_notification):
* tools/corosync-cfgtool.c (shutdown_do):
------------------------------------------------------------------------
r1976 | fabbione | 2009-04-01 02:01:52 -0700 (Wed, 01 Apr 2009) | 2 lines

Fix internal API usage and add support for file_name

------------------------------------------------------------------------
r1975 | fabbione | 2009-03-31 22:48:03 -0700 (Tue, 31 Mar 2009) | 2 lines

Fix build warning

------------------------------------------------------------------------
r1974 | meyering | 2009-03-30 14:18:29 -0700 (Mon, 30 Mar 2009) | 4 lines

totemip.c: avoid 1 warning

* exec/totemip.c (totemip_print): Add const.
* include/corosync/totem/totemip.h: Ditto.
------------------------------------------------------------------------
r1973 | meyering | 2009-03-30 14:18:21 -0700 (Mon, 30 Mar 2009) | 3 lines

evsverify.c: avoid 1 warning

* test/evsverify.c: Add a const.
------------------------------------------------------------------------
r1972 | meyering | 2009-03-30 14:18:11 -0700 (Mon, 30 Mar 2009) | 3 lines

testcpg.c: avoid 1 warning

* test/testcpg.c (sigintr_handler): Mark as "noreturn".
------------------------------------------------------------------------
r1971 | meyering | 2009-03-30 14:18:04 -0700 (Mon, 30 Mar 2009) | 3 lines

evsbench.c: avoid 1 warning

* test/evsbench.c (sigintr_handler): Mark as "noreturn".
------------------------------------------------------------------------
r1970 | meyering | 2009-03-30 14:17:56 -0700 (Mon, 30 Mar 2009) | 3 lines

apidef.c: avoid 1 warning

* exec/apidef.c (_corosync_public_exit_error): Mark as "noreturn".
------------------------------------------------------------------------
r1969 | meyering | 2009-03-30 14:17:49 -0700 (Mon, 30 Mar 2009) | 3 lines

main.h: avoid 1 warning

* exec/main.c (corosync_exit): Mark as "noreturn".
------------------------------------------------------------------------
r1968 | meyering | 2009-03-30 14:17:42 -0700 (Mon, 30 Mar 2009) | 3 lines

logsys.c: avoid 1 warning

* exec/logsys.c (logsys_conf): Add const.
------------------------------------------------------------------------
r1967 | meyering | 2009-03-30 14:17:34 -0700 (Mon, 30 Mar 2009) | 4 lines

util.h: avoid 2 warnings

* exec/util.h (_corosync_out_of_memory_error): Mark as "noreturn".
(_corosync_exit_error): Likewise.
------------------------------------------------------------------------
r1966 | meyering | 2009-03-30 14:17:27 -0700 (Mon, 30 Mar 2009) | 3 lines

logsys.c: avoid 1 warning

* exec/logsys.c (logsys_worker_thread): Mark function as "noreturn".
------------------------------------------------------------------------
r1965 | meyering | 2009-03-30 14:17:19 -0700 (Mon, 30 Mar 2009) | 3 lines

wthread.c: avoid 1 warning

* exec/wthread.c (worker_thread): Mark function as "noreturn".
------------------------------------------------------------------------
r1964 | meyering | 2009-03-30 14:17:10 -0700 (Mon, 30 Mar 2009) | 4 lines

uis.c: don't infloop upon poll failure (e.g., ENOMEM)

* lcr/uis.c (lcr_uis_server): Return NULL for any poll failure
other than EINTR.  This also avoids a warning.
------------------------------------------------------------------------
r1963 | meyering | 2009-03-30 14:17:00 -0700 (Mon, 30 Mar 2009) | 4 lines

mar_gen.h, cfg.c: avoid 1 warning

* services/cfg.c (message_handler_req_exec_cfg_killnode):
* include/corosync/mar_gen.h (marshall_to_mar_name_t):
------------------------------------------------------------------------
r1962 | meyering | 2009-03-30 14:16:52 -0700 (Mon, 30 Mar 2009) | 3 lines

mainconfig.c: avoid 2 warnings

* exec/mainconfig.c (uid_determine, gid_determine): Add const.
------------------------------------------------------------------------
r1961 | meyering | 2009-03-30 14:16:44 -0700 (Mon, 30 Mar 2009) | 3 lines

service.c: avoid 5 warnings

* exec/service.c (struct default_service): Make "name" const.
------------------------------------------------------------------------
r1960 | meyering | 2009-03-30 14:16:37 -0700 (Mon, 30 Mar 2009) | 4 lines

totempg.h: avoid a warning

* include/corosync/totem/totempg.h (struct totempg_group):
Make "group" const.
------------------------------------------------------------------------
r1959 | meyering | 2009-03-30 14:16:24 -0700 (Mon, 30 Mar 2009) | 4 lines

main.c: avoid a few warnings FIXME: merge with another?

* exec/main.c (ipc_log_printf): Add const.
(main): tweak config_iface handling
------------------------------------------------------------------------
r1958 | meyering | 2009-03-30 14:16:17 -0700 (Mon, 30 Mar 2009) | 3 lines

testvotequorum1.c: avoid 5 warnings

* test/testvotequorum1.c (node_state): Return "const char *".
------------------------------------------------------------------------
r1957 | meyering | 2009-03-30 14:16:05 -0700 (Mon, 30 Mar 2009) | 3 lines

evsbench.c; avoid a format mismatch warning

* test/evsbench.c (evs_deliver_fn): %s vs. void*
------------------------------------------------------------------------
r1956 | meyering | 2009-03-30 14:15:57 -0700 (Mon, 30 Mar 2009) | 3 lines

coroparse.c: add const: avoid 2 warnings

* exec/coroparse.c: Add const.  Tweak s/fp==0/fp==NULL/
------------------------------------------------------------------------
r1955 | meyering | 2009-03-30 14:15:50 -0700 (Mon, 30 Mar 2009) | 3 lines

services/testquorum.c: avoid a warning

* services/testquorum.c (key_change_notify): Add const attributes.
------------------------------------------------------------------------
r1954 | meyering | 2009-03-30 14:15:32 -0700 (Mon, 30 Mar 2009) | 4 lines

avoid format mismatch warning

* test/testquorum.c (quorum_notification_fn): Add casts to
match formats.  Use unsigned formats for unsigned values.
------------------------------------------------------------------------
r1953 | meyering | 2009-03-30 14:15:25 -0700 (Mon, 30 Mar 2009) | 3 lines

testcpg2.c: avoid 1 warning

* test/testcpg2.c (main): Add a const-discarding cast.
------------------------------------------------------------------------
r1952 | meyering | 2009-03-30 14:15:17 -0700 (Mon, 30 Mar 2009) | 3 lines

testevs.c: avoid 2 more warnings

* test/testevs.c: Declare global to be "static const".
------------------------------------------------------------------------
r1951 | meyering | 2009-03-30 14:15:05 -0700 (Mon, 30 Mar 2009) | 1 line

* test/testcpg.c (main): Remove decl of unused var.
------------------------------------------------------------------------
r1950 | meyering | 2009-03-30 14:14:57 -0700 (Mon, 30 Mar 2009) | 1 line

confdb.c, objdb.h, coroapi.h: add a few const, remove one: 4 fewer warnings
------------------------------------------------------------------------
r1949 | meyering | 2009-03-30 14:14:49 -0700 (Mon, 30 Mar 2009) | 1 line

confdb.c: add a few const: avoid 3 more
------------------------------------------------------------------------
r1948 | meyering | 2009-03-30 14:14:41 -0700 (Mon, 30 Mar 2009) | 3 lines

coroipcs.h: avoid 3 warnings

* exec/coroipcs.h: Forward-declare "struct iovec".
------------------------------------------------------------------------
r1947 | meyering | 2009-03-30 14:14:28 -0700 (Mon, 30 Mar 2009) | 4 lines

avoid 1 warning

* services/evs.c (message_handler_req_exec_mcast): Introduce
a deliberate const-discarding cast and mark it with a comment.
------------------------------------------------------------------------
r1946 | meyering | 2009-03-30 14:14:16 -0700 (Mon, 30 Mar 2009) | 1 line

object_write_config: add const to remove one more
------------------------------------------------------------------------
r1945 | meyering | 2009-03-30 14:14:08 -0700 (Mon, 30 Mar 2009) | 1 line

logsys.c: fix two more warnings
------------------------------------------------------------------------
r1944 | meyering | 2009-03-30 14:14:00 -0700 (Mon, 30 Mar 2009) | 1 line

merge with "in progress" -- down 6 to 73 warnings
------------------------------------------------------------------------
r1943 | meyering | 2009-03-30 14:13:47 -0700 (Mon, 30 Mar 2009) | 1 line

in progress: avoid warnings
------------------------------------------------------------------------
r1942 | meyering | 2009-03-30 14:13:39 -0700 (Mon, 30 Mar 2009) | 1 line

votequorum.c (votequorum_qdisk_register): add "const" to avoid 1 more warnings
------------------------------------------------------------------------
r1941 | meyering | 2009-03-30 14:13:32 -0700 (Mon, 30 Mar 2009) | 1 line

votequorum.c: add "const" to avoid 2 more warnings
------------------------------------------------------------------------
r1940 | meyering | 2009-03-30 14:13:19 -0700 (Mon, 30 Mar 2009) | 3 lines

avoid 3 warnings

votequorum.c (kill_reason): Use "const char*" as return type, not "char *".
------------------------------------------------------------------------
r1939 | meyering | 2009-03-30 14:13:02 -0700 (Mon, 30 Mar 2009) | 4 lines

avoid 7 warnings

(struct sync_callbacks), (struct corosync_service_engine) [name]:
Make member const.
------------------------------------------------------------------------
r1938 | meyering | 2009-03-30 14:12:54 -0700 (Mon, 30 Mar 2009) | 1 line

votequorum.c: add "const" to avoid 2 more warnings
------------------------------------------------------------------------
r1937 | meyering | 2009-03-30 14:12:31 -0700 (Mon, 30 Mar 2009) | 1 line

totem*: add "const" to avoid 3 more warnings
------------------------------------------------------------------------
r1936 | meyering | 2009-03-30 14:12:19 -0700 (Mon, 30 Mar 2009) | 1 line

totem*: add "const" to avoid 1 more warning
------------------------------------------------------------------------
r1935 | meyering | 2009-03-30 14:12:11 -0700 (Mon, 30 Mar 2009) | 1 line

totem*: add "const" to avoid 1 more warning
------------------------------------------------------------------------
r1934 | meyering | 2009-03-30 14:12:03 -0700 (Mon, 30 Mar 2009) | 1 line

vsf_type: add "const" to avoid warning
------------------------------------------------------------------------
r1933 | meyering | 2009-03-30 14:11:55 -0700 (Mon, 30 Mar 2009) | 1 line

totemconfig.c: avoid another warning
------------------------------------------------------------------------
r1932 | meyering | 2009-03-30 14:11:46 -0700 (Mon, 30 Mar 2009) | 1 line

* exec/totemconfig.c: eliminate 8 const-related warnings
------------------------------------------------------------------------
r1931 | meyering | 2009-03-30 14:11:38 -0700 (Mon, 30 Mar 2009) | 1 line

objdb.c (object_reload_config): add const
------------------------------------------------------------------------
r1930 | meyering | 2009-03-30 14:11:25 -0700 (Mon, 30 Mar 2009) | 1 line

* exec/objdb.c (object_create): make "object_name" param const
------------------------------------------------------------------------
r1929 | meyering | 2009-03-30 14:11:17 -0700 (Mon, 30 Mar 2009) | 3 lines

add const to 3 params

* include/corosync/engine/objdb.h (object_key_change_notify_fn_t):
------------------------------------------------------------------------
r1928 | meyering | 2009-03-30 14:11:09 -0700 (Mon, 30 Mar 2009) | 5 lines

objdb.c, etc: add "const" to avoid warnings

* exec/objdb.c:
* include/corosync/engine/coroapi.h:
* include/corosync/engine/objdb.h:
------------------------------------------------------------------------
r1927 | meyering | 2009-03-30 14:11:00 -0700 (Mon, 30 Mar 2009) | 1 line

uis.c: avoid warnings
------------------------------------------------------------------------
r1926 | meyering | 2009-03-30 14:10:53 -0700 (Mon, 30 Mar 2009) | 3 lines

corosync-fplay.c: make more robust, avoid warnings

* tools/corosync-fplay.c (main): Diagnose malloc,open, and read failures
------------------------------------------------------------------------
r1925 | meyering | 2009-03-30 14:10:45 -0700 (Mon, 30 Mar 2009) | 1 line

service.[ch]: remove 7 const-related warnings
------------------------------------------------------------------------
r1924 | meyering | 2009-03-30 14:10:37 -0700 (Mon, 30 Mar 2009) | 1 line

coroipcs.[ch]: remove 4 const-related warnings
------------------------------------------------------------------------
r1923 | meyering | 2009-03-30 14:10:30 -0700 (Mon, 30 Mar 2009) | 1 line

totempg.c: remove one const-related warning
------------------------------------------------------------------------
r1922 | meyering | 2009-03-30 14:10:21 -0700 (Mon, 30 Mar 2009) | 5 lines

objdb.h: sync const-related from coroapi.h

* include/corosync/engine/objdb.h: mirror const-related changes
to coroapi.h.  FIXME: all of these identical API's should not
be separately modifiable.
------------------------------------------------------------------------
r1921 | meyering | 2009-03-30 14:10:13 -0700 (Mon, 30 Mar 2009) | 1 line

totempg.c: remove one const-related warning
------------------------------------------------------------------------
r1920 | meyering | 2009-03-30 14:10:04 -0700 (Mon, 30 Mar 2009) | 3 lines

pload.c: make a couple functions/interfaces const-correct

* services/pload.c: Remove unused file-scoped global "msg_no".
------------------------------------------------------------------------
r1919 | meyering | 2009-03-30 14:09:56 -0700 (Mon, 30 Mar 2009) | 1 line

logsys_config_facility_set: make "name" parameter const
------------------------------------------------------------------------
r1918 | meyering | 2009-03-30 14:09:47 -0700 (Mon, 30 Mar 2009) | 1 line

cfg.c: nearly warning-free
------------------------------------------------------------------------
r1917 | meyering | 2009-03-30 14:09:38 -0700 (Mon, 30 Mar 2009) | 1 line

cpg.c: resolve almost all warnings
------------------------------------------------------------------------
r1916 | meyering | 2009-03-30 09:33:39 -0700 (Mon, 30 Mar 2009) | 8 lines

timer.c: don't infloop upon poll failure (e.g., ENOMEM)

* exec/timer.c (prioritized_timer_thread): Remove unreached
call to pthread_exit after infloop.
Return NULL for any poll failure other than EINTR.
Use "continue" rather than an equivalent "goto".
Return NULL upon failed pthread_setschedparam.
This also avoids a warning.
------------------------------------------------------------------------
r1915 | meyering | 2009-03-30 07:33:49 -0700 (Mon, 30 Mar 2009) | 4 lines

logsys: detect write failure and avoid a file descriptor leak

* exec/logsys.c (logsys_log_rec_store): Close output file descriptor
and detect any failure.
------------------------------------------------------------------------
r1914 | meyering | 2009-03-30 07:33:42 -0700 (Mon, 30 Mar 2009) | 3 lines

totemconfig: avoid a file descriptor leak in the common case

* exec/totemconfig.c (read_keyfile): Don't leak a file descriptor.
------------------------------------------------------------------------
r1913 | fabbione | 2009-03-29 23:52:00 -0700 (Sun, 29 Mar 2009) | 3 lines

Fix pkgconfig generation


------------------------------------------------------------------------
r1912 | sdake | 2009-03-25 11:25:18 -0700 (Wed, 25 Mar 2009) | 3 lines

Make all threads use same scheduling priority even with -p option 
specified to avoid deadlock in spinlocks.

------------------------------------------------------------------------
r1911 | chrissie | 2009-03-25 08:54:31 -0700 (Wed, 25 Mar 2009) | 6 lines

Fix IPC when running on mac OS/X

Note that OS/X seems to be rather stingy about its IPC resources, so if things
crash you will probably have to clean up before starting it all again.


------------------------------------------------------------------------
r1910 | chrissie | 2009-03-25 08:38:56 -0700 (Wed, 25 Mar 2009) | 10 lines

The IPC system smply concatenates SOCKETDIR with run/<socketname> so if
th euser forgets to add a trailing slash to the name: eg

./configure --with-socket-dir=/var/run

then the socket is created as /var/runcorosync.ipc

This patch adds the slash into the name generation printf.


------------------------------------------------------------------------
r1909 | sdake | 2009-03-24 09:03:46 -0700 (Tue, 24 Mar 2009) | 2 lines

Appears to fix compile errors on macosx.

------------------------------------------------------------------------
r1908 | sdake | 2009-03-24 08:33:55 -0700 (Tue, 24 Mar 2009) | 2 lines

Change strcpy to sprintf to fix compile error.

------------------------------------------------------------------------
r1907 | meyering | 2009-03-24 06:05:55 -0700 (Tue, 24 Mar 2009) | 4 lines

Do not perform arithmetic on "void*" pointers.

* exec/vsf_ykd.c (ykd_deliver_fn): Do not perform "void*" arithmetic.
* services/votequorum.c (quorum_deliver_fn): Likewise.
------------------------------------------------------------------------
r1906 | meyering | 2009-03-24 06:05:47 -0700 (Tue, 24 Mar 2009) | 1 line

avoid performing 'void *' arithmetic, and add a few const attributes
------------------------------------------------------------------------
r1905 | meyering | 2009-03-24 03:39:00 -0700 (Tue, 24 Mar 2009) | 3 lines

avoid 6 warnings

* services/votequorum.c (objdb_get_int): Make "key" const.
------------------------------------------------------------------------
r1904 | meyering | 2009-03-24 03:38:52 -0700 (Tue, 24 Mar 2009) | 3 lines

avoid 8 warnings

* exec/totemconfig.c (objdb_get_string): Make "key" const.
------------------------------------------------------------------------
r1903 | meyering | 2009-03-24 03:38:39 -0700 (Tue, 24 Mar 2009) | 3 lines

avoid 9 warnings

* test/logsysbench.c (bm_finish): Make parameter "const".
------------------------------------------------------------------------
r1902 | meyering | 2009-03-24 03:38:26 -0700 (Tue, 24 Mar 2009) | 3 lines

avoid 13 warnings

* exec/mainconfig.c (objdb_get_string): Make "key" const.
------------------------------------------------------------------------
r1901 | meyering | 2009-03-24 03:38:13 -0700 (Tue, 24 Mar 2009) | 3 lines

avoid 22 warnings

* exec/totemconfig.c (objdb_get_int): Make "key" const.
------------------------------------------------------------------------
r1900 | meyering | 2009-03-24 03:38:00 -0700 (Tue, 24 Mar 2009) | 3 lines

avoid compiler warnings

* lcr/lcr_ifact.c (lcr_component_register): Remove decl of unused var.
------------------------------------------------------------------------
r1899 | meyering | 2009-03-24 03:05:43 -0700 (Tue, 24 Mar 2009) | 6 lines

avoid infloop upon out-of-memory or out-of-semaphores

* coroipc.c (cslib_service_connect): Upon shmget failure
loop only when errno == EEXIST.  Any other error now translates
to res_setup.error.
Likewise for semget.
------------------------------------------------------------------------
r1898 | fabbione | 2009-03-24 01:14:58 -0700 (Tue, 24 Mar 2009) | 2 lines

Make confdb log level consistent with the other services

------------------------------------------------------------------------
r1895 | fabbione | 2009-03-23 14:58:58 -0700 (Mon, 23 Mar 2009) | 4 lines

Fix expansion order within the Makefile.am with the pleasent
effect to avoid to include .lcrso files in make dist target


------------------------------------------------------------------------
r1893 | meyering | 2009-03-23 10:04:37 -0700 (Mon, 23 Mar 2009) | 3 lines

autogen.sh: prefer "automake" over automake-1.9

* autogen.sh: ...and don't accept ancient versions of automake.
------------------------------------------------------------------------
r1891 | sdake | 2009-03-23 07:42:38 -0700 (Mon, 23 Mar 2009) | 3 lines

Change dist to build corosync-trunk.tar.gz.


------------------------------------------------------------------------
r1890 | fabbione | 2009-03-22 11:44:33 -0700 (Sun, 22 Mar 2009) | 2 lines

Fix pkgconfig list of libraries we provide after ipc rework

------------------------------------------------------------------------
r1889 | fabbione | 2009-03-22 11:35:06 -0700 (Sun, 22 Mar 2009) | 3 lines

Fix 64bit alignment issue in totempg


------------------------------------------------------------------------
r1888 | sdake | 2009-03-22 08:38:05 -0700 (Sun, 22 Mar 2009) | 2 lines

Change OPENAIS to COROSYNC in libversions definitions.

------------------------------------------------------------------------
r1887 | sdake | 2009-03-22 08:37:48 -0700 (Sun, 22 Mar 2009) | 2 lines

Change OPENAIS to COROSYNC in ipc ifdefs.

------------------------------------------------------------------------
r1886 | sdake | 2009-03-22 08:31:40 -0700 (Sun, 22 Mar 2009) | 3 lines

Allow ipcc library to work on some arches which have different parameter 
passing requirements for enums.

------------------------------------------------------------------------
r1885 | sdake | 2009-03-22 08:28:54 -0700 (Sun, 22 Mar 2009) | 2 lines

Abstracted Shared Memory IPC library

------------------------------------------------------------------------
r1884 | sdake | 2009-03-21 04:25:48 -0700 (Sat, 21 Mar 2009) | 4 lines

This patch fixes a crash in cpg.c where a group is left befopre
cpg_finalise is called. It can cause the process_info structure to be
removed twice from the group list.

------------------------------------------------------------------------
r1883 | meyering | 2009-03-20 08:48:35 -0700 (Fri, 20 Mar 2009) | 7 lines

avoid buffer overrun when there are more than 128 path entries

* lcr_ifact.c (PATH_LIST_SIZE): Define.
(path_list): Use it.
(ld_library_path_build): Don't store into path_list[path_list_entries]
if the counter is too large.
(ldso_path_build): Likewise.
------------------------------------------------------------------------
r1882 | meyering | 2009-03-20 08:48:27 -0700 (Fri, 20 Mar 2009) | 4 lines

don't store (and later deref) NULL upon strdup failure

* lcr_ifact.c (ld_library_path_build, ldso_path_build):
Handle strdup failure.
------------------------------------------------------------------------
r1881 | meyering | 2009-03-20 08:48:19 -0700 (Fri, 20 Mar 2009) | 3 lines

don't segfault upon failed strdup

* sa-confdb.c (load_config): Handle out-of-memory.
------------------------------------------------------------------------
r1880 | sdake | 2009-03-19 23:55:49 -0700 (Thu, 19 Mar 2009) | 2 lines

Revert last change which broke corosync.

------------------------------------------------------------------------
r1879 | sdake | 2009-03-19 17:01:18 -0700 (Thu, 19 Mar 2009) | 3 lines

Reworked not to require stmt-after-decl support, plus another to fix a 
bug that would arise when parsing more than 128 paths.

------------------------------------------------------------------------
r1878 | sdake | 2009-03-19 16:50:35 -0700 (Thu, 19 Mar 2009) | 4 lines

While looking at used of LCRSODIR, I saw an unchecked strdup.
That could lead to a NULL dereference.


------------------------------------------------------------------------
r1877 | fabbione | 2009-03-19 05:58:53 -0700 (Thu, 19 Mar 2009) | 17 lines

- Every .c file should include "config.h" to get the right defines...

- services/Makefile.am: add include search paths for config.h

- include/corosync/cs_config.h.in exports LCRSODIR and SOCKETDIR

- tools/Makefile.am: drop -D defines for dirs that are now in
cs_config.h or config.h

- configure.ac: sanitize prefix and exec_prefix paths. Export DIRS in
*config.h

- lib/Makefile.am: : drop -D defines for dirs that are now in
cs_config.h or config.h. Add rule to build lcr_ifact.o or building from
lib/ fails miserably


------------------------------------------------------------------------
r1876 | sdake | 2009-03-19 03:27:17 -0700 (Thu, 19 Mar 2009) | 2 lines

Remove some unnecessary serializer functions.

------------------------------------------------------------------------
r1875 | sdake | 2009-03-19 03:20:37 -0700 (Thu, 19 Mar 2009) | 2 lines

Dont clobber stck on strings with length of zero.

------------------------------------------------------------------------
r1874 | sdake | 2009-03-19 03:20:19 -0700 (Thu, 19 Mar 2009) | 2 lines

Don't clobber stack on strings with length of zero.

------------------------------------------------------------------------
r1873 | sdake | 2009-03-19 02:56:39 -0700 (Thu, 19 Mar 2009) | 2 lines

Updated TODO for corosync.

------------------------------------------------------------------------
r1872 | fabbione | 2009-03-19 00:54:55 -0700 (Thu, 19 Mar 2009) | 2 lines

Fix corosync.pc installation

------------------------------------------------------------------------
r1871 | fabbione | 2009-03-18 22:41:23 -0700 (Wed, 18 Mar 2009) | 2 lines

Add missing libs from pkgconfig generation

------------------------------------------------------------------------
r1870 | fabbione | 2009-03-18 22:21:17 -0700 (Wed, 18 Mar 2009) | 2 lines

Fix logsys SONAME

------------------------------------------------------------------------
r1869 | fabbione | 2009-03-18 21:52:44 -0700 (Wed, 18 Mar 2009) | 2 lines

Don't use EXTRA_DIST in install/uninstall

------------------------------------------------------------------------
r1868 | sdake | 2009-03-18 14:51:07 -0700 (Wed, 18 Mar 2009) | 2 lines

Serialize access to service engines.

------------------------------------------------------------------------
r1867 | sdake | 2009-03-18 14:28:50 -0700 (Wed, 18 Mar 2009) | 2 lines

Fix coroapi.h header errors.

------------------------------------------------------------------------
r1866 | fabbione | 2009-03-18 03:17:50 -0700 (Wed, 18 Mar 2009) | 2 lines

Add missing uninstall-local targets and fix configuration intall target

------------------------------------------------------------------------
r1865 | fabbione | 2009-03-18 02:17:40 -0700 (Wed, 18 Mar 2009) | 2 lines

More cleanup for distcheck to work

------------------------------------------------------------------------
r1864 | chrissie | 2009-03-18 01:37:10 -0700 (Wed, 18 Mar 2009) | 3 lines

Add a dummy parameter to totemip_iface check so that it compiles on Darwin.


------------------------------------------------------------------------
r1863 | fabbione | 2009-03-18 01:30:25 -0700 (Wed, 18 Mar 2009) | 2 lines

Fix DARWIN_OPTS expansion

------------------------------------------------------------------------
r1862 | fabbione | 2009-03-18 00:52:48 -0700 (Wed, 18 Mar 2009) | 6 lines

Fix more soname= at linking

Start fixing distcheck

White space cleanups

------------------------------------------------------------------------
r1861 | fabbione | 2009-03-17 11:37:03 -0700 (Tue, 17 Mar 2009) | 9 lines

- tidy up whitespaces

- try to keep everything < 80 cols

- stop installing testing lcrso

- fix soname= invokation


------------------------------------------------------------------------
r1860 | fabbione | 2009-03-17 06:25:12 -0700 (Tue, 17 Mar 2009) | 2 lines

Fix doc stuff

------------------------------------------------------------------------
r1859 | fabbione | 2009-03-17 06:06:56 -0700 (Tue, 17 Mar 2009) | 2 lines

Update index.html to reflect new changes in man/Makefile.am

------------------------------------------------------------------------
r1858 | fabbione | 2009-03-17 05:44:47 -0700 (Tue, 17 Mar 2009) | 2 lines

Drop tarball name from AC_INIT as it confuses the hell out of what we need

------------------------------------------------------------------------
r1857 | fabbione | 2009-03-17 05:43:41 -0700 (Tue, 17 Mar 2009) | 2 lines

Fix the whole manpage stuff

------------------------------------------------------------------------
r1856 | fabbione | 2009-03-17 03:46:19 -0700 (Tue, 17 Mar 2009) | 2 lines

Add support for SOCKETDIR

------------------------------------------------------------------------
r1855 | fabbione | 2009-03-17 03:03:18 -0700 (Tue, 17 Mar 2009) | 2 lines

Add corosync.pc support

------------------------------------------------------------------------
r1854 | fabbione | 2009-03-17 02:53:39 -0700 (Tue, 17 Mar 2009) | 3 lines

remove hardcoded /var and use localstatedir
instead.

------------------------------------------------------------------------
r1853 | fabbione | 2009-03-16 06:54:40 -0700 (Mon, 16 Mar 2009) | 15 lines

configure.ac:
 - Fix white space for --help.
 - Drop LCRSODIR as global and move it to local directory.

all */Makefile.am:
 - export -DDIRECTORY_NAME as required (for now only LCRSO and
SYSCONFDIR)

top level Makefile.am:
- drop hardcoded ETCDIR that is just wrong and use the configured one

*.c files around:
- drop hardcoded ETCDIR and use configured one.


------------------------------------------------------------------------
r1852 | fabbione | 2009-03-16 06:15:25 -0700 (Mon, 16 Mar 2009) | 3 lines

Fix LCRSO handling


------------------------------------------------------------------------
r1851 | fabbione | 2009-03-16 04:50:19 -0700 (Mon, 16 Mar 2009) | 2 lines

Make everything < 80 cols

------------------------------------------------------------------------
r1850 | fabbione | 2009-03-16 04:36:49 -0700 (Mon, 16 Mar 2009) | 6 lines

remove comment

fix quoting

make GCC test portable

------------------------------------------------------------------------
r1849 | fabbione | 2009-03-16 04:01:50 -0700 (Mon, 16 Mar 2009) | 3 lines

Major configure.in/ac cleanup


------------------------------------------------------------------------
r1848 | fabbione | 2009-03-13 03:02:09 -0700 (Fri, 13 Mar 2009) | 18 lines

- Fix macro typo for PROG_CC_C_O.

- add --enable-debug configure option to #define DEBUG 1 and set
compiler options to default to -O0.

- restore default -O3.

- Drop some random leftovers (CC_IN_CONFIGURE, AISPREFIX, SSH path check
and ppc64 -m64).

- Remove yet another GCC test as -g is automatically detected by
autoconf macros.

- Cleanup a bit deprecated ARCH section.

- Tidy up RESULT section.


------------------------------------------------------------------------
r1847 | fabbione | 2009-03-13 01:26:56 -0700 (Fri, 13 Mar 2009) | 12 lines

- remove --enable-static option as it is not required. This was a
leftover from gcc-2.x something time. corosync binary should always be
built dynamic.

- fix quorum_* target as it was missing the list of objects to be linked
in.. doh!

- fix object dependencies between TARGET, TARGET_OBJS and TARGET_SRC.
This also fixes the build/relink issues at install times that have been
noted before.


------------------------------------------------------------------------
r1846 | sdake | 2009-03-12 10:13:42 -0700 (Thu, 12 Mar 2009) | 2 lines

All integers received from objdb_get_int had invalid handle type.

------------------------------------------------------------------------
r1845 | sdake | 2009-03-12 09:15:34 -0700 (Thu, 12 Mar 2009) | 2 lines

Use nocheck flagging on confchg iteration of handle ids.

------------------------------------------------------------------------
r1844 | chrissie | 2009-03-12 07:30:58 -0700 (Thu, 12 Mar 2009) | 2 lines

Fix testconfdb use of object handles.

------------------------------------------------------------------------
r1843 | sdake | 2009-03-11 16:48:05 -0700 (Wed, 11 Mar 2009) | 2 lines

Set correct OBJECT_PARENT_HANDLE define in coroapi.h

------------------------------------------------------------------------
r1842 | sdake | 2009-03-11 16:28:01 -0700 (Wed, 11 Mar 2009) | 2 lines

Add handle checking to the hdb system.

------------------------------------------------------------------------
r1841 | sdake | 2009-03-11 16:09:04 -0700 (Wed, 11 Mar 2009) | 4 lines

Fix several errors in objdb notification handling, hdb_handle_t type 
conversion errors, indentation, and do hdb_handle_put after instance 
data is used instead of before.

------------------------------------------------------------------------
r1840 | sdake | 2009-03-11 16:06:18 -0700 (Wed, 11 Mar 2009) | 2 lines

Use hdb_handle_t for handle type in service.c.

------------------------------------------------------------------------
r1839 | sdake | 2009-03-11 16:05:41 -0700 (Wed, 11 Mar 2009) | 2 lines

Use hdb_handle_t for handle type in lcr_ifact.

------------------------------------------------------------------------
r1838 | fabbione | 2009-03-11 05:30:52 -0700 (Wed, 11 Mar 2009) | 2 lines

Fix library linking

------------------------------------------------------------------------
r1837 | fabbione | 2009-03-11 04:33:19 -0700 (Wed, 11 Mar 2009) | 2 lines

Fix more build/install glitches

------------------------------------------------------------------------
r1836 | sdake | 2009-03-11 04:27:20 -0700 (Wed, 11 Mar 2009) | 2 lines

Fix broken error check in commit 1818.

------------------------------------------------------------------------
r1835 | fabbione | 2009-03-11 02:06:35 -0700 (Wed, 11 Mar 2009) | 19 lines

1) kill all those "for" shell loops. They are dangerous (as they don't
report install failures) and it's just overhead since $(INSTALL) can do
the same.

2) make sure to create our directories with $(INSTALL). Not sure I did
catch them all yet, but at least a good bunch. This also fix the
corosync.conf install error I introduced in the previous commit.

3) Handle SONAME automatically. This is the most intrusive change across
the board:

 * configure.in now defines the system wide SOMAJOR, SOMINOR, SOMICRO
and SONAME and exports them to the Makefile.
 * exec/Makefile.am, lib/Makefile.am are now updated to use those vars
rather than hardcoded version.

4) Bump the SOMAJOR to 3 as agreed since we did change both API and ABI.


------------------------------------------------------------------------
r1834 | fabbione | 2009-03-11 01:03:55 -0700 (Wed, 11 Mar 2009) | 2 lines

Dear pacemaker.. you will not take over this project! MUAHAH

------------------------------------------------------------------------
r1833 | fabbione | 2009-03-11 00:54:30 -0700 (Wed, 11 Mar 2009) | 2 lines

Drop ld.conf file that is now unrequired

------------------------------------------------------------------------
r1832 | fabbione | 2009-03-11 00:28:12 -0700 (Wed, 11 Mar 2009) | 3 lines

Readd pkgconfig subdir to the build system and port it
to autoconf

------------------------------------------------------------------------
r1831 | fabbione | 2009-03-10 22:52:48 -0700 (Tue, 10 Mar 2009) | 2 lines

Add entries to maintainer-clean target

------------------------------------------------------------------------
r1830 | sdake | 2009-03-10 21:47:08 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove warnings from coroipc.c.

------------------------------------------------------------------------
r1829 | sdake | 2009-03-10 21:41:23 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove warnings from ipc.c

------------------------------------------------------------------------
r1828 | chrissie | 2009-03-10 10:13:37 -0700 (Tue, 10 Mar 2009) | 2 lines

Fix some const warnings

------------------------------------------------------------------------
r1827 | fabbione | 2009-03-10 06:18:11 -0700 (Tue, 10 Mar 2009) | 2 lines

Add dynamic timestamp on/off

------------------------------------------------------------------------
r1826 | sdake | 2009-03-10 05:22:55 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove const warnings in crypto.c.

------------------------------------------------------------------------
r1825 | sdake | 2009-03-10 05:22:38 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove qualifier errors in main.c

------------------------------------------------------------------------
r1824 | sdake | 2009-03-10 05:08:32 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove const warnings from uic system.

------------------------------------------------------------------------
r1823 | sdake | 2009-03-10 04:57:21 -0700 (Tue, 10 Mar 2009) | 2 lines

change some char * to const char * to match usage in system in lcr.

------------------------------------------------------------------------
r1822 | sdake | 2009-03-10 04:53:43 -0700 (Tue, 10 Mar 2009) | 2 lines

Fix const qualifiers in lcr_ifact.c.

------------------------------------------------------------------------
r1821 | sdake | 2009-03-10 04:45:00 -0700 (Tue, 10 Mar 2009) | 2 lines

Fix missing prototypes in totempg.c.

------------------------------------------------------------------------
r1820 | sdake | 2009-03-10 04:42:10 -0700 (Tue, 10 Mar 2009) | 2 lines

Fix missing prototypes in totemmrp.

------------------------------------------------------------------------
r1819 | sdake | 2009-03-10 04:40:12 -0700 (Tue, 10 Mar 2009) | 2 lines

Fix missing prototypes and mismatched prototypes in totemmrp.

------------------------------------------------------------------------
r1818 | sdake | 2009-03-10 04:30:34 -0700 (Tue, 10 Mar 2009) | 4 lines

Add missing hdb_handle_put in totemsrp and handle errors in mkdir and 
chdir properly.


------------------------------------------------------------------------
r1817 | sdake | 2009-03-10 04:23:57 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove string literal warnings from totemsrp.

------------------------------------------------------------------------
r1816 | sdake | 2009-03-10 04:21:23 -0700 (Tue, 10 Mar 2009) | 2 lines

Add missing prototypes in totemsrp.

------------------------------------------------------------------------
r1815 | sdake | 2009-03-10 04:14:28 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove pointer math warnings from totemsrp.

------------------------------------------------------------------------
r1814 | sdake | 2009-03-10 04:08:49 -0700 (Tue, 10 Mar 2009) | 3 lines

Define undefined prototypes


------------------------------------------------------------------------
r1813 | sdake | 2009-03-10 04:04:12 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove string literal warnings from totemrrp.

------------------------------------------------------------------------
r1812 | sdake | 2009-03-10 03:35:14 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove const warnings from main.c.

------------------------------------------------------------------------
r1811 | sdake | 2009-03-10 03:32:09 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove type casting to (char *) in logsys.h.

------------------------------------------------------------------------
r1810 | sdake | 2009-03-10 03:12:52 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove pointer math from totempg.

------------------------------------------------------------------------
r1809 | sdake | 2009-03-10 03:09:43 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove pointer math warnings from totemnet.

------------------------------------------------------------------------
r1808 | sdake | 2009-03-10 03:05:40 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove const warnings in totemip code.

------------------------------------------------------------------------
r1807 | chrissie | 2009-03-10 02:58:07 -0700 (Tue, 10 Mar 2009) | 8 lines

Quorum checks the ring ID is new before initiating a sync. Unfortunately
it copies the ring ID BEFORE checking it so there is always a match.

Sigh

This patch fixes it.


------------------------------------------------------------------------
r1806 | sdake | 2009-03-10 02:48:34 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove const warnings relating to logsys global definitions.

------------------------------------------------------------------------
r1805 | sdake | 2009-03-10 02:40:54 -0700 (Tue, 10 Mar 2009) | 3 lines

Remove logsys warnings.


------------------------------------------------------------------------
r1804 | sdake | 2009-03-10 02:34:20 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove const warnings in totempg.

------------------------------------------------------------------------
r1803 | sdake | 2009-03-10 02:30:29 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove const warnings from totemsrp.

------------------------------------------------------------------------
r1802 | sdake | 2009-03-10 02:25:43 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove qualifier warnings regarding totemrrp.

------------------------------------------------------------------------
r1801 | sdake | 2009-03-10 02:22:08 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove const/nonconst assignment warnings in totemnet.

------------------------------------------------------------------------
r1800 | sdake | 2009-03-10 02:00:15 -0700 (Tue, 10 Mar 2009) | 2 lines

Remove leftover from automake merge.

------------------------------------------------------------------------
r1799 | sdake | 2009-03-10 01:39:48 -0700 (Tue, 10 Mar 2009) | 2 lines

Add missing committed file for automake.

------------------------------------------------------------------------
r1798 | sdake | 2009-03-10 01:35:41 -0700 (Tue, 10 Mar 2009) | 2 lines

Automake.  The journey begins.

------------------------------------------------------------------------
r1797 | fabbione | 2009-03-10 01:03:50 -0700 (Tue, 10 Mar 2009) | 3 lines

Add logsys_format_get to logsys API.


------------------------------------------------------------------------
r1796 | fabbione | 2009-03-10 00:11:17 -0700 (Tue, 10 Mar 2009) | 2 lines

logsys_format_set should use its own internal copy of format_buffer

------------------------------------------------------------------------
r1795 | fabbione | 2009-03-09 05:59:40 -0700 (Mon, 09 Mar 2009) | 2 lines

Cleanup logsys format init around to use default settings

------------------------------------------------------------------------
r1794 | chrissie | 2009-03-06 03:07:35 -0700 (Fri, 06 Mar 2009) | 15 lines

The IPC patch broke CFG shutdown in several places, this patches fixes
all of them.

In particular, cfg_try_shutdown asks all applications that are
registered for callbacks if they approve the shutdown. This caused a bit
of a re-entrancy problem because it also asked the process that called
for the shutdown! The patch causes cfg to only ask OTHER applications in
the assumption that any application that calls
corosync_cfg_tryshutdown() will approve of the action :-)

In addition it adds the response to cfg_replyto_shutdown which was
missing (it couldn't be used with the old system but is mandatory now),
and removes a double-free in the library finalise code.


------------------------------------------------------------------------
r1793 | sdake | 2009-03-06 00:38:34 -0700 (Fri, 06 Mar 2009) | 3 lines

Add reserve/release functionality to totem to reserve message queue 
space.

------------------------------------------------------------------------
r1792 | fabbione | 2009-03-06 00:09:24 -0700 (Fri, 06 Mar 2009) | 3 lines

Allow logsys_format_set to reset to default.


------------------------------------------------------------------------
r1791 | sdake | 2009-03-05 19:42:48 -0700 (Thu, 05 Mar 2009) | 3 lines

Use list_del on process info in the condition that lib_exit_fn is called 
to prevent segfault from processes later processing that list entry.

------------------------------------------------------------------------
r1790 | fabbione | 2009-03-04 03:14:36 -0700 (Wed, 04 Mar 2009) | 3 lines

logsys: re-add support for timestamp that was lost in the
upgrade from v1 to v2

------------------------------------------------------------------------
r1789 | fabbione | 2009-03-04 03:13:26 -0700 (Wed, 04 Mar 2009) | 3 lines

Fix logsys_set_format by updating the right bits


------------------------------------------------------------------------
r1788 | fabbione | 2009-03-02 20:57:37 -0700 (Mon, 02 Mar 2009) | 3 lines

Fix uninitialized memory. Spotted by valgrind


------------------------------------------------------------------------
r1786 | sdake | 2009-03-02 17:58:16 -0700 (Mon, 02 Mar 2009) | 3 lines

Rework a bit of how lib_exit_fn works so that reference counts may be 
used in the exit functions for services such as cpg.

------------------------------------------------------------------------
r1785 | sdake | 2009-03-02 17:57:44 -0700 (Mon, 02 Mar 2009) | 3 lines

Lock cpg ipc connections into memory on lib_init_fn and remove lock on 
lib_exit_fn.

------------------------------------------------------------------------
r1784 | chrissie | 2009-02-26 07:51:18 -0700 (Thu, 26 Feb 2009) | 9 lines

This patch fixes some minor bugs in the expected_votes behaviour and
adds a couple of new features:

- When total_votes exceeds the expected_votes value then expected_votes
is increased to that value.

- A callback can be sent to a client whenever expected_votes is changed


------------------------------------------------------------------------
r1783 | chrissie | 2009-02-26 07:49:41 -0700 (Thu, 26 Feb 2009) | 9 lines

The current object database allows duplicate key names per object. This
is a bit of a nightmare to manage and provides no useful functionality
that I can see. Making keys unique has been discussed on IRC several
times and there seem to be no objections...so here is the patch:

Note that I have removed some now-useless parameters from the objdb API
too.


------------------------------------------------------------------------
r1782 | sdake | 2009-02-25 04:14:47 -0700 (Wed, 25 Feb 2009) | 2 lines

Unification around hdb_handle_t data type.

------------------------------------------------------------------------
r1781 | sdake | 2009-02-24 23:54:42 -0700 (Tue, 24 Feb 2009) | 2 lines

Send configuration changes to CPG listeners.  (regression in IPC patch).

------------------------------------------------------------------------
r1780 | fabbione | 2009-02-24 21:58:08 -0700 (Tue, 24 Feb 2009) | 2 lines

Install corosync-fplay and corosync-pload binaries

------------------------------------------------------------------------
r1779 | sdake | 2009-02-24 21:55:32 -0700 (Tue, 24 Feb 2009) | 2 lines

Fix possible segfault with IPC service.

------------------------------------------------------------------------
r1778 | sdake | 2009-02-24 21:55:06 -0700 (Tue, 24 Feb 2009) | 2 lines

Remove extra printf debug.

------------------------------------------------------------------------
r1777 | sdake | 2009-02-24 03:32:23 -0700 (Tue, 24 Feb 2009) | 2 lines

Remove installation of static libcoroipc.a.

------------------------------------------------------------------------
r1776 | sdake | 2009-02-23 23:15:17 -0700 (Mon, 23 Feb 2009) | 2 lines

Fix problem with 1722 commit which broke ipc.

------------------------------------------------------------------------
r1775 | chrissie | 2009-02-23 08:26:21 -0700 (Mon, 23 Feb 2009) | 2 lines

Move VOTEQUORUM_SERVICE to ipc_gen.h where it belongs.

------------------------------------------------------------------------
r1774 | chrissie | 2009-02-23 01:53:45 -0700 (Mon, 23 Feb 2009) | 10 lines

When a quorum device registers it tells the corosync quorum engine of
the new quorum which then tries to do a new sync(). But that's no use
because the nodelist and ring_id is identical to before. Also it can try
and register while a sync is already in operation ... which gets it
awfully stuck!

So this patch makes the sync conditional on there being a new ring ID to
do a sync on.


------------------------------------------------------------------------
r1773 | chrissie | 2009-02-20 09:02:06 -0700 (Fri, 20 Feb 2009) | 5 lines

Fix problem in disallowed mode that prevented a HASSTATE node joining
a cluster without state or vice-versa
see Red Hat BZ#485026


------------------------------------------------------------------------
r1772 | chrissie | 2009-02-20 01:24:40 -0700 (Fri, 20 Feb 2009) | 2 lines

Don't crash if a library tries to talk to a module that is not loaded

------------------------------------------------------------------------
r1771 | chrissie | 2009-02-20 00:46:15 -0700 (Fri, 20 Feb 2009) | 2 lines

Allow CPG messages to be sent on an inquorate cluster

------------------------------------------------------------------------
r1770 | chrissie | 2009-02-19 08:30:20 -0700 (Thu, 19 Feb 2009) | 2 lines

Fix crash in confdb_finalize

------------------------------------------------------------------------
r1769 | chrissie | 2009-02-19 01:42:31 -0700 (Thu, 19 Feb 2009) | 2 lines

Get rid of one crash in confdb. It still double-frees in confdb_finalize though.

------------------------------------------------------------------------
r1768 | chrissie | 2009-02-19 01:38:40 -0700 (Thu, 19 Feb 2009) | 2 lines

Fix crashes in quorum_initialize & votequorum_initialize

------------------------------------------------------------------------
r1767 | fabbione | 2009-02-19 01:05:52 -0700 (Thu, 19 Feb 2009) | 7 lines

Fix build error spotted by gcc-4.4

#elif with no clause is clearly wrong and continuing when we don't
know the byte order only defers the problem to a point where its much
harder to debug


------------------------------------------------------------------------
r1766 | sdake | 2009-02-18 19:23:58 -0700 (Wed, 18 Feb 2009) | 3 lines

Whitetank IPC Forward Port.


------------------------------------------------------------------------
r1764 | sdake | 2009-02-17 19:13:30 -0700 (Tue, 17 Feb 2009) | 2 lines

Remove redundant statement in totemsrp.

------------------------------------------------------------------------
r1763 | sdake | 2009-02-17 19:07:59 -0700 (Tue, 17 Feb 2009) | 2 lines

Use definition instead of magic number.

------------------------------------------------------------------------
r1762 | sdake | 2009-02-17 19:06:13 -0700 (Tue, 17 Feb 2009) | 2 lines

Update link for upstream crypto code.

------------------------------------------------------------------------
r1761 | rohara | 2009-02-17 18:28:35 -0700 (Tue, 17 Feb 2009) | 4 lines

Add timer_expire_time_get
Add timer_expire_time_get corosync API call.


------------------------------------------------------------------------
r1760 | rohara | 2009-02-13 19:06:20 -0700 (Fri, 13 Feb 2009) | 4 lines


Add timer_time_get to the corosync API.


------------------------------------------------------------------------
r1759 | chrissie | 2009-02-13 02:21:57 -0700 (Fri, 13 Feb 2009) | 3 lines

Add corosync_cfg_local_get() call to get the local NodeID in libcfg


------------------------------------------------------------------------
r1758 | rohara | 2009-02-11 17:45:19 -0700 (Wed, 11 Feb 2009) | 4 lines


Add TMR_SERVICE to the list of service_types.


------------------------------------------------------------------------
r1757 | chrissie | 2009-02-03 09:30:02 -0700 (Tue, 03 Feb 2009) | 4 lines

Fix "leave" function where the remaining nodes recalculate quorum when a 
node leaves. Also add a timeout to the leave flag.


------------------------------------------------------------------------
r1756 | fabbione | 2009-01-30 11:44:13 -0700 (Fri, 30 Jan 2009) | 2 lines

fix pkgconfig builddir creation

------------------------------------------------------------------------
r1755 | fabbione | 2009-01-30 11:25:04 -0700 (Fri, 30 Jan 2009) | 2 lines

Add .pc file support for corosync libs

------------------------------------------------------------------------
r1754 | chrissie | 2009-01-30 06:31:40 -0700 (Fri, 30 Jan 2009) | 2 lines

Add quorum_fd_get and votequorum_fd_get prototypes

------------------------------------------------------------------------
r1753 | chrissie | 2009-01-30 04:56:34 -0700 (Fri, 30 Jan 2009) | 2 lines

Make cfg_get_node_addrs return CS_OK rather than 0 when it succeeds.

------------------------------------------------------------------------
r1752 | chrissie | 2009-01-29 07:21:05 -0700 (Thu, 29 Jan 2009) | 2 lines

Fix votequorum_getinfo returning the wrong value for expected_votes

------------------------------------------------------------------------
r1751 | chrissie | 2009-01-29 02:17:43 -0700 (Thu, 29 Jan 2009) | 2 lines

Remove the last bicapitalised name from cfg

------------------------------------------------------------------------
r1750 | chrissie | 2009-01-27 01:59:14 -0700 (Tue, 27 Jan 2009) | 5 lines

Don't automatically load the quorum service.

This will, for the time being, unbreak synchronisation.


------------------------------------------------------------------------
r1749 | sdake | 2009-01-26 13:46:45 -0700 (Mon, 26 Jan 2009) | 2 lines

Fix node masking for 32 bit node ids.

------------------------------------------------------------------------
r1746 | sdake | 2009-01-26 13:22:28 -0700 (Mon, 26 Jan 2009) | 2 lines

Allow crypto to work on systems where unsigned long evaluates to 8 bytes. (s390x).

------------------------------------------------------------------------
r1745 | chrissie | 2009-01-26 03:46:08 -0700 (Mon, 26 Jan 2009) | 2 lines

Add the votequorum service

------------------------------------------------------------------------
r1744 | sdake | 2009-01-25 14:25:25 -0700 (Sun, 25 Jan 2009) | 4 lines

Fix error where entire message was not rejected during startup of a new
node resulting in partial delivery of a complete message and segfaulting
the executive.

------------------------------------------------------------------------
r1743 | sdake | 2009-01-25 14:15:25 -0700 (Sun, 25 Jan 2009) | 2 lines

Fix message rejection problem.

------------------------------------------------------------------------
r1742 | fabbione | 2009-01-23 09:12:13 -0700 (Fri, 23 Jan 2009) | 2 lines

cleanup handling of uid/gid config

------------------------------------------------------------------------
r1741 | chrissie | 2009-01-23 08:41:06 -0700 (Fri, 23 Jan 2009) | 9 lines

Fix a couple of memory leaks

The objdb occurred because object_find_destroy wasn't implemented!
 
The one in confdb occurred because object_find_destroy wasn't called if
object_find_next returned an error the first time it was invoked (ie
there were no subobjects).


------------------------------------------------------------------------
r1740 | fabbione | 2009-01-23 07:27:58 -0700 (Fri, 23 Jan 2009) | 2 lines

fix logging reload operation and clean up main init

------------------------------------------------------------------------
r1739 | fabbione | 2009-01-23 07:25:30 -0700 (Fri, 23 Jan 2009) | 3 lines

don't keep logsys fd open unless it's required


------------------------------------------------------------------------
r1738 | chrissie | 2009-01-22 02:48:23 -0700 (Thu, 22 Jan 2009) | 2 lines

Install quorum.h 

------------------------------------------------------------------------
r1737 | chrissie | 2009-01-21 08:57:12 -0700 (Wed, 21 Jan 2009) | 2 lines

Install quorum library

------------------------------------------------------------------------
r1735 | sdake | 2009-01-20 10:59:10 -0700 (Tue, 20 Jan 2009) | 2 lines

Complete poll_stop function.

------------------------------------------------------------------------
r1734 | sdake | 2009-01-20 10:41:45 -0700 (Tue, 20 Jan 2009) | 2 lines

Cancel token holding mode when a totem token callback is added to the system.

------------------------------------------------------------------------
r1733 | chrissie | 2009-01-20 06:19:05 -0700 (Tue, 20 Jan 2009) | 2 lines

Add OBJDB_RELOAD_NOTIFY_FAILED which was missing from coroapi

------------------------------------------------------------------------
r1732 | chrissie | 2009-01-19 01:31:21 -0700 (Mon, 19 Jan 2009) | 2 lines

Make all the bicapitalised names in cfg more sensible.

------------------------------------------------------------------------
r1731 | fabbione | 2009-01-16 01:59:09 -0700 (Fri, 16 Jan 2009) | 4 lines

Clean up tag handling and provide functions to match name with values and
viceversa.


------------------------------------------------------------------------
r1730 | fabbione | 2009-01-16 01:44:15 -0700 (Fri, 16 Jan 2009) | 3 lines

restore the priority setting that was lost


------------------------------------------------------------------------
r1729 | fabbione | 2009-01-15 05:06:40 -0700 (Thu, 15 Jan 2009) | 3 lines

Remove duplicate code and use the right library call into logsys
that also cover cases that were not handled at all.

------------------------------------------------------------------------
r1728 | fabbione | 2009-01-15 04:33:47 -0700 (Thu, 15 Jan 2009) | 3 lines

Fix small memory leak on config reload operations


------------------------------------------------------------------------
r1727 | fabbione | 2009-01-14 04:00:23 -0700 (Wed, 14 Jan 2009) | 3 lines

Fix logsys write to file crash.


------------------------------------------------------------------------
r1726 | chrissie | 2009-01-14 02:27:40 -0700 (Wed, 14 Jan 2009) | 3 lines

add corosync_cfg_get_node_addrs() call.


------------------------------------------------------------------------
r1725 | chrissie | 2009-01-14 01:33:44 -0700 (Wed, 14 Jan 2009) | 2 lines

Add some mussing pthread_mutex_lock() calls.

------------------------------------------------------------------------
r1724 | chrissie | 2009-01-08 09:55:47 -0700 (Thu, 08 Jan 2009) | 2 lines

Build testquorum on Darwin

------------------------------------------------------------------------
r1723 | chrissie | 2009-01-08 04:38:17 -0700 (Thu, 08 Jan 2009) | 2 lines

Don't always overwrite /etc/corosync.conf when make install is run.

------------------------------------------------------------------------
r1722 | chrissie | 2009-01-08 04:12:10 -0700 (Thu, 08 Jan 2009) | 6 lines

If there was a quorum {} section in corosync.conf but no provider specified
then  we would always report inquorate.

This was wrong, if no provider is specified then we are always quorate.


------------------------------------------------------------------------
r1721 | sdake | 2009-01-07 23:29:16 -0700 (Wed, 07 Jan 2009) | 2 lines

Patch to allow cpg_membership_get to work properly.

------------------------------------------------------------------------
r1720 | asalkeld | 2009-01-07 10:42:10 -0700 (Wed, 07 Jan 2009) | 2 lines

Fix coverity bug ID 6: FORWARD_NULL

------------------------------------------------------------------------
r1719 | fabbione | 2009-01-07 04:40:02 -0700 (Wed, 07 Jan 2009) | 2 lines

Check against the right var and silence a few warnings at build time

------------------------------------------------------------------------
r1718 | asalkeld | 2009-01-05 21:06:51 -0700 (Mon, 05 Jan 2009) | 16 lines

Fix coverity bug ID 9: OVERRUN_STATIC

CID: 9
Checker: OVERRUN_STATIC (help)
File: lib/cfg.c
Function: corosync_cfg_service_unload
Description: Overrun of static array
"&(req_lib_cfg_serviceunload).service_name" of size 1024 bytes by
passing it to a function which indexes it with argument "1023" at byte
position 4088

The main problem here is the way the service_name is defined:
-       char *service_name[256] __attribute__((aligned(8)));
+       char service_name[256] __attribute__((aligned(8)));


------------------------------------------------------------------------
r1717 | asalkeld | 2008-12-28 02:25:17 -0700 (Sun, 28 Dec 2008) | 6 lines

Fix coverity bug ID 4: remove unused code & fix compile error

In evs_dispatch()  the local ignore_dispatch is not used.
So I have removed this code.


------------------------------------------------------------------------
r1716 | asalkeld | 2008-12-28 02:05:05 -0700 (Sun, 28 Dec 2008) | 7 lines

Fix coverity bug ID 1: overused local variable

coverity says that in exec/objdb.c: 1075 the found is always == 1
therefore the code is dead.  But this is just a case of an overused
local variable. "found" is used for two different searches.


------------------------------------------------------------------------
r1715 | asalkeld | 2008-12-28 02:01:35 -0700 (Sun, 28 Dec 2008) | 7 lines

Fix coverity bug ID 7: add NULL pointer check

Here coverity checks that if in a function a pointer is checked
for NULL then it is checked through out the function.

So below I have just add some more checks for NULL.

------------------------------------------------------------------------
r1714 | asalkeld | 2008-12-28 01:55:57 -0700 (Sun, 28 Dec 2008) | 8 lines

Fix coverity bug ID 5

In poll_timer_add() if you pass in a NULL for the callback function
the pointer will be dereferenced.

I have moved the check for the NULL up.


------------------------------------------------------------------------
r1713 | chrissie | 2008-12-19 09:08:25 -0700 (Fri, 19 Dec 2008) | 2 lines

If there is no quorum provider specified, then always return quorate.

------------------------------------------------------------------------
r1712 | chrissie | 2008-12-18 01:28:46 -0700 (Thu, 18 Dec 2008) | 2 lines

If we exit with an error, set the returned status code for the shell.

------------------------------------------------------------------------
r1711 | asalkeld | 2008-12-17 10:44:50 -0700 (Wed, 17 Dec 2008) | 3 lines

Don't segfault if the ais group is not found.


------------------------------------------------------------------------
r1710 | chrissie | 2008-12-17 01:34:26 -0700 (Wed, 17 Dec 2008) | 9 lines

Add config reload support for logsys

If objdb is reloaded, then we re-parse the logging options.

This allows logging options to be changed/enabled/disabled without 
restarting corosync



------------------------------------------------------------------------
r1709 | chrissie | 2008-12-12 04:27:27 -0700 (Fri, 12 Dec 2008) | 4 lines

This patch adds this capability for a limited number of totem keys using
the existing reload mechanism.


------------------------------------------------------------------------
r1708 | chrissie | 2008-12-11 02:42:17 -0700 (Thu, 11 Dec 2008) | 2 lines

Install quorum.h file

------------------------------------------------------------------------
r1707 | chrissie | 2008-12-09 06:51:23 -0700 (Tue, 09 Dec 2008) | 2 lines

Add another missing file

------------------------------------------------------------------------
r1706 | chrissie | 2008-12-09 06:48:47 -0700 (Tue, 09 Dec 2008) | 2 lines

Add some missing files, sorry

------------------------------------------------------------------------
r1705 | sdake | 2008-12-08 09:11:07 -0700 (Mon, 08 Dec 2008) | 2 lines

Patch to fix compilation of macosx and linux in some platform configurations.

------------------------------------------------------------------------
r1704 | chrissie | 2008-12-08 08:55:41 -0700 (Mon, 08 Dec 2008) | 14 lines

quorum is now an optional loadable module (though I've put it into the
defaults in services.c) and can load another module to do the quorum
work (eg YKD which I've made more compliant too). All the quorum code
has been removed from sync.c. quorum.c is simply a shim later for the
coroapi, the main module is in vsf_quorum.c

There are coroapi calls to query quorate status and also to get
notifications when it changes.

I've included the testquorum.lcrso module in this patch because I think
it's really helpful for testing. It sets the quorum state based on an 
objdb variable, this can be set or cleared using corosync-cfgtool


------------------------------------------------------------------------
r1703 | sdake | 2008-12-02 08:51:03 -0700 (Tue, 02 Dec 2008) | 2 lines

Fix deadlock in logsys during startup.

------------------------------------------------------------------------
r1702 | beekhof | 2008-12-02 07:50:51 -0700 (Tue, 02 Dec 2008) | 8 lines

Correctly compare local addresses with bindnetaddr

This patch allows whitetank/corosync to behave correctly when the supplied value of bindnetaddr has more precision than the netmask, but is not a full IPv4 address.

For example, currently, if the netmask is /16 but the user specifies 192.168.1.0, then OpenAIS is unable to determine the correct address and uses the loopback address instead.

The following patch allows OpenAIS to correctly determine which interface/address to use.

------------------------------------------------------------------------
r1701 | asalkeld | 2008-12-01 11:44:55 -0700 (Mon, 01 Dec 2008) | 3 lines

change get node_id() to return an unsigned int


------------------------------------------------------------------------
r1700 | asalkeld | 2008-12-01 10:43:40 -0700 (Mon, 01 Dec 2008) | 6 lines

depending on your ip address, cpg doesn't always send config changes

If you ip addresses are larger than 0xffffff then you will never
get sent group leave notifications.


------------------------------------------------------------------------
r1699 | chrissie | 2008-11-13 02:54:34 -0700 (Thu, 13 Nov 2008) | 2 lines

Don't crash if we get a message for a service that isn't loaded.

------------------------------------------------------------------------
r1698 | chrissie | 2008-11-13 02:54:09 -0700 (Thu, 13 Nov 2008) | 2 lines

Make the port numbers into Network Byte Order.

------------------------------------------------------------------------
r1697 | asalkeld | 2008-11-12 10:39:37 -0700 (Wed, 12 Nov 2008) | 4 lines

LINT: fix confd_sa API error.

remove extra parent_object_handle parameter.

------------------------------------------------------------------------
r1696 | asalkeld | 2008-11-11 11:13:47 -0700 (Tue, 11 Nov 2008) | 3 lines

LINT: fix "Assignment of ssize_t to int" warnings


------------------------------------------------------------------------
r1695 | asalkeld | 2008-11-11 10:28:22 -0700 (Tue, 11 Nov 2008) | 6 lines

LINT: tweek the lint make rules.

Makefile.inc: add -unrecog (don't complain about things like strdup().
tools/Makefile: don't use *.c as it complains about duplicate main() functions
																		  

------------------------------------------------------------------------
r1694 | asalkeld | 2008-11-11 10:26:58 -0700 (Tue, 11 Nov 2008) | 2 lines

LINT: rename the overlay struct so they are uniq.

------------------------------------------------------------------------
r1693 | asalkeld | 2008-11-11 10:25:22 -0700 (Tue, 11 Nov 2008) | 7 lines

LINT: fix or ignore unchecked return values.

If we don't care about the return value then typecase the return
value to void.
Else do something useful with the return value.


------------------------------------------------------------------------
r1692 | sdake | 2008-11-10 01:58:12 -0700 (Mon, 10 Nov 2008) | 2 lines

Fix missing message in delivery of messages under certain circumstances.

------------------------------------------------------------------------
r1691 | sdake | 2008-11-10 01:57:50 -0700 (Mon, 10 Nov 2008) | 2 lines

Fix received_flg to contain proper values.

------------------------------------------------------------------------
r1690 | asalkeld | 2008-11-06 18:34:43 -0700 (Thu, 06 Nov 2008) | 3 lines

Add corotype.h and delete saAis.h


------------------------------------------------------------------------
r1689 | asalkeld | 2008-11-06 14:49:07 -0700 (Thu, 06 Nov 2008) | 5 lines

cleanup the last of the SAF headers and types

This includes the rename of identifiers from corosync to cs.


------------------------------------------------------------------------
r1688 | sdake | 2008-11-05 17:17:19 -0700 (Wed, 05 Nov 2008) | 2 lines

Make width of service 6 bytes instead of 5.

------------------------------------------------------------------------
r1687 | sdake | 2008-11-05 17:17:01 -0700 (Wed, 05 Nov 2008) | 2 lines

Null terminate string which resulted in failure of confdb during logging.

------------------------------------------------------------------------
r1686 | asalkeld | 2008-11-03 18:35:15 -0700 (Mon, 03 Nov 2008) | 3 lines

Make lib/ clean up after itself properly.


------------------------------------------------------------------------
r1685 | asalkeld | 2008-11-01 01:22:51 -0700 (Sat, 01 Nov 2008) | 3 lines

fix build error, can't complie if openais not installed.


------------------------------------------------------------------------
r1684 | asalkeld | 2008-11-01 01:19:18 -0700 (Sat, 01 Nov 2008) | 3 lines

Add a top level "make lint"


------------------------------------------------------------------------
r1683 | chrissie | 2008-10-31 06:20:29 -0700 (Fri, 31 Oct 2008) | 10 lines

This patch adds two extra features to the CFG service in corosync, these
are taken (conceptually at least) from cman.

1. corosync_cfg_killnode()    this will tell a remote node to exit.
2. corosync_cfg_tryshutdown() this will do a semi-controlled shutdown in
that it will consult any interested attached daemons if they are willing
to let corosync be shut down. If they all agree then the rest of the
cluster will be informed before the node dies.


------------------------------------------------------------------------
r1682 | sdake | 2008-10-30 15:41:34 -0700 (Thu, 30 Oct 2008) | 2 lines

performance loading service engine first implementation.

------------------------------------------------------------------------
r1681 | sdake | 2008-10-30 15:25:56 -0700 (Thu, 30 Oct 2008) | 2 lines

Logsys flight recorder.

------------------------------------------------------------------------
r1680 | asalkeld | 2008-10-30 12:32:23 -0700 (Thu, 30 Oct 2008) | 7 lines

Fix a memory violation in objdb (caught by valgrind)

If the new length is larger then memory will be overwritten.

I could make this ">=" but we can save memory if the new size is smaller by using "!=".


------------------------------------------------------------------------
r1679 | chrissie | 2008-10-27 08:56:46 -0700 (Mon, 27 Oct 2008) | 2 lines

Improve the usage message of corosync_objctl.

------------------------------------------------------------------------
r1678 | chrissie | 2008-10-27 01:25:53 -0700 (Mon, 27 Oct 2008) | 8 lines

Currently if a reload operation fails, any subsystems listening for
notifications will get a RELOAD_NOTIFY_START callback but not a
RELOAD_NOTIFY_END callback.

This patch adds a RELOAD_NOTIFY_FAILED callback so that interested
parties will know when the reload has finished and that it failed.


------------------------------------------------------------------------
r1677 | asalkeld | 2008-10-21 14:44:29 -0700 (Tue, 21 Oct 2008) | 3 lines

remove some new warnings from corosync


------------------------------------------------------------------------
r1676 | asalkeld | 2008-10-20 15:05:51 -0700 (Mon, 20 Oct 2008) | 3 lines

Remove unused global debug option from the man page.


------------------------------------------------------------------------
r1675 | sdake | 2008-10-20 14:52:25 -0700 (Mon, 20 Oct 2008) | 2 lines

Remove unneeded totem_timeout_types global define.

------------------------------------------------------------------------
r1674 | chrissie | 2008-10-13 07:27:41 -0700 (Mon, 13 Oct 2008) | 15 lines

This is an initial pass at a top-level quorum system. As it stands, this
module doesn't provide quorum itself, merely a framework for setting and
querying it. I envisage YKD plugging into this rather than straight into
sync() eventually.

I've plugged this into the sync() routines rather than replacing them so
that quorum is itself a VSF, rather than a replacement - I'm not sure if
that is best or not. Opinions are welcome.

I've added an extra enum member to the service_handler so that we can
send IPC messages when the cluster isn't quorate. This will default to
NO (as now) but allows us to query and set quorum when we don't have it
.. a useful feature !


------------------------------------------------------------------------
r1673 | chrissie | 2008-10-06 05:14:40 -0700 (Mon, 06 Oct 2008) | 10 lines

Add locking around objdb calls so that reloads and writes are atomic.

Also add a notification callback for reload. Both the start and the stop
are notified so that the user can decide what to do with the flurry of 
updates that occur.

Note than the reload callback notification MUST be registered against
OBJECT_PARENT_HANDLE. Registering it lower down the hierarchy makes no sense.


------------------------------------------------------------------------
r1672 | chrissie | 2008-10-06 00:46:04 -0700 (Mon, 06 Oct 2008) | 2 lines

Fix some compile warnings.

------------------------------------------------------------------------
r1671 | sdake | 2008-10-05 06:23:22 -0700 (Sun, 05 Oct 2008) | 2 lines

Fix CFLAGS and LDFLAGS overrides to work for DEBUG and RELEASE modes.

------------------------------------------------------------------------
r1669 | sdake | 2008-09-24 22:21:27 -0700 (Wed, 24 Sep 2008) | 2 lines

Fix makefile error in test directory.

------------------------------------------------------------------------
r1668 | sdake | 2008-09-23 10:32:51 -0700 (Tue, 23 Sep 2008) | 2 lines

Add evs verify tool and allow Makefile to build in test directory properly.

------------------------------------------------------------------------
r1667 | asalkeld | 2008-09-17 12:15:00 -0700 (Wed, 17 Sep 2008) | 28 lines

Propagate the flow control state between AIS exec and library

This patch causes the flow control state in the library to be set
properly when the flow control is turned off (disabled).  Then it can be
read properly by the flow control apis.
This also fixes the case where the application is no longer sending
messages and it has already dispatched all its received messages
before flow control is disabled.

Also, CPG response messages with a TRY_AGAIN error did NOT contain
a valid flow control state value. This meant the library could get
stuck with flow control enabled (flow control was never enabled
for the EXEC, so no disable event occurred).
This case was hit when a new node was joining - sync_in_process()
resulted in a TRY_AGAIN for error cpg_mcast_joined).

Also, in message_handler_req_exec_cpg_mcast() the state passed
back to the library defaulted to disabled for messages received
from another node (even if flow control was still enabled)
- this meant if multiple nodes were sending CPG messages,
  then the library flow control state flip-flopped between
  enabled and disabled.

Author: Steven Dake <sdake@redhat.com> &
        Tim Beale <tim.beale@alliedtelesis.co.nz>



------------------------------------------------------------------------
r1666 | asalkeld | 2008-09-17 12:04:19 -0700 (Wed, 17 Sep 2008) | 2 lines

Add support for AMF (sync_request)

------------------------------------------------------------------------
r1665 | asalkeld | 2008-09-17 11:22:58 -0700 (Wed, 17 Sep 2008) | 11 lines

If syslog() blocked, node-leave events were incorrectly reported

In some cases, the syslog() call may block. If this happened, the AIS worker
thread would block waiting on the syslog() call. However, the worker thread
is still holding a logsys mutex, which is needed to enqueue any more log
messages from the other AIS threads. So the main AIS thread blocks waiting
on the logsys mutex. This can then cause aisexec on other nodes to detect
the node as leaving the cluster.

Author: Tim Beale <tim.beale@alliedtelesis.co.nz>

------------------------------------------------------------------------
r1664 | fabient | 2008-09-16 08:35:09 -0700 (Tue, 16 Sep 2008) | 1 line

use getifaddrs to enumerate interface on FreeBSD and Darwin (patch from Mathieu Virbel)
------------------------------------------------------------------------
r1663 | chrissie | 2008-09-03 03:01:31 -0700 (Wed, 03 Sep 2008) | 2 lines

Reinstate key_iter_reset that got removed by mistake in 1660

------------------------------------------------------------------------
r1662 | chrissie | 2008-09-03 00:58:08 -0700 (Wed, 03 Sep 2008) | 14 lines

This patch adds key_increment and key_decrement calls to the objdb and
confdb subsystems.

This is useful to provide atomic counters (ag handle numbers) for
long-running (though not persistent) connections. It's not currently
possible via confdb to atomically get a new number from objdb due to the
lack of locking. Doing it via increment operations in the IPC thread
provides enough atomicity to make it useful. Fabio has already
identified a use for these calls.

It could also provide some form of basic co-operative locking mechanism
for IPC-using processes (not direct objdb calls).


------------------------------------------------------------------------
r1661 | chrissie | 2008-08-27 06:30:52 -0700 (Wed, 27 Aug 2008) | 2 lines

Fix the names of confdb_object_find_destroy and confdb_object_iter_destroy.

------------------------------------------------------------------------
r1660 | chrissie | 2008-08-26 00:34:22 -0700 (Tue, 26 Aug 2008) | 10 lines

Remove the disliked *_from calls from the objdb and recast
the confdb library to use the new find_create/find_next/find_destroy API
calls instead.

I've kept the libcondfb API the same as before with the single change of
adding a confdb_object_find_destroy to tidy up the find handle after
use. If you don't call this then libcondfb will do it for you when
confdb_finalize is called.


------------------------------------------------------------------------
r1659 | asalkeld | 2008-08-19 18:07:29 -0700 (Tue, 19 Aug 2008) | 11 lines

Zero out unused totemsrp my_proc_list entries

When making my_proc_list smaller, ensure that the
now non-used entries are zero-ed out. There are some suspect
assert's that assume that there is always 2 entries in the list.
These fail when my_proc_list is reduced to 1 entry (and the
valid [0] entry is the same as the 'unused' [1] entry).

Author: Mark Wutzke <mark.wutzke@alliedtelesis.co.nz>


------------------------------------------------------------------------
r1658 | asalkeld | 2008-08-19 18:02:43 -0700 (Tue, 19 Aug 2008) | 21 lines

aisexec crash on exit

Cause:
As part of its exit procedure, ais cancels its worker thread then manually
processes any outstanding items that were still in the worker thread's queue.
The worker thread has a low priority so normally it does not execute any
further before ais finishes exiting, but if the main thread's exiting is
delayed for any reason, there is a chance the worker thread could execute and
try to process items which have already been processed and freed by the main
thread - often leading to the worker thread seeing NULL data and ultimately
causing a segmentation fault.

Fix:
Modified worker_thread_group_exit() so it does a pthread_join() after the
pthread_cancel() call, so that the worker thread always shuts down cleanly
before the main thread does its cleanup.

Author: Author: Mark McKinstry <mark.mckinstry@alliedtelesis.co.nz>



------------------------------------------------------------------------
r1657 | asalkeld | 2008-08-19 18:00:44 -0700 (Tue, 19 Aug 2008) | 8 lines

Fix to display strings safely in debug messages.

Display strings safely, even if they are invalid, e.g. data in a received
message was corrupted.

Author: Tim Beale <tim.beale@alliedtelesis.co.nz>


------------------------------------------------------------------------
r1656 | asalkeld | 2008-08-19 17:57:40 -0700 (Tue, 19 Aug 2008) | 19 lines

Provide a way to configure (at compile time) message and queue sizes.

This patch makes it possible to override the following #defines:
MESSAGE_SIZE_MAX
MESSAGE_QUEUE_MAX
SIZEQUEUE
FLOW_CONTROL_ENTRIES_ENABLE

If MESSAGE_SIZE_MAX is defined as 1024*64 (64K) and
MESSAGE_QUEUE_MAX defined as 512 you can change corosync's
memory footprint from ~48M to ~8M

So if you define MESSAGE_QUEUE_MAX, the queue size will
not be based on the message size any more.

To use this define the defines on the command line:
make CFLAGS="-DMESSAGE_SIZE_MAX=1024*64 -DMESSAGE_QUEUE_MAX=512"


------------------------------------------------------------------------
r1655 | asalkeld | 2008-08-19 17:53:38 -0700 (Tue, 19 Aug 2008) | 10 lines

Fix an assert caused by faulty sort-queue management.

sq.h
  - sq_items_release(): When clearing the items_inuse array, ensure that
    all of the memory is cleared. items_inuse is a uint array, not a
    byte array.

Author: Mark Wutzke <markw@alliedtelesis.co.nz>


------------------------------------------------------------------------
r1649 | sdake | 2008-08-15 00:10:01 -0700 (Fri, 15 Aug 2008) | 2 lines

Repair typo which caused init script not to start corosync daemon.

------------------------------------------------------------------------
r1648 | sdake | 2008-08-15 00:09:16 -0700 (Fri, 15 Aug 2008) | 2 lines

Make rpmlint pass without warnings.

------------------------------------------------------------------------
r1647 | sdake | 2008-08-14 23:18:33 -0700 (Thu, 14 Aug 2008) | 2 lines

Set the override for LCRSODIR properly.

------------------------------------------------------------------------
r1646 | sdake | 2008-08-14 23:15:26 -0700 (Thu, 14 Aug 2008) | 2 lines

Finish the renaming of openais to corosync in the tree.

------------------------------------------------------------------------
r1645 | sdake | 2008-08-14 12:07:03 -0700 (Thu, 14 Aug 2008) | 2 lines

Fix build breakage.

------------------------------------------------------------------------
r1644 | sdake | 2008-08-14 11:35:15 -0700 (Thu, 14 Aug 2008) | 2 lines

New and improved loc command.

------------------------------------------------------------------------
r1643 | sdake | 2008-08-14 11:25:22 -0700 (Thu, 14 Aug 2008) | 2 lines

New LOC command.

------------------------------------------------------------------------
r1642 | sdake | 2008-08-14 11:16:40 -0700 (Thu, 14 Aug 2008) | 2 lines

turn on executeable bit for loc.

------------------------------------------------------------------------
r1641 | sdake | 2008-08-14 11:13:49 -0700 (Thu, 14 Aug 2008) | 2 lines

Install saAis.h header file.

------------------------------------------------------------------------
r1640 | sdake | 2008-08-14 10:50:44 -0700 (Thu, 14 Aug 2008) | 2 lines

Update svn commit scripts so they work properly and have proper permissions.

------------------------------------------------------------------------
r1639 | sdake | 2008-08-14 10:30:29 -0700 (Thu, 14 Aug 2008) | 2 lines

Move QUICKSTART to proper directory.

------------------------------------------------------------------------
r1638 | sdake | 2008-08-14 10:12:01 -0700 (Thu, 14 Aug 2008) | 2 lines

Few man page cleanups and removal of amf.conf.5.

------------------------------------------------------------------------
r1637 | sdake | 2008-08-14 09:54:46 -0700 (Thu, 14 Aug 2008) | 2 lines

Proper rename of openais usage to corosync throughout tree.

------------------------------------------------------------------------
r1636 | sdake | 2008-08-14 09:44:26 -0700 (Thu, 14 Aug 2008) | 2 lines

Revert patch 1633 which breaks build.

------------------------------------------------------------------------
r1635 | sdake | 2008-08-14 09:08:15 -0700 (Thu, 14 Aug 2008) | 2 lines

Move openais* to corosync* in man pages.

------------------------------------------------------------------------
r1634 | sdake | 2008-08-14 09:05:32 -0700 (Thu, 14 Aug 2008) | 2 lines

Build corosync-keygen.

------------------------------------------------------------------------
r1633 | sdake | 2008-08-14 09:04:01 -0700 (Thu, 14 Aug 2008) | 2 lines

Change all occurances of openais to corosync.

------------------------------------------------------------------------
r1632 | fabient | 2008-08-14 07:59:50 -0700 (Thu, 14 Aug 2008) | 1 line

reorganize include file to match installed tree to build openais without installing corosync; correct some warnings and error under FreeBSD and Darwin
------------------------------------------------------------------------
r1631 | fabbione | 2008-08-14 05:05:39 -0700 (Thu, 14 Aug 2008) | 3 lines

Revert config_verifyconf logic that is unnecessary


------------------------------------------------------------------------
r1630 | chrissie | 2008-08-13 03:33:11 -0700 (Wed, 13 Aug 2008) | 2 lines

Change AIS names to corosync

------------------------------------------------------------------------
r1629 | fabbione | 2008-08-12 20:58:03 -0700 (Tue, 12 Aug 2008) | 13 lines

Add support for reload operations within objdb and plugins.

Use a 2 phase "commit" operation:
1) Invoke verifyconfig that should catch the errors before the reload operation
2) Invoke reloadconfig that performs the operation and should _never_ fail

Implementation note: if step 2 fails, there is no fall back at the moment.

Fix the IPC table for confdb:
MESSAGE_REQ_CONFDB_XPATH_EVAL_EXPRESSION = 12 was added to include/ipc_confdb.h
without an associated call. Thanks Chrissie for spotting this.


------------------------------------------------------------------------
r1628 | sdake | 2008-08-12 02:06:46 -0700 (Tue, 12 Aug 2008) | 2 lines

Add some totem process group interfaces to the API.

------------------------------------------------------------------------
r1627 | fabbione | 2008-08-12 01:41:09 -0700 (Tue, 12 Aug 2008) | 7 lines

objdb: change list_add to list_add_tail when adding keys and objects

service: change openais_service_unlink_all to deal with the new objdb order

cleanup a few whitespaces


------------------------------------------------------------------------
r1626 | sdake | 2008-08-06 08:00:47 -0700 (Wed, 06 Aug 2008) | 2 lines

Add module load and unload to the exported coroapi.

------------------------------------------------------------------------
r1625 | sdake | 2008-08-05 09:34:14 -0700 (Tue, 05 Aug 2008) | 2 lines

Add callback notification about changes to the object db and confdb apis.

------------------------------------------------------------------------
r1624 | fabbione | 2008-08-05 07:53:46 -0700 (Tue, 05 Aug 2008) | 6 lines

Fix crash in logsys new API

logsys_config_priority_set lacked a check for logsys_single_id that
left logsys_subsys_id uninitialized.


------------------------------------------------------------------------
r1623 | fabbione | 2008-08-05 07:51:31 -0700 (Tue, 05 Aug 2008) | 7 lines

Fix toplevel Makefile install target

- objctl is now called corosync-objctl
- keygen has been renamed corosync-keygen
- install corosync-cfgtool as part of the standard tools now


------------------------------------------------------------------------
r1622 | sdake | 2008-08-05 06:23:46 -0700 (Tue, 05 Aug 2008) | 2 lines

Split openais and corosync tree into two seperate repositories.

------------------------------------------------------------------------
r1621 | sdake | 2008-08-04 22:24:41 -0700 (Mon, 04 Aug 2008) | 2 lines

Make mar_name_t an inline function to remove warnings

------------------------------------------------------------------------
r1620 | sdake | 2008-08-03 22:21:52 -0700 (Sun, 03 Aug 2008) | 2 lines

Allow msg service test applications to build properly.

------------------------------------------------------------------------
r1619 | sdake | 2008-08-03 22:21:28 -0700 (Sun, 03 Aug 2008) | 2 lines

Fix errors in lib linking.

------------------------------------------------------------------------
r1618 | sdake | 2008-08-03 22:16:52 -0700 (Sun, 03 Aug 2008) | 2 lines

Add a missing confdb_key_delete function to the confdb api.

------------------------------------------------------------------------
r1617 | sdake | 2008-08-03 22:15:25 -0700 (Sun, 03 Aug 2008) | 2 lines

Merge Angus's corosync-objctl tool and move cfgtool to a different directory.

------------------------------------------------------------------------
r1616 | pcaulfie | 2008-08-01 00:03:49 -0700 (Fri, 01 Aug 2008) | 2 lines

Fix the spelling of 'guarantee' in several places.

------------------------------------------------------------------------
r1613 | sdake | 2008-07-24 06:20:09 -0700 (Thu, 24 Jul 2008) | 2 lines

Final fixup to build all things properly.

------------------------------------------------------------------------
r1612 | sdake | 2008-07-24 06:14:09 -0700 (Thu, 24 Jul 2008) | 2 lines

openais now builds when make install is done from corosync.

------------------------------------------------------------------------
r1611 | sdake | 2008-07-24 05:58:44 -0700 (Thu, 24 Jul 2008) | 2 lines

Merge the object iteration repair patch into corosync so openais services load.

------------------------------------------------------------------------
r1610 | sdake | 2008-07-24 05:33:09 -0700 (Thu, 24 Jul 2008) | 2 lines

Add files missing from build but in dev repo.

------------------------------------------------------------------------
r1609 | sdake | 2008-07-24 05:28:11 -0700 (Thu, 24 Jul 2008) | 3 lines

Building of all service engines now works properly.
Install works as well.

------------------------------------------------------------------------
r1608 | sdake | 2008-07-24 05:26:27 -0700 (Thu, 24 Jul 2008) | 2 lines

Improve runtime loading of parser and move versions files to corosync.

------------------------------------------------------------------------
r1607 | sdake | 2008-07-24 02:14:46 -0700 (Thu, 24 Jul 2008) | 2 lines

Add MESSAGE_SIZE_MAX to coroapi file.

------------------------------------------------------------------------
r1606 | sdake | 2008-07-24 02:12:07 -0700 (Thu, 24 Jul 2008) | 3 lines

Make external service engines (openais) work properly.
Also fix up make install.

------------------------------------------------------------------------
r1605 | sdake | 2008-07-23 21:29:42 -0700 (Wed, 23 Jul 2008) | 2 lines

Patch from Angus to make corosync build for his environment.

------------------------------------------------------------------------
r1604 | sdake | 2008-07-23 19:55:51 -0700 (Wed, 23 Jul 2008) | 2 lines

Add API definitions file.

------------------------------------------------------------------------
r1603 | sdake | 2008-07-23 18:30:29 -0700 (Wed, 23 Jul 2008) | 2 lines

Merge the API definitions of the objdb into the corosync api definition.

------------------------------------------------------------------------
r1602 | sdake | 2008-07-23 14:32:13 -0700 (Wed, 23 Jul 2008) | 5 lines

The entire tree builds properly and all services have been ported to the
new coroapi.h include header.

The services shipped with corosync are CPG, CFG, CONFDB, and EVS.

------------------------------------------------------------------------
r1601 | sdake | 2008-07-22 00:27:39 -0700 (Tue, 22 Jul 2008) | 2 lines

Make from top level directory now works.

------------------------------------------------------------------------
r1600 | sdake | 2008-07-22 00:25:27 -0700 (Tue, 22 Jul 2008) | 2 lines

API changes and code to make cfg and cpg service operate properly with corosync.

------------------------------------------------------------------------
r1599 | sdake | 2008-07-21 05:40:33 -0700 (Mon, 21 Jul 2008) | 2 lines

Cause libraries to build.

------------------------------------------------------------------------
r1598 | sdake | 2008-07-21 03:03:58 -0700 (Mon, 21 Jul 2008) | 2 lines

Set default services to load.

------------------------------------------------------------------------
r1597 | sdake | 2008-07-21 02:59:56 -0700 (Mon, 21 Jul 2008) | 2 lines

Add the default corosync parser.

------------------------------------------------------------------------
r1596 | sdake | 2008-07-21 02:30:37 -0700 (Mon, 21 Jul 2008) | 2 lines

Rename AIS parts to Corosync.

------------------------------------------------------------------------
r1595 | sdake | 2008-07-21 02:18:00 -0700 (Mon, 21 Jul 2008) | 2 lines

Rename aispoll to coropoll.

------------------------------------------------------------------------
r1594 | sdake | 2008-07-21 02:05:14 -0700 (Mon, 21 Jul 2008) | 2 lines

corosync/exec builds.

------------------------------------------------------------------------
r1593 | sdake | 2008-07-21 01:49:25 -0700 (Mon, 21 Jul 2008) | 2 lines

Remove depends in Makefile.

------------------------------------------------------------------------
r1592 | sdake | 2008-07-21 01:38:54 -0700 (Mon, 21 Jul 2008) | 2 lines

Initial makefile for corosync plugin service engines.

------------------------------------------------------------------------
r1591 | sdake | 2008-07-21 01:33:39 -0700 (Mon, 21 Jul 2008) | 2 lines

Move services around to service directory.

------------------------------------------------------------------------
r1590 | sdake | 2008-07-21 01:30:35 -0700 (Mon, 21 Jul 2008) | 2 lines

move README.amf into openais directory.

------------------------------------------------------------------------
r1589 | sdake | 2008-07-21 01:30:10 -0700 (Mon, 21 Jul 2008) | 2 lines

Remove unnecesssary files.

------------------------------------------------------------------------
r1588 | sdake | 2008-07-21 01:29:39 -0700 (Mon, 21 Jul 2008) | 2 lines

Add makefile and loc infrastructure to openais directory.

------------------------------------------------------------------------
r1587 | sdake | 2008-07-21 01:23:10 -0700 (Mon, 21 Jul 2008) | 2 lines

Add license file to openais tree.

------------------------------------------------------------------------
r1586 | sdake | 2008-07-21 01:21:36 -0700 (Mon, 21 Jul 2008) | 2 lines

Move mismove to proper location.

------------------------------------------------------------------------
r1585 | sdake | 2008-07-21 01:21:13 -0700 (Mon, 21 Jul 2008) | 3 lines

Move test, lib, exec, and include files that are openais specific into openais
directory.

------------------------------------------------------------------------
r1584 | sdake | 2008-07-21 01:05:59 -0700 (Mon, 21 Jul 2008) | 2 lines

Put conf directory in openais directory.

------------------------------------------------------------------------
r1583 | sdake | 2008-07-21 01:01:13 -0700 (Mon, 21 Jul 2008) | 2 lines

Move test directories and remaining loc files to test directory.

------------------------------------------------------------------------
r1582 | sdake | 2008-07-21 00:59:08 -0700 (Mon, 21 Jul 2008) | 2 lines

Initial move of corosync and openais trees into seperate directories.

------------------------------------------------------------------------
r1581 | sdake | 2008-07-21 00:34:50 -0700 (Mon, 21 Jul 2008) | 2 lines

Test queue group tracking feature.

------------------------------------------------------------------------
r1580 | sdake | 2008-07-21 00:34:08 -0700 (Mon, 21 Jul 2008) | 2 lines

Add ability to track changes to queue groups in the messaqge service.

------------------------------------------------------------------------
r1579 | sdake | 2008-07-14 04:07:39 -0700 (Mon, 14 Jul 2008) | 2 lines

Allow setting of the logsys priority to one lower then was already specified.

------------------------------------------------------------------------
r1578 | sdake | 2008-07-14 04:05:13 -0700 (Mon, 14 Jul 2008) | 2 lines

Revert incorrect patch.

------------------------------------------------------------------------
r1577 | sdake | 2008-07-14 03:58:28 -0700 (Mon, 14 Jul 2008) | 2 lines

Allow setting of lower priority which is currently disabled.

------------------------------------------------------------------------
r1576 | sdake | 2008-07-14 03:55:28 -0700 (Mon, 14 Jul 2008) | 3 lines

Allow users of logsys to disable output of logging LOG_LEVEL_DEBUG messages
via log_mode_set.

------------------------------------------------------------------------
r1575 | pcaulfie | 2008-07-11 03:35:54 -0700 (Fri, 11 Jul 2008) | 9 lines

 * Adds documentation for the LOG_MODE_NOSUBSYS mode flag,
 * Adds documentation for the LOG_MODE_SHORT_FILELINE mode flag, and
 * Fixes (typo) 'declartion' -> 'declaration'

-- Lon




------------------------------------------------------------------------
r1574 | sdake | 2008-07-10 16:52:38 -0700 (Thu, 10 Jul 2008) | 2 lines

Fix error in a previous logsys patch.

------------------------------------------------------------------------
r1573 | pcaulfie | 2008-07-07 01:49:21 -0700 (Mon, 07 Jul 2008) | 2 lines

Add a missing object_find_reset() call.

------------------------------------------------------------------------
r1572 | sdake | 2008-07-02 15:58:03 -0700 (Wed, 02 Jul 2008) | 2 lines

Add init/config entry points for those that dont with to use macros in logsys.

------------------------------------------------------------------------
r1571 | pcaulfie | 2008-07-02 00:19:50 -0700 (Wed, 02 Jul 2008) | 5 lines

Add cpg_groups_get call to libcpg.

This call causes a complete list of active groups and their
membership lists to be sent to a callback function.

------------------------------------------------------------------------
r1570 | sdake | 2008-07-01 15:08:15 -0700 (Tue, 01 Jul 2008) | 5 lines

Add two new modes LOG_MODE_SHORT_FILELINE and LOG_MODE_NOSUBSYS.
LOG_MODE_SHORT_FILELINE strips the leading path from the file name in
a debug output.  LOG_MODE_NOSUBSYS removes a global variable and provides
the ability to set or unset this via config_mode_set.

------------------------------------------------------------------------
r1569 | pcaulfie | 2008-07-01 00:23:25 -0700 (Tue, 01 Jul 2008) | 8 lines

this patch fixes a segfault/crash in confdb_write.

If the operation is succesful there is no need to set error_string. If error_string is not set, don't try to access it or we crash.

At the same time perform the same check in libconfdb when we receive the reply.

Fabio 

------------------------------------------------------------------------
r1568 | sdake | 2008-06-24 01:43:53 -0700 (Tue, 24 Jun 2008) | 2 lines

Allow syslog priority configurations per subsystem in logsys.

------------------------------------------------------------------------
r1566 | sdake | 2008-06-23 21:54:28 -0700 (Mon, 23 Jun 2008) | 2 lines

Remove warnings of unused variables in main.c

------------------------------------------------------------------------
r1565 | sdake | 2008-06-23 21:52:42 -0700 (Mon, 23 Jun 2008) | 2 lines

Allow make in the exec directory to work even if root/lcr isn't yet built.

------------------------------------------------------------------------
r1564 | sdake | 2008-06-23 21:49:29 -0700 (Mon, 23 Jun 2008) | 2 lines

Add #include assert.h to some AMF files.

------------------------------------------------------------------------
r1563 | sdake | 2008-06-23 21:46:03 -0700 (Mon, 23 Jun 2008) | 2 lines

Forward port of the synchronization engine into trunk.

------------------------------------------------------------------------
r1562 | sdake | 2008-06-23 21:45:38 -0700 (Mon, 23 Jun 2008) | 3 lines

Fix a ton of bugs in totem by forward porting the whitetank totem code into
trunk.

------------------------------------------------------------------------
r1561 | sdake | 2008-06-23 21:44:45 -0700 (Mon, 23 Jun 2008) | 2 lines

Remove totemip.h reference from file.

------------------------------------------------------------------------
r1560 | sdake | 2008-06-23 21:44:36 -0700 (Mon, 23 Jun 2008) | 2 lines

Remove totemip reference from file.

------------------------------------------------------------------------
r1559 | sdake | 2008-06-23 21:44:21 -0700 (Mon, 23 Jun 2008) | 2 lines

remove totemip.h reference from file.

------------------------------------------------------------------------
r1558 | sdake | 2008-06-23 15:44:06 -0700 (Mon, 23 Jun 2008) | 3 lines

Fix unlock_algorithm in lock service.


------------------------------------------------------------------------
r1557 | sdake | 2008-06-23 15:42:42 -0700 (Mon, 23 Jun 2008) | 2 lines

Improve the async version of locking library patch from Xinwei Hu.

------------------------------------------------------------------------
r1556 | sdake | 2008-06-23 15:40:44 -0700 (Mon, 23 Jun 2008) | 2 lines

Patch from Xinwei Hu to clean up test locking program.

------------------------------------------------------------------------
r1555 | sdake | 2008-06-19 23:06:56 -0700 (Thu, 19 Jun 2008) | 2 lines

Allow user to retrieve logsys mode.

------------------------------------------------------------------------
r1554 | sdake | 2008-06-19 23:04:03 -0700 (Thu, 19 Jun 2008) | 2 lines

Remove extra unneeded configuration option from logsys.

------------------------------------------------------------------------
r1553 | sdake | 2008-06-19 22:54:11 -0700 (Thu, 19 Jun 2008) | 3 lines

Use logsys_facility_id_get to do the string conversion instead of doing
it in the openais configuration parser.

------------------------------------------------------------------------
r1552 | sdake | 2008-06-13 11:36:21 -0700 (Fri, 13 Jun 2008) | 2 lines

Message service implemntation - more apis now supported. 

------------------------------------------------------------------------
r1550 | sdake | 2008-05-20 09:26:16 -0700 (Tue, 20 May 2008) | 2 lines

Fix linking of other projects against logsys on ppc64.

------------------------------------------------------------------------
r1549 | sdake | 2008-05-20 09:18:28 -0700 (Tue, 20 May 2008) | 3 lines

Remove exit when logsys files can't be created.


------------------------------------------------------------------------
r1547 | sdake | 2008-05-14 08:48:54 -0700 (Wed, 14 May 2008) | 2 lines

Fix loading of multiple objects.

------------------------------------------------------------------------
r1545 | sdake | 2008-05-12 08:57:42 -0700 (Mon, 12 May 2008) | 2 lines

Repair invalid commit.

------------------------------------------------------------------------
r1544 | sdake | 2008-05-12 08:52:11 -0700 (Mon, 12 May 2008) | 2 lines

Add ckpt service back in from incorrect patch that was committed found during tesitng of rpm of 0.83-1.fc10.

------------------------------------------------------------------------
r1541 | sdake | 2008-05-12 06:48:06 -0700 (Mon, 12 May 2008) | 2 lines

Change all email addresses that were sdake@mvista.com to sdake@redhat.com.

------------------------------------------------------------------------
r1540 | sdake | 2008-05-12 06:45:38 -0700 (Mon, 12 May 2008) | 2 lines

Repair loading of external services.

------------------------------------------------------------------------
r1539 | sdake | 2008-05-12 06:35:13 -0700 (Mon, 12 May 2008) | 2 lines

Remove executable permission from flow.c

------------------------------------------------------------------------
r1538 | sdake | 2008-05-09 09:48:16 -0700 (Fri, 09 May 2008) | 2 lines

Patch to remove segfault on the exiting of a service.

------------------------------------------------------------------------
r1537 | sdake | 2008-05-09 09:47:21 -0700 (Fri, 09 May 2008) | 2 lines

Patch to allow controlled exit of a service.

------------------------------------------------------------------------
r1536 | pcaulfie | 2008-05-07 00:27:37 -0700 (Wed, 07 May 2008) | 2 lines

Expose confdb write to the library.

------------------------------------------------------------------------
r1535 | pcaulfie | 2008-05-06 02:49:45 -0700 (Tue, 06 May 2008) | 2 lines

Add LDFLAGS to libconfdb linking

------------------------------------------------------------------------
r1534 | sdake | 2008-05-05 13:10:44 -0700 (Mon, 05 May 2008) | 2 lines

Execute a test of the makefile system from Angus

------------------------------------------------------------------------
r1533 | sdake | 2008-05-05 07:14:25 -0700 (Mon, 05 May 2008) | 2 lines

Apply suggestion from Andrew for srcdir functionality.

------------------------------------------------------------------------
r1532 | sdake | 2008-05-02 07:17:03 -0700 (Fri, 02 May 2008) | 2 lines

Allow make from the exec directory.

------------------------------------------------------------------------
r1531 | pcaulfie | 2008-04-30 08:32:25 -0700 (Wed, 30 Apr 2008) | 2 lines

Allow libconfdb to run standalone (without aisexec)

------------------------------------------------------------------------
r1530 | pcaulfie | 2008-04-30 08:32:04 -0700 (Wed, 30 Apr 2008) | 2 lines

Add writeback call to objdb

------------------------------------------------------------------------
r1529 | sdake | 2008-04-29 03:08:11 -0700 (Tue, 29 Apr 2008) | 2 lines

Fix build error.

------------------------------------------------------------------------
r1528 | sdake | 2008-04-28 09:25:47 -0700 (Mon, 28 Apr 2008) | 2 lines

load and unload service engines at runtime.

------------------------------------------------------------------------
r1527 | sdake | 2008-04-28 09:00:38 -0700 (Mon, 28 Apr 2008) | 2 lines

Patch to add new api to logsys to get priority names from subsystem names.

------------------------------------------------------------------------
r1526 | sdake | 2008-04-28 08:59:35 -0700 (Mon, 28 Apr 2008) | 2 lines

Change initialization order for logsys logging to files to work properly.

------------------------------------------------------------------------
r1525 | sdake | 2008-04-23 05:48:44 -0700 (Wed, 23 Apr 2008) | 2 lines

Fix building on OSX

------------------------------------------------------------------------
r1523 | sdake | 2008-04-23 05:35:44 -0700 (Wed, 23 Apr 2008) | 2 lines

Fix syscall usage for keygen application

------------------------------------------------------------------------
r1522 | pcaulfie | 2008-04-23 03:39:21 -0700 (Wed, 23 Apr 2008) | 3 lines

Fix logsys_config_priority_set() so that it sets the priority
of the local subsystem and not always "MAIN".

------------------------------------------------------------------------
r1520 | sdake | 2008-04-22 07:36:52 -0700 (Tue, 22 Apr 2008) | 2 lines

Build on latest glibc.

------------------------------------------------------------------------
r1519 | sdake | 2008-04-21 08:15:48 -0700 (Mon, 21 Apr 2008) | 3 lines

Patch to reinitialize logsys internal variables after a fork for correct
operation.

------------------------------------------------------------------------
r1518 | pcaulfie | 2008-04-17 06:14:28 -0700 (Thu, 17 Apr 2008) | 2 lines

Add man pages for confdb functions.

------------------------------------------------------------------------
r1517 | pcaulfie | 2008-04-17 02:54:09 -0700 (Thu, 17 Apr 2008) | 2 lines

Fix some typos in the CPG man pages

------------------------------------------------------------------------
r1516 | pcaulfie | 2008-04-16 05:07:05 -0700 (Wed, 16 Apr 2008) | 2 lines

Add confdb, a library to access the configuration object database.

------------------------------------------------------------------------
r1515 | pcaulfie | 2008-04-16 03:13:06 -0700 (Wed, 16 Apr 2008) | 4 lines

Fix locking in logsys.

Patch from Fabio M. Di Nitto <fabbione@fabbione.net>

------------------------------------------------------------------------
r1505 | pcaulfie | 2008-03-10 08:18:12 -0700 (Mon, 10 Mar 2008) | 7 lines

Add some new calls into objdb.

These allow replacing/removing keys, and deleting a whole object subtree,
iterator functions to enumerate all objects/keys on an object,
and a dump call for debugging.


------------------------------------------------------------------------
r1495 | sdake | 2008-01-07 22:22:12 -0700 (Mon, 07 Jan 2008) | 2 lines

Patch to install liblogsys

------------------------------------------------------------------------
r1494 | sdake | 2008-01-07 22:12:05 -0700 (Mon, 07 Jan 2008) | 2 lines

Remove closing of ttys that slipped in improperly.

------------------------------------------------------------------------
r1492 | sdake | 2007-12-10 14:20:01 -0700 (Mon, 10 Dec 2007) | 3 lines

srcdir is not set when realpath & abspath don't work


------------------------------------------------------------------------
r1491 | sdake | 2007-12-10 14:09:48 -0700 (Mon, 10 Dec 2007) | 2 lines

Force logging to stderr if the -f flag is specified.

------------------------------------------------------------------------
r1490 | sdake | 2007-12-10 14:06:12 -0700 (Mon, 10 Dec 2007) | 3 lines

Allow multiple config plugins to be loaded at start time and set the config
object database objects.

------------------------------------------------------------------------
r1489 | sdake | 2007-11-28 11:54:54 -0700 (Wed, 28 Nov 2007) | 2 lines

fix install broken when O=<DIR> is used

------------------------------------------------------------------------
r1488 | sdake | 2007-11-28 11:52:35 -0700 (Wed, 28 Nov 2007) | 2 lines

Patch to make sure make clean works as advertised.

------------------------------------------------------------------------
r1487 | sdake | 2007-11-28 11:31:03 -0700 (Wed, 28 Nov 2007) | 2 lines

Properly daemonize and dup file descriptors to /dev/null.

------------------------------------------------------------------------
r1485 | sdake | 2007-11-28 11:05:51 -0700 (Wed, 28 Nov 2007) | 2 lines

Make sure to unlock the handle database on a failure condition.

------------------------------------------------------------------------
r1484 | sdake | 2007-11-28 11:04:55 -0700 (Wed, 28 Nov 2007) | 2 lines

Patch to set system from field properly in retransmitted messages.

------------------------------------------------------------------------
r1483 | sdake | 2007-11-28 11:03:54 -0700 (Wed, 28 Nov 2007) | 2 lines

Remove & when regular reference works properly.

------------------------------------------------------------------------
r1482 | sdake | 2007-11-28 11:03:12 -0700 (Wed, 28 Nov 2007) | 2 lines

Patch to not increment the ring seq id on the first operational ring.

------------------------------------------------------------------------
r1481 | sdake | 2007-11-28 10:59:52 -0700 (Wed, 28 Nov 2007) | 2 lines

make install now works properly on systems which produce wierd uname results

------------------------------------------------------------------------
r1476 | fthomas | 2007-10-25 02:46:00 -0700 (Thu, 25 Oct 2007) | 1 line

add missing objdb for static build
------------------------------------------------------------------------
r1475 | sdake | 2007-10-22 09:18:59 -0700 (Mon, 22 Oct 2007) | 4 lines

Patch to provide generic init script that is generically useful for most
distributions or can be used as a starting point for making a distribution
custom init script.

------------------------------------------------------------------------
r1474 | sdake | 2007-10-22 09:16:29 -0700 (Mon, 22 Oct 2007) | 2 lines

Patch to close all open files on background run operation.

------------------------------------------------------------------------
r1472 | sdake | 2007-10-22 08:53:45 -0700 (Mon, 22 Oct 2007) | 2 lines

Fix missing commit from timer.c in trunk.

------------------------------------------------------------------------
r1470 | sdake | 2007-10-22 08:42:36 -0700 (Mon, 22 Oct 2007) | 2 lines

Endian convert downlist messages from cpg.

------------------------------------------------------------------------
r1468 | fthomas | 2007-10-16 06:20:24 -0700 (Tue, 16 Oct 2007) | 1 line

correct ifdef that must be ifndef because under FreeBSD alloca.h is in stdlib.h
------------------------------------------------------------------------
r1467 | pcaulfie | 2007-10-10 03:33:55 -0700 (Wed, 10 Oct 2007) | 3 lines

Remove some includes from .h files so they can be installed.
Also install flow.h & ipc.h for external services.

------------------------------------------------------------------------
r1466 | pcaulfie | 2007-10-10 03:28:14 -0700 (Wed, 10 Oct 2007) | 2 lines

Fix openais.conf example and man page to match the new logsys directives.

------------------------------------------------------------------------
r1463 | sdake | 2007-10-02 09:29:33 -0700 (Tue, 02 Oct 2007) | 4 lines

Fix problem where adding a timer in a timer callback would lock system
and also timer additions were not protected by mutex because of backwards
pthread_equal comparison.

------------------------------------------------------------------------
r1462 | sdake | 2007-09-27 18:31:34 -0700 (Thu, 27 Sep 2007) | 4 lines

segfault does not use source.conn unless the originating
request is local. The actual code tries to dereference pointers
created on another node.

------------------------------------------------------------------------
r1461 | sdake | 2007-09-27 18:30:50 -0700 (Thu, 27 Sep 2007) | 5 lines

lock_algo queues lock requests rather than ignoring them if
an exclusive lock is held on a resource. This led to stale
processes trying to acquire an exclusive lock forever.


------------------------------------------------------------------------
r1460 | sdake | 2007-09-27 18:08:39 -0700 (Thu, 27 Sep 2007) | 2 lines

Patch to fix dependencies in build of test programs.

------------------------------------------------------------------------
r1459 | sdake | 2007-09-27 15:16:58 -0700 (Thu, 27 Sep 2007) | 2 lines

Fix linking of library objects.

------------------------------------------------------------------------
r1458 | sdake | 2007-09-27 02:14:02 -0700 (Thu, 27 Sep 2007) | 2 lines

Allow override of the LCRSO directory from the Makefiles or command line

------------------------------------------------------------------------
r1457 | sdake | 2007-09-27 02:12:46 -0700 (Thu, 27 Sep 2007) | 2 lines

Fix static libs installation logic inversion

------------------------------------------------------------------------
r1456 | sdake | 2007-09-27 01:50:17 -0700 (Thu, 27 Sep 2007) | 2 lines

Makefile system improvements from Angus Salkeld

------------------------------------------------------------------------
r1454 | pcaulfie | 2007-09-20 08:26:52 -0700 (Thu, 20 Sep 2007) | 2 lines

Install logsys.h rather than print.h

------------------------------------------------------------------------
r1451 | sdake | 2007-09-15 13:48:31 -0700 (Sat, 15 Sep 2007) | 3 lines

Fix reference counting in LCR code.  Also fix problem with inability to compile
from the exec directory because PREFIX wasn't defined for lcr_ifact.c.

------------------------------------------------------------------------
r1448 | sdake | 2007-09-15 13:32:36 -0700 (Sat, 15 Sep 2007) | 2 lines

Allow missing spots in the synchronization engine

------------------------------------------------------------------------
r1447 | sdake | 2007-09-15 13:14:55 -0700 (Sat, 15 Sep 2007) | 24 lines

Fixes the following problems:
1) the encapsulated and not encapsulated values for multicast messages
are now enumerated instead of magic number.
2) the endian detector is now set for new encapsulated messages intended
for transmission.  previously these messages would use whichever endian
detector value happened to be in memory which could be a) correct endian
b) incorrect endian from another machine byte order message c) junk
values.
3) The retransmission flag is not set by default on new originated
tokens in the recovery state.  Instead it is set based upon whether the
node actually can retransmit any messages.
4) some workaround code was removed that was necessary to make the
system work when #3 was incorrect
5) the my_install_seq and my_aru fields are compared based upon a window
instead of static comparison because it could be that the my_aru is
0xFFFFFF5 where my_install_seq is 5.  In this case (after a lot of
messages are sent) the comparison would return the incorrect result in
the recovery phase of the algorithm.
6) The queue chosen for adding messages to the retransmission queue is
now set based upon the encapsulated bit rather then the current state of
the state machine.
7) the encapsulated bit is set properly in an endian conversion
operation for a multicast message header.

------------------------------------------------------------------------
r1445 | sdake | 2007-09-11 12:27:13 -0700 (Tue, 11 Sep 2007) | 2 lines

Add missing files from the ais utils exporting patch.

------------------------------------------------------------------------
r1444 | sdake | 2007-09-09 00:00:53 -0700 (Sun, 09 Sep 2007) | 2 lines

Calculate the default path based on the project value of PREFIX

------------------------------------------------------------------------
r1443 | sdake | 2007-09-09 00:00:13 -0700 (Sun, 09 Sep 2007) | 2 lines

Ensure DESTDIR and PREFIX are properly used in Makefiles

------------------------------------------------------------------------
r1442 | sdake | 2007-09-08 23:58:41 -0700 (Sat, 08 Sep 2007) | 2 lines

Expose utils to the user

------------------------------------------------------------------------
r1441 | sdake | 2007-09-08 23:57:41 -0700 (Sat, 08 Sep 2007) | 2 lines

Now that -l is set correclt yuse #include <header.h> instead of using quotes.

------------------------------------------------------------------------
r1440 | sdake | 2007-09-08 23:51:39 -0700 (Sat, 08 Sep 2007) | 2 lines

Static libraries become out of date on Darwin once they are copied or moved

------------------------------------------------------------------------
r1439 | sdake | 2007-09-08 23:50:52 -0700 (Sat, 08 Sep 2007) | 2 lines

Use makefile loops where possible

------------------------------------------------------------------------
r1438 | sdake | 2007-09-08 23:50:18 -0700 (Sat, 08 Sep 2007) | 2 lines

Provide information as to why a plugin refused to load

------------------------------------------------------------------------
r1437 | sdake | 2007-09-08 23:49:43 -0700 (Sat, 08 Sep 2007) | 2 lines

Add extra brackets to clarify scope.

------------------------------------------------------------------------
r1436 | sdake | 2007-09-08 23:47:57 -0700 (Sat, 08 Sep 2007) | 2 lines

Fix build dependencies

------------------------------------------------------------------------
r1435 | sdake | 2007-09-08 23:47:16 -0700 (Sat, 08 Sep 2007) | 3 lines

If iface_ver0_p is not reset, then as long as the first plugin loads 
then all subsequent plugins will report success.

------------------------------------------------------------------------
r1434 | sdake | 2007-09-08 23:46:41 -0700 (Sat, 08 Sep 2007) | 2 lines

Missing stdlib.h from lcr_ifact.c.

------------------------------------------------------------------------
r1433 | sdake | 2007-09-08 23:46:03 -0700 (Sat, 08 Sep 2007) | 2 lines

HZ not always defined on all Linux systems.

------------------------------------------------------------------------
r1432 | sdake | 2007-09-08 23:45:35 -0700 (Sat, 08 Sep 2007) | 2 lines

Patch to allow CFLAGS and LDFLAGS modifications to take effect

------------------------------------------------------------------------
r1431 | sdake | 2007-09-08 23:43:20 -0700 (Sat, 08 Sep 2007) | 2 lines

Logsys testing system.

------------------------------------------------------------------------
r1430 | sdake | 2007-09-08 23:41:19 -0700 (Sat, 08 Sep 2007) | 2 lines

Fixes for the logsys system.

------------------------------------------------------------------------
r1429 | sdake | 2007-09-08 23:38:27 -0700 (Sat, 08 Sep 2007) | 2 lines

The man page for the logsys logging system.

------------------------------------------------------------------------
r1428 | sdake | 2007-09-08 23:38:10 -0700 (Sat, 08 Sep 2007) | 2 lines

The logsys logging system.  Read logsys_overview.8.

------------------------------------------------------------------------
r1427 | sdake | 2007-09-08 23:24:00 -0700 (Sat, 08 Sep 2007) | 2 lines

totem srp merge from whitetank

------------------------------------------------------------------------
r1425 | sdake | 2007-09-08 23:15:31 -0700 (Sat, 08 Sep 2007) | 3 lines

Patch to log security warnings when invalid identifier is used in message
header for a totem message.

------------------------------------------------------------------------
r1424 | sdake | 2007-09-08 23:12:56 -0700 (Sat, 08 Sep 2007) | 3 lines

Fix problem in synchronization engine which results in possible failures of
the synchronization engine.

------------------------------------------------------------------------
r1421 | sdake | 2007-08-24 12:45:23 -0700 (Fri, 24 Aug 2007) | 3 lines

Patch to allocate event dispatch data in saEvtInitialize instead of directly
on the stack for small thread-stack sized dispatch functions.

------------------------------------------------------------------------
r1420 | sdake | 2007-08-10 21:40:42 -0700 (Fri, 10 Aug 2007) | 3 lines

Patch to not overwrite defualt configuration file or amf.conf file when
executing make install

------------------------------------------------------------------------
r1418 | sdake | 2007-08-10 21:36:52 -0700 (Fri, 10 Aug 2007) | 2 lines

Allow make doxygen to work properly

------------------------------------------------------------------------
r1417 | sdake | 2007-08-10 21:35:50 -0700 (Fri, 10 Aug 2007) | 2 lines

Patch to add amf_strdup instead of malloc and then copy for amf service.

------------------------------------------------------------------------
r1412 | sdake | 2007-08-07 16:52:21 -0700 (Tue, 07 Aug 2007) | 2 lines

Fix minor leaks caused by not calling pthread_mutex_destroy throughout the tree.

------------------------------------------------------------------------
r1411 | sdake | 2007-08-07 16:49:24 -0700 (Tue, 07 Aug 2007) | 2 lines

Patch to fix compile warning on mac platforms.

------------------------------------------------------------------------
r1405 | sdake | 2007-07-02 14:13:52 -0700 (Mon, 02 Jul 2007) | 2 lines

Add the testcpg2 file missing from a previous commit.

------------------------------------------------------------------------
r1404 | fthomas | 2007-07-02 05:41:53 -0700 (Mon, 02 Jul 2007) | 1 line

remove warnings under Darwin for missing includes and too many parameters in TRACE2
------------------------------------------------------------------------
r1399 | pcaulfie | 2007-06-25 05:34:44 -0700 (Mon, 25 Jun 2007) | 2 lines

Clear pid when we leave a process group

------------------------------------------------------------------------
r1398 | sdake | 2007-06-25 01:45:58 -0700 (Mon, 25 Jun 2007) | 3 lines

Fix bug where if checkpoint section is expired about the same time as a
checkpoint is deleted, a warning would be displayed.

------------------------------------------------------------------------
r1397 | sdake | 2007-06-25 01:45:29 -0700 (Mon, 25 Jun 2007) | 2 lines

Update testckpt program to properly test checkpoint system.

------------------------------------------------------------------------
r1391 | sdake | 2007-06-24 20:04:35 -0700 (Sun, 24 Jun 2007) | 2 lines

Add cpg_local_get api to cpg service

------------------------------------------------------------------------
r1388 | sdake | 2007-06-23 23:44:27 -0700 (Sat, 23 Jun 2007) | 2 lines

Add IP address takeover as an AMF component

------------------------------------------------------------------------
r1386 | sdake | 2007-06-23 02:14:15 -0700 (Sat, 23 Jun 2007) | 2 lines

Add passive monitoring support to AMF.

------------------------------------------------------------------------
r1385 | pcaulfie | 2007-06-14 07:21:49 -0700 (Thu, 14 Jun 2007) | 2 lines

Add man pages for cpg_context_* and fix library exports to include them too.

------------------------------------------------------------------------
r1384 | pcaulfie | 2007-06-13 02:09:10 -0700 (Wed, 13 Jun 2007) | 4 lines

Install the timer.h file so it can be used by
external services and remove a dependency on tlist.h


------------------------------------------------------------------------
r1383 | pcaulfie | 2007-06-13 02:01:30 -0700 (Wed, 13 Jun 2007) | 9 lines

Currently saLckResourceUnlockAsync leaves the lockid in the handle database even
when the lock has been unlocked. This can cause exec crashes if the lock is
unlocked twice.

This patch adds an extra field to the res_lib_lck_resourceunlockasync structure
so that the library can remove the lock from the handle database when the lock
is unlocked successfully, as well as code to do it, obviously.


------------------------------------------------------------------------
r1381 | fthomas | 2007-06-12 09:43:50 -0700 (Tue, 12 Jun 2007) | 1 line

repair BSD/Darwin build by moving HZ constant in tlist.h
------------------------------------------------------------------------
r1380 | pcaulfie | 2007-06-05 02:52:29 -0700 (Tue, 05 Jun 2007) | 2 lines

Cast away a compile warning

------------------------------------------------------------------------
r1379 | sdake | 2007-06-05 01:55:44 -0700 (Tue, 05 Jun 2007) | 2 lines

Remove this_ip from the source tree and replace with accessor functions.

------------------------------------------------------------------------
r1378 | sdake | 2007-06-04 16:21:46 -0700 (Mon, 04 Jun 2007) | 3 lines

Change timers to add duration and absolute timers.  Use nanoseconds since
epoch to track timers.

------------------------------------------------------------------------
r1377 | pcaulfie | 2007-05-31 02:41:37 -0700 (Thu, 31 May 2007) | 2 lines

Add get/set context API calls to the cpg service.

------------------------------------------------------------------------
r1376 | pcaulfie | 2007-05-30 01:41:46 -0700 (Wed, 30 May 2007) | 3 lines

Don't try and remove a lock from a list if it's not on one, but DO remove
it from the resources list when it gets unlocked.

------------------------------------------------------------------------
r1375 | sdake | 2007-05-22 08:45:31 -0700 (Tue, 22 May 2007) | 2 lines

Sanitize the ETCDIR usage in the Makefiles.

------------------------------------------------------------------------
r1374 | sdake | 2007-05-22 08:44:42 -0700 (Tue, 22 May 2007) | 2 lines

Use rync -a when cp -a is not available on MAC OSX platform install

------------------------------------------------------------------------
r1373 | pcaulfie | 2007-05-18 00:28:36 -0700 (Fri, 18 May 2007) | 6 lines

This patch fixes the marshalling of lock names in libSaLck, they
were copied using memcpy, but the alignment of a mar_name_t is not necessarily
the same as SaNameT. This patch changes memcpy() to marshall_to_mar_name_t().



------------------------------------------------------------------------
r1371 | sdake | 2007-05-17 13:37:20 -0700 (Thu, 17 May 2007) | 3 lines

on 32 bit platforms, the message source conn info could have uninitialized
values.

------------------------------------------------------------------------
r1370 | pcaulfie | 2007-05-05 07:02:53 -0700 (Sat, 05 May 2007) | 7 lines

In trunk, totemip.h and totem.h call for "../include/swab.h" - this works fine
when building openais itself but causes problems when installed as those files
will not be in the right place.

So, I've moved these includes out of totemip.h and totem.h and into the .c files
that call them.

------------------------------------------------------------------------
r1367 | sdake | 2007-04-24 16:10:51 -0700 (Tue, 24 Apr 2007) | 2 lines

Fix section iteration size comparison

------------------------------------------------------------------------
r1366 | sdake | 2007-04-24 16:08:48 -0700 (Tue, 24 Apr 2007) | 2 lines

Print Unknown Time if the time is unknown of an event.

------------------------------------------------------------------------
r1365 | sdake | 2007-04-24 16:08:18 -0700 (Tue, 24 Apr 2007) | 2 lines

Change tab alignment on checkpoint write operation to match coding style guidelines

------------------------------------------------------------------------
r1362 | sdake | 2007-04-24 16:02:21 -0700 (Tue, 24 Apr 2007) | 2 lines

Fixes problem where if attributes list is zero, library would segfault

------------------------------------------------------------------------
r1361 | sdake | 2007-04-21 16:49:47 -0700 (Sat, 21 Apr 2007) | 2 lines

change references to evs to cpg to match API

------------------------------------------------------------------------
r1360 | sdake | 2007-04-20 17:02:29 -0700 (Fri, 20 Apr 2007) | 2 lines

Patch from Angus to fix return code of saAmfResponse if the handle was invalid.

------------------------------------------------------------------------
r1358 | sdake | 2007-03-21 13:08:29 -0700 (Wed, 21 Mar 2007) | 2 lines

Fix documentation errors in cpg service.

------------------------------------------------------------------------
r1355 | sdake | 2007-03-14 12:02:49 -0700 (Wed, 14 Mar 2007) | 2 lines

Solaris port patch to fix a few problems from last big patch.

------------------------------------------------------------------------
r1354 | sdake | 2007-03-12 10:28:44 -0700 (Mon, 12 Mar 2007) | 2 lines

Patch to allow BSD/Linux systems to compile with latest Solaris porting patch.

------------------------------------------------------------------------
r1353 | sdake | 2007-03-06 09:18:44 -0700 (Tue, 06 Mar 2007) | 2 lines

Patch from Renaud to report some broken Solaris porting from past.

------------------------------------------------------------------------
r1352 | hafe | 2007-01-26 06:03:55 -0700 (Fri, 26 Jan 2007) | 8 lines

This patch improves AMF's behaviour for handling component instantiation level.
AMF is complemented to handle termination and instantiation with respect to
instantiation level also for the following scenarios:
- SU restart
- termination/instantiation errors during component/SU restart
- instantiation error during cluster start up


------------------------------------------------------------------------
r1351 | hafe | 2007-01-25 01:19:38 -0700 (Thu, 25 Jan 2007) | 2 lines

Was writing to random mem using an uninitialized pointer

------------------------------------------------------------------------
r1350 | sdake | 2007-01-23 10:39:43 -0700 (Tue, 23 Jan 2007) | 2 lines

Display the names of the configuration files used by openais.

------------------------------------------------------------------------
r1349 | sdake | 2007-01-23 10:38:58 -0700 (Tue, 23 Jan 2007) | 2 lines

Add two notifications about things to avoid to ensure proper operation of the parser.

------------------------------------------------------------------------
r1348 | sdake | 2007-01-23 10:07:50 -0700 (Tue, 23 Jan 2007) | 2 lines

Fixes from Zoltan regarding AMF mispellings and type errors.

------------------------------------------------------------------------
r1347 | homlhl | 2007-01-18 00:39:42 -0700 (Thu, 18 Jan 2007) | 4 lines

- improves the inclosed dokumentation in amfsu,amfsg and amnode.
- improves error handling  caused by the INSTANTIATE or CLEANUP  command
  while recovering  with component_restart or su_restart

------------------------------------------------------------------------
r1346 | homlhl | 2006-12-21 05:33:39 -0700 (Thu, 21 Dec 2006) | 4 lines

1 The patch contains mainly updates of the header documentation in the
amf_files
2 Correction of the misspelling in lib/cfg.c

------------------------------------------------------------------------
r1343 | sdake | 2006-12-18 08:22:59 -0700 (Mon, 18 Dec 2006) | 2 lines

Fix unaligned access for ia64 arch.

------------------------------------------------------------------------
r1342 | sdake | 2006-12-18 08:21:28 -0700 (Mon, 18 Dec 2006) | 2 lines

Fix typo in pthread_mutex_destroy.

------------------------------------------------------------------------
r1341 | sdake | 2006-12-18 08:09:31 -0700 (Mon, 18 Dec 2006) | 2 lines

Execute pthread destroy in queue_free in trunk.

------------------------------------------------------------------------
r1336 | sdake | 2006-12-12 11:44:19 -0700 (Tue, 12 Dec 2006) | 2 lines

Fix mutex leak on various platforms.

------------------------------------------------------------------------
r1335 | sdake | 2006-12-12 11:40:01 -0700 (Tue, 12 Dec 2006) | 2 lines

Remove leak when pthread mutex isn't released

------------------------------------------------------------------------
r1333 | sdake | 2006-12-12 11:35:58 -0700 (Tue, 12 Dec 2006) | 2 lines

Fix leak by forward porting a change already in whitetank.

------------------------------------------------------------------------
r1332 | sdake | 2006-12-12 11:33:13 -0700 (Tue, 12 Dec 2006) | 2 lines

Change timing parameters for trunk to something more reasonable for a busy network.

------------------------------------------------------------------------
r1331 | sdake | 2006-12-12 11:21:33 -0700 (Tue, 12 Dec 2006) | 2 lines

Convert some spaces to tabs that was already in the whitetank branch.

------------------------------------------------------------------------
r1328 | sdake | 2006-12-12 11:08:06 -0700 (Tue, 12 Dec 2006) | 2 lines

Fix leak in uid and gid determination.

------------------------------------------------------------------------
r1327 | sdake | 2006-12-12 11:03:55 -0700 (Tue, 12 Dec 2006) | 2 lines

Fix flow control problem in trunk.

------------------------------------------------------------------------
r1326 | sdake | 2006-12-12 10:58:41 -0700 (Tue, 12 Dec 2006) | 2 lines

Add rundir patch to /var/lib/openais.

------------------------------------------------------------------------
r1324 | pcaulfie | 2006-12-12 10:47:33 -0700 (Tue, 12 Dec 2006) | 2 lines

Fix ordering of join messages

------------------------------------------------------------------------
r1322 | homlhl | 2006-12-10 23:06:21 -0700 (Sun, 10 Dec 2006) | 3 lines

Correct not initialized value  of  amf_comp in
amf_comp_find_from_conn_info () 

------------------------------------------------------------------------
r1321 | homlhl | 2006-12-10 22:37:07 -0700 (Sun, 10 Dec 2006) | 43 lines

This patch contians:

-  AMF handles a component report of injurious health.

- AMF handles saAmfHealthcheckConfirm() SA_AIS_ERR_FAILED_OPERATION
so that if it's a recent recovery ongoing amf does nothing but if it's
no  immediate recovery in progress, AMF invokes the recovery action
specified by the component when the health check is started If
the individual recommendation was SA_AMF_NO_RECOMMENDATION,
then AMF uses the configured recovery action for the component
(saAmfCompRecoveryOnError). If this recommendation also is
SA_AMF_NO_RECOMMENDATION, then AMF makes a component restart or
component/SU fail over counts on the value of
saAmfCompDisableRestart and saAmfSUFailover.

- Handling of cleanup of a component and health check response hardened.


- Time supervision and check return value of clc-cli CLEANUP command.


- Handle 'recommended recovery' specified by a component in an error
report. The potential recovery action to  choose
implemented is - component restart - and - node fails over.

- The attribute saAmfCompDisableRestart is now recognizable which means
that if the component specifies 'Component restart' and restart is
disabled
then the SU in which the component is contained shall fall over.

- The attribute saAmfSUFailover will not be recognized. SU will always
  fail
over as a single entity.

- A component can report an error on another component than itself.


- Implementation 'Instantiation Level' according to chapter 3.9.2 in the
AMF specification.
- Implementation of the escalation levels, component restart, SU
restart, SU fail over and Node fail over.


------------------------------------------------------------------------
r1320 | hafe | 2006-12-06 02:02:25 -0700 (Wed, 06 Dec 2006) | 2 lines

Corrected amf.c bug that could cause segv

------------------------------------------------------------------------
r1318 | hafe | 2006-12-05 05:36:29 -0700 (Tue, 05 Dec 2006) | 3 lines

Correction to segv handler
Added abort handler

------------------------------------------------------------------------
r1317 | hafe | 2006-12-04 07:28:40 -0700 (Mon, 04 Dec 2006) | 4 lines

- Use of sync_request() in SYNC service
- sync_abort() callback implemented


------------------------------------------------------------------------
r1311 | fthomas | 2006-11-23 01:49:21 -0700 (Thu, 23 Nov 2006) | 1 line

handle case where POLLHUP or POLLERR are not supported by OS
------------------------------------------------------------------------
r1310 | hafe | 2006-11-16 23:57:00 -0700 (Thu, 16 Nov 2006) | 2 lines

Cleaning up and preparing for later patch.

------------------------------------------------------------------------
r1309 | fthomas | 2006-11-16 10:36:52 -0700 (Thu, 16 Nov 2006) | 1 line

set default downcheck value to 1000ms
------------------------------------------------------------------------
r1308 | fthomas | 2006-11-16 10:34:44 -0700 (Thu, 16 Nov 2006) | 1 line

remove invalid code / warnings detected by Intel compiler
------------------------------------------------------------------------
r1304 | sdake | 2006-11-13 11:08:32 -0700 (Mon, 13 Nov 2006) | 3 lines

Print information about when we enter the gather state and what state the
membership protocol is in when the token is lost.

------------------------------------------------------------------------
r1303 | sdake | 2006-11-13 10:55:51 -0700 (Mon, 13 Nov 2006) | 2 lines

Forward port of IPC code from whitetank branch to fix known defects.

------------------------------------------------------------------------
r1302 | sdake | 2006-11-13 10:47:42 -0700 (Mon, 13 Nov 2006) | 2 lines

Flushed printing for trunk branch.

------------------------------------------------------------------------
r1301 | sdake | 2006-11-13 10:39:10 -0700 (Mon, 13 Nov 2006) | 3 lines

Improve behavior of IPC flow control for CPG service during configuration
changes.

------------------------------------------------------------------------
r1299 | sdake | 2006-11-10 10:46:22 -0700 (Fri, 10 Nov 2006) | 3 lines

Update checkpoint service from all qualifications that have occured in
whitetank branch.

------------------------------------------------------------------------
r1298 | sdake | 2006-11-10 10:45:38 -0700 (Fri, 10 Nov 2006) | 2 lines

Recovery algorithms described in this document.

------------------------------------------------------------------------
r1297 | homlhl | 2006-11-10 07:10:46 -0700 (Fri, 10 Nov 2006) | 2 lines

improved cluster_applications_are_starting_sgs

------------------------------------------------------------------------
r1292 | hafe | 2006-11-08 05:13:39 -0700 (Wed, 08 Nov 2006) | 2 lines

removed compiler warning in amfcomp.c

------------------------------------------------------------------------
r1291 | homlhl | 2006-11-08 04:55:16 -0700 (Wed, 08 Nov 2006) | 3 lines

This patch contains several corrections concerning SU and Node fail 
over and some hardening concerning health check handling.

------------------------------------------------------------------------
r1290 | pcaulfie | 2006-11-07 07:47:01 -0700 (Tue, 07 Nov 2006) | 3 lines

2.6.19 kernel headers do not include IFA_RTA so we provide it.
Patch from Fabio Massimo Di Nitto

------------------------------------------------------------------------
r1289 | sdake | 2006-11-04 15:29:14 -0700 (Sat, 04 Nov 2006) | 2 lines

Forward port of flow control work from whitetank branch.

------------------------------------------------------------------------
r1287 | sdake | 2006-11-04 15:20:24 -0700 (Sat, 04 Nov 2006) | 2 lines

Updated readme.devmap file

------------------------------------------------------------------------
r1285 | hafe | 2006-10-27 02:58:59 -0700 (Fri, 27 Oct 2006) | 12 lines

* Improvement of SU fail over to handle remove of those standby assignments
 that doesn't directly is associated to the failing over SU's active assignments
 in other SU's 
* Improvement of Node fail over to handle remove of those standby assignments
 that doesn't directly is associated to the failing over  Node SU's active assignments
 in other SU's.

* Improvement of SU fail over to handle si assignments to spare SU:s

* Improvement of Node fail over to handle si assignments to spare SU:s


------------------------------------------------------------------------
r1281 | hafe | 2006-10-23 23:45:35 -0700 (Mon, 23 Oct 2006) | 3 lines

AMF healthcheck keylen was not compared before matching key values


------------------------------------------------------------------------
r1280 | hafe | 2006-10-23 23:30:50 -0700 (Mon, 23 Oct 2006) | 6 lines

- sync_abort is called if there is a new config change during synchronization

- a new function sync_request() that can be called by a user to execute
synchronization on request of a specified service. 


------------------------------------------------------------------------
r1274 | hafe | 2006-10-20 08:03:42 -0700 (Fri, 20 Oct 2006) | 6 lines

Changes to testamf1.c to have two healthchecks running at the same time.
One of type 'AMF invoked' and one of type 'component invoked'. testamf1.c
code got a bit restructured at the same time.

Changes in amf.conf to complement testamf1 

------------------------------------------------------------------------
r1273 | hafe | 2006-10-20 04:28:51 -0700 (Fri, 20 Oct 2006) | 3 lines

I found some (copy paste I guess) errors in the AMF library. It was
the reason for why component invoked healthchecks did not work at all. 

------------------------------------------------------------------------
r1272 | hafe | 2006-10-20 04:20:59 -0700 (Fri, 20 Oct 2006) | 6 lines

A couple of errors was found when I did unit (component) testing of amf.c
using CUnit. With this patch, amf.c can handle a full totem send queue.
This is not easily reproducable with function test.

amf.c is also prepared for further component testing with this patch. 

------------------------------------------------------------------------
r1266 | homlhl | 2006-10-13 03:18:04 -0700 (Fri, 13 Oct 2006) | 26 lines

Patch contains:

A mechanism to defer and recall simultaneous
events in the state machines for amf_cluster,
amf_application and amf_sg.

The implication of this defer and recall mechanism is
that it's now possible to to recover from e.g. several
simultaneous SU failures in an ordered serialized manner.

The events that could be deferred/recalled so far is
SG_FAILOVER_NODE_EV,SG_START_EV,SG_FAILOVER_SU_EV,
CLUSTER_SYNC_READY_EV,APPLICATION_START_EV and
APPLICATION_ASSIGN_WORKLOAD_EV.

Files involved:

Index: exec/amfnode.c
Index: exec/amfsg.c
Index: exec/amfutil.c
Index: exec/amfapp.c
Index: exec/amfcomp.c
Index: exec/amfcluster.c
Index: exec/amf.h


------------------------------------------------------------------------
r1259 | hafe | 2006-10-11 23:54:14 -0700 (Wed, 11 Oct 2006) | 5 lines

This simple patch solves a problem we see when testing AMF. If a node leaves
and joins the cluster quickly (within one second is default), the config
change messages will not indicate that the node left and rejoined. The patch
introduces a short delay in main() to make sure the token_timeout expires. 

------------------------------------------------------------------------
r1255 | sdake | 2006-10-09 00:41:46 -0700 (Mon, 09 Oct 2006) | 2 lines

Enable commit tokens to be processed properly in all circumstances.

------------------------------------------------------------------------
r1254 | sdake | 2006-10-09 00:41:12 -0700 (Mon, 09 Oct 2006) | 2 lines

Fix subset set operation to work properly.

------------------------------------------------------------------------
r1253 | sdake | 2006-10-09 00:40:46 -0700 (Mon, 09 Oct 2006) | 2 lines

Remove some debbugging code from totemsrp impacting performance.

------------------------------------------------------------------------
r1251 | homlhl | 2006-10-03 22:24:14 -0700 (Tue, 03 Oct 2006) | 65 lines

The patch contains:
 
 The instantiaton of the component is performed with some new steps:
 
 1. SU invoke Comp to instantiate
 2. Comp multicast a new event 
 MESSAGE_REQ_EXEC_AMF_COMPONENT_INSTANTIATE
 3. Comp receive the new  event 
 MESSAGE_REQ_EXEC_AMF_COMPONENT_INSTANTIATE
 4. If the Comp is within the SU hosted on the node. The 

 component invokes

    the clc_cli instantiate script to start the component 

 and start a timer

    to supervise the start and registration of the component.
 5. If the instantiation time elapse before the component has 
 registered himself
    Comp is sending a new multicasted event
    MESSAGE_REQ_EXEC_AMF_COMPONENT_INSTANTIATE_TMO.
 6. Comp receive 

 MESSAGE_REQ_EXEC_AMF_COMPONENT_INSTANTIATE_TMO event.

 7. The Comp presence state is set to 
 SA_AMF_PRESENCE_INSTANTIATION_FAILED
 8. When all Components are in presence state 

 SA_AMF_PRESENCE_INSTANTIATED or

    SA_AMF_PRESENCE_INSTANTIATION_FAILED the start or restart will 
 continue with
    the assignment of load.
 
 This implemntation means that the complete instantiation procedure 
 never will be endlessly waiting for a register. The 

 instantiation will 

 either turn out in a component instantiation failure or a success.
 
 
 Hardening of the cluster start use case:
 
 1. A clearer separation of the responsibilities between 

 amf_cluster and

    amf_application.
                      
 2. A clearer interface and separation between amf_main (amf.c) and 
 amf_cluster.
 
 3. A clearer interface and separation between amf_cluster 

 and amf_node.

 
 4. A clearer separation of the responsibilities between amf_node and
    amf_application.
 


------------------------------------------------------------------------
r1250 | hafe | 2006-09-29 06:27:01 -0700 (Fri, 29 Sep 2006) | 3 lines

The configuration attribute 'saAmfSGNumPrefInserviceSUs' was not
considered by AMF during initial start. 

------------------------------------------------------------------------
r1249 | hafe | 2006-09-29 04:23:00 -0700 (Fri, 29 Sep 2006) | 3 lines

Two configuration attributes for SG objects were not handled
correctly by the config parser. 

------------------------------------------------------------------------
r1247 | hafe | 2006-09-27 22:53:44 -0700 (Wed, 27 Sep 2006) | 7 lines

Patches from Mathieu.Marie@sun.com:
2- On Solaris, the SA components executed have no names.
3- When killing the testamf1 component, it makes the aisexec process 
crash on both of my nodes.
4- max priority for RR on solaris is 59.


------------------------------------------------------------------------
r1244 | hafe | 2006-09-24 23:55:39 -0700 (Sun, 24 Sep 2006) | 7 lines

An update of README.amf to match current state of the implementation.
README.amf now also includes a detailed list of what is currently
NOT implemented.

README.amf includes now, as before, a "demo example".


------------------------------------------------------------------------
r1243 | hafe | 2006-09-24 23:48:38 -0700 (Sun, 24 Sep 2006) | 4 lines

- Fix for bug: 'default section created when syncing'
- Section count synced correctly


------------------------------------------------------------------------
r1242 | hafe | 2006-09-24 23:46:29 -0700 (Sun, 24 Sep 2006) | 4 lines

global_ckpt_id fix #2
ckpt dump function


------------------------------------------------------------------------
r1241 | hafe | 2006-09-20 01:27:01 -0700 (Wed, 20 Sep 2006) | 4 lines

Correction to a problem when a cluster consisting of several nodes starts
initially in an order such that at least two nodes start after at least one
node has been started and its SUs has been instantiated. 

------------------------------------------------------------------------
r1240 | hafe | 2006-09-12 04:04:54 -0700 (Tue, 12 Sep 2006) | 2 lines

Created

------------------------------------------------------------------------
r1239 | hafe | 2006-09-11 00:15:53 -0700 (Mon, 11 Sep 2006) | 3 lines

Fix for global_ckpt_id not synced


------------------------------------------------------------------------
r1238 | hafe | 2006-09-05 22:40:06 -0700 (Tue, 05 Sep 2006) | 4 lines

- ckpt_id was not synced.
- debug printout of list reduced


------------------------------------------------------------------------
r1237 | hafe | 2006-09-05 00:54:00 -0700 (Tue, 05 Sep 2006) | 6 lines

1.    Improvement to manage more than one SG within an Application  and to
	asymmetrically distribute the SG:s among the Nodes.
2.    strcmp bug fixes  several *_find functions.
3.    Minor bug fixes.


------------------------------------------------------------------------
r1236 | hafe | 2006-09-05 00:31:28 -0700 (Tue, 05 Sep 2006) | 14 lines

- "No need for DNS or /etc/hosts"

The call to gethostbyaddr() has been removed. This has been replaced by a
protocol where each node multicasts its hostname (obtained with gethostname()).

- "Logical AMF nodes"

The AMF node name is no longer a hostname. The saAmfNodeClmNode
configuration attribute of the AMF node is now the hostname. This config
attribute is now mandatory. The change to amf.conf file shows required changes.

- Some other AMF sync bug fixes


------------------------------------------------------------------------
r1235 | hafe | 2006-09-01 03:16:25 -0700 (Fri, 01 Sep 2006) | 3 lines

Added file and line of caller, useful for troubleshooting.


------------------------------------------------------------------------
r1234 | hafe | 2006-09-01 03:12:25 -0700 (Fri, 01 Sep 2006) | 7 lines

- enable the global debug flag again, individual 'logger' directives might
  be used to disable a certain logger source.
- when DEBUG compiled it does not use the new printer threads (printouts are not buffered)
- man page update
- openais.conf update


------------------------------------------------------------------------
r1233 | hafe | 2006-08-28 06:11:23 -0700 (Mon, 28 Aug 2006) | 3 lines

Allow AMF to handle health check responses while syncing.


------------------------------------------------------------------------
r1232 | hafe | 2006-08-28 05:44:15 -0700 (Mon, 28 Aug 2006) | 7 lines

1.    Improvement of the use case 'Amf node leave spontaneously'
2.    Improvement of the use case 'Amf node join'
3.    Improvement to manage more than one SG within an Application.
4.    Improvement to manage an arbitrary number of Csi-assignments associated
       to the Csi


------------------------------------------------------------------------
r1231 | fthomas | 2006-08-28 05:19:59 -0700 (Mon, 28 Aug 2006) | 1 line

add missing clean for libcfg
------------------------------------------------------------------------
r1229 | fthomas | 2006-08-24 08:54:10 -0700 (Thu, 24 Aug 2006) | 1 line

correct fd leak on error case
------------------------------------------------------------------------
r1228 | fthomas | 2006-08-24 08:48:25 -0700 (Thu, 24 Aug 2006) | 1 line

correct broken POLLHUP, POLLERR under BSD
------------------------------------------------------------------------
r1227 | hafe | 2006-08-24 02:30:27 -0700 (Thu, 24 Aug 2006) | 1 line

AMF sync improvements: change assert to return in mcast rec.
------------------------------------------------------------------------
r1226 | hafe | 2006-08-24 02:23:40 -0700 (Thu, 24 Aug 2006) | 1 line

testamf1.c improvements
------------------------------------------------------------------------
r1225 | fthomas | 2006-08-23 02:33:08 -0700 (Wed, 23 Aug 2006) | 1 line

return SA_AIS_ERR_INVALID_PARAM when vector ptr is NULL or len equal to 0
------------------------------------------------------------------------
r1222 | fthomas | 2006-08-21 02:49:42 -0700 (Mon, 21 Aug 2006) | 1 line

doc was not updated when switching command line options to lowercase
------------------------------------------------------------------------
r1221 | fthomas | 2006-08-18 00:38:21 -0700 (Fri, 18 Aug 2006) | 1 line

do not include alloca.h under BSD; alloca is in stdlib.h
------------------------------------------------------------------------
r1220 | hafe | 2006-08-17 06:25:01 -0700 (Thu, 17 Aug 2006) | 1 line

AMF sync #2
------------------------------------------------------------------------
r1219 | fthomas | 2006-08-17 00:30:55 -0700 (Thu, 17 Aug 2006) | 1 line

add command line support with: launch as a foreground application, do not set priority
------------------------------------------------------------------------
r1214 | sdake | 2006-08-15 21:25:47 -0700 (Tue, 15 Aug 2006) | 4 lines

Add scalability to 128 nodes by adding new parameter to protocol which is
a random timeout bounded by a configuration parameter when sending join
messages.

------------------------------------------------------------------------
r1211 | sdake | 2006-08-15 18:21:52 -0700 (Tue, 15 Aug 2006) | 2 lines

Return ERR_TIMEOUT if timeout value is zero in saEvtChannelOpen

------------------------------------------------------------------------
r1208 | sdake | 2006-08-15 17:08:52 -0700 (Tue, 15 Aug 2006) | 2 lines

Fix make install to install clm shared object files properly.

------------------------------------------------------------------------
r1207 | sdake | 2006-08-15 17:05:02 -0700 (Tue, 15 Aug 2006) | 2 lines

Improve recovery code to produce correct printf notice outputs.

------------------------------------------------------------------------
r1206 | sdake | 2006-08-15 17:04:27 -0700 (Tue, 15 Aug 2006) | 2 lines

Fix debug output for testckpt service.

------------------------------------------------------------------------
r1200 | hafe | 2006-08-11 05:28:10 -0700 (Fri, 11 Aug 2006) | 19 lines

- New sync state machine, implemented and described in amf.c
- One AMF node reads the AMF config file (IMM style)
- One AMF node syncs others AMF nodes
- One AMF object is serialized and sent as one message
- Serialization/deserialization of most objects is trivial (memcpy)
except for component and csi-attributes objects which have variable size
arrays/strings.
- Depth first AMF object tree traversal preserves relations when syncing
- Ordered lists of SUs and SIs
- Constructors/destructor per class
- Serializers/deserializers per class
- Config-change changes sync state
- Sync callbacks executes the sync
- "Use case" tracing for sync using the SYNCTRACE macro (trace6)
- Sync master is initially the winner of a timeout race and if the
master leaves the cluster, the node with the lowest node ID becomes new master.
- amf_malloc implements an AMF central malloc routine with error handling.


------------------------------------------------------------------------
r1199 | pcaulfie | 2006-08-11 00:37:15 -0700 (Fri, 11 Aug 2006) | 3 lines

fixe a bug in cpg where get_group() will return the wrong group
info structure if there is a hash collision.

------------------------------------------------------------------------
r1178 | sdake | 2006-08-07 15:49:36 -0700 (Mon, 07 Aug 2006) | 2 lines

Fix checkpoint header file error

------------------------------------------------------------------------
r1177 | sdake | 2006-08-05 01:51:06 -0700 (Sat, 05 Aug 2006) | 2 lines

Committed a bunch of changes for testing scalability - reverting patch

------------------------------------------------------------------------
r1176 | sdake | 2006-08-04 19:23:40 -0700 (Fri, 04 Aug 2006) | 2 lines

non-blocking syslog and file logging support

------------------------------------------------------------------------
r1175 | sdake | 2006-08-04 19:22:12 -0700 (Fri, 04 Aug 2006) | 2 lines

Solaris port for openais

------------------------------------------------------------------------
r1174 | sdake | 2006-08-02 22:32:11 -0700 (Wed, 02 Aug 2006) | 2 lines

Make sure sync_activate is called only once per service handler.

------------------------------------------------------------------------
r1172 | hafe | 2006-08-02 01:24:58 -0700 (Wed, 02 Aug 2006) | 3 lines

Removes the hardcoded limit of environment variables and argvs from components, now unlimited.


------------------------------------------------------------------------
r1171 | hafe | 2006-07-31 22:56:30 -0700 (Mon, 31 Jul 2006) | 4 lines

- Handling of HUP and other poll errors improved in saAmfDispatch.
- Termination of testamf1 when saAmfDispatch returns an error.


------------------------------------------------------------------------
r1170 | sdake | 2006-07-28 16:34:28 -0700 (Fri, 28 Jul 2006) | 2 lines

Patch so realloc reverts to old buffer if reallocation fails.

------------------------------------------------------------------------
r1169 | sdake | 2006-07-28 16:33:57 -0700 (Fri, 28 Jul 2006) | 2 lines

Fix lock marshalling.

------------------------------------------------------------------------
r1168 | sdake | 2006-07-26 00:42:50 -0700 (Wed, 26 Jul 2006) | 2 lines

Endian conversion for evs service.

------------------------------------------------------------------------
r1167 | sdake | 2006-07-26 00:41:44 -0700 (Wed, 26 Jul 2006) | 2 lines

Endian cleanup for ykd.

------------------------------------------------------------------------
r1166 | sdake | 2006-07-26 00:39:53 -0700 (Wed, 26 Jul 2006) | 2 lines

Cleanup log_printf to use gnu attributes to do automatic type checking.

------------------------------------------------------------------------
r1165 | sdake | 2006-07-26 00:32:43 -0700 (Wed, 26 Jul 2006) | 2 lines

Endian conversion for the lock service.

------------------------------------------------------------------------
r1164 | sdake | 2006-07-26 00:21:08 -0700 (Wed, 26 Jul 2006) | 3 lines

Use memb_ring_id_copy for alignment purposes on 64 aligned arches and keep
the port id in host byte order until it is used in the totem protocol stack.

------------------------------------------------------------------------
r1163 | sdake | 2006-07-26 00:11:26 -0700 (Wed, 26 Jul 2006) | 2 lines

Add endian cleanup fixes.

------------------------------------------------------------------------
r1162 | sdake | 2006-07-26 00:07:22 -0700 (Wed, 26 Jul 2006) | 2 lines

Clean up endian swabbing for cpg service.

------------------------------------------------------------------------
r1161 | sdake | 2006-07-25 23:58:28 -0700 (Tue, 25 Jul 2006) | 2 lines

Fix where setsockopt is bound to in totemnet.

------------------------------------------------------------------------
r1160 | sdake | 2006-07-25 23:57:52 -0700 (Tue, 25 Jul 2006) | 2 lines

Cleanup comparisons in lcr_ifact and use strtok_r instead of junky parser.

------------------------------------------------------------------------
r1159 | sdake | 2006-07-25 23:55:10 -0700 (Tue, 25 Jul 2006) | 2 lines

Add errno.h include since it was removed from swab.h.

------------------------------------------------------------------------
r1158 | sdake | 2006-07-25 23:53:50 -0700 (Tue, 25 Jul 2006) | 2 lines

Remove bunch of unused includes from swab.h.

------------------------------------------------------------------------
r1157 | sdake | 2006-07-25 23:51:17 -0700 (Tue, 25 Jul 2006) | 2 lines

Fix processor count in evs interface.

------------------------------------------------------------------------
r1156 | sdake | 2006-07-25 23:50:22 -0700 (Tue, 25 Jul 2006) | 2 lines

Endian cleanup for the clm service.

------------------------------------------------------------------------
r1152 | sdake | 2006-07-23 18:34:17 -0700 (Sun, 23 Jul 2006) | 2 lines

Allow build type of COVERAGE for code coverage analysis

------------------------------------------------------------------------
r1151 | sdake | 2006-07-21 13:30:29 -0700 (Fri, 21 Jul 2006) | 2 lines

Ensure make install works with recent libcfg changes.

------------------------------------------------------------------------
r1150 | pcaulfie | 2006-07-21 05:22:05 -0700 (Fri, 21 Jul 2006) | 6 lines

Add a 'family' parameter to totemip_parse so it can be told to look for 
either IPv4 or IPv6 addresses, or both.

As we get the (unambiguous) multicast address first, we can make sure we always
look for the right type of node address afterwards.

------------------------------------------------------------------------
r1149 | sdake | 2006-07-21 02:01:12 -0700 (Fri, 21 Jul 2006) | 3 lines

Increase IPC thread stack size from 100k to 200k to accomodate larger data
structures in ipc message handlers (for the CLM service).

------------------------------------------------------------------------
r1148 | sdake | 2006-07-20 20:30:40 -0700 (Thu, 20 Jul 2006) | 2 lines

Remove TODO for swabbing conn data structure

------------------------------------------------------------------------
r1147 | sdake | 2006-07-20 20:26:22 -0700 (Thu, 20 Jul 2006) | 2 lines

Validate IO Vector elements in a saCkptCheckpointWrite operation

------------------------------------------------------------------------
r1146 | sdake | 2006-07-20 20:18:03 -0700 (Thu, 20 Jul 2006) | 2 lines

Remove TODO comment that has long been fixed in the code.

------------------------------------------------------------------------
r1145 | sdake | 2006-07-20 20:07:14 -0700 (Thu, 20 Jul 2006) | 3 lines

Correct malloc of checkpoint iteration size from 500 bytes to max section id
size bytes for the created checkpoint

------------------------------------------------------------------------
r1144 | sdake | 2006-07-20 19:39:21 -0700 (Thu, 20 Jul 2006) | 3 lines

Reduce memory usage in large configurations by dynamically allocating
fragmentation assembly buffer.

------------------------------------------------------------------------
r1143 | sdake | 2006-07-20 19:33:13 -0700 (Thu, 20 Jul 2006) | 2 lines

Remove marshall TODO items as they are not needed

------------------------------------------------------------------------
r1142 | sdake | 2006-07-20 15:39:22 -0700 (Thu, 20 Jul 2006) | 2 lines

Remove unnecessary exit from testevs

------------------------------------------------------------------------
r1141 | sdake | 2006-07-20 03:01:57 -0700 (Thu, 20 Jul 2006) | 2 lines

Remove debug printf in totemsrp

------------------------------------------------------------------------
r1140 | sdake | 2006-07-19 21:51:32 -0700 (Wed, 19 Jul 2006) | 2 lines

Don't segfault if unauthorized user connects

------------------------------------------------------------------------
r1139 | sdake | 2006-07-19 21:50:15 -0700 (Wed, 19 Jul 2006) | 3 lines

Make checkpoint service work according to specifications with regards to the
unlink operation.

------------------------------------------------------------------------
r1138 | sdake | 2006-07-19 12:33:20 -0700 (Wed, 19 Jul 2006) | 2 lines

Remove compile warning from cfgtool commit.

------------------------------------------------------------------------
r1137 | sdake | 2006-07-19 12:31:01 -0700 (Wed, 19 Jul 2006) | 3 lines

Add support for reenabling a failed redundant ring and printing ring status
through the test/opeanis-cfgtool application.

------------------------------------------------------------------------
r1136 | pcaulfie | 2006-07-19 08:32:25 -0700 (Wed, 19 Jul 2006) | 3 lines

Send the new joinlists using the sync service, so it happens atomically.
This should fix some odd sequencing bugs.

------------------------------------------------------------------------
r1135 | pcaulfie | 2006-07-17 23:33:39 -0700 (Mon, 17 Jul 2006) | 3 lines

printing ipv6 addresses often needs more than a 32 byte buffer. THis could
causes a crash with sone ipv6 installations.

------------------------------------------------------------------------
r1133 | sdake | 2006-07-17 15:36:13 -0700 (Mon, 17 Jul 2006) | 2 lines

Support for ia64 arch builds.

------------------------------------------------------------------------
r1132 | sdake | 2006-07-17 14:52:55 -0700 (Mon, 17 Jul 2006) | 2 lines

Fix synchronization not working properly.

------------------------------------------------------------------------
r1131 | sdake | 2006-07-17 13:16:14 -0700 (Mon, 17 Jul 2006) | 2 lines

Event marshalling patch for 32/64/endian support.

------------------------------------------------------------------------
r1130 | sdake | 2006-07-16 23:18:19 -0700 (Sun, 16 Jul 2006) | 2 lines

If version field is NULL as passed to saClmInitialize, return INVALID_PARAM

------------------------------------------------------------------------
r1129 | sdake | 2006-07-16 23:17:47 -0700 (Sun, 16 Jul 2006) | 3 lines

If TRACK_CURRENT is specified in CLM service and notify buffer is null,
return tracking data in callback as per specification.

------------------------------------------------------------------------
r1128 | sdake | 2006-07-16 23:15:47 -0700 (Sun, 16 Jul 2006) | 2 lines

Remove debug printf in track stop operation

------------------------------------------------------------------------
r1127 | sdake | 2006-07-16 23:14:33 -0700 (Sun, 16 Jul 2006) | 2 lines

Check for invalid handles first in API calls.

------------------------------------------------------------------------
r1126 | sdake | 2006-07-16 23:12:11 -0700 (Sun, 16 Jul 2006) | 2 lines

If the max section size is less then the read size, return INVALID_PARAM.

------------------------------------------------------------------------
r1125 | sdake | 2006-07-16 19:20:37 -0700 (Sun, 16 Jul 2006) | 2 lines

Return INVALID_PARAM when section read is larger then checkpoint section

------------------------------------------------------------------------
r1124 | sdake | 2006-07-16 14:58:35 -0700 (Sun, 16 Jul 2006) | 2 lines

CheckpointRead wasn't checking the active replica was set.

------------------------------------------------------------------------
r1123 | sdake | 2006-07-16 14:50:39 -0700 (Sun, 16 Jul 2006) | 3 lines

The creation attributes set bit wasn't set from the library to executive
message handlers causing significant problems with open was called from a app.

------------------------------------------------------------------------
r1122 | sdake | 2006-07-16 14:49:36 -0700 (Sun, 16 Jul 2006) | 2 lines

The open flags are used before they are verified to be valid.

------------------------------------------------------------------------
r1121 | sdake | 2006-07-14 14:09:57 -0700 (Fri, 14 Jul 2006) | 2 lines

Proper barrier operation as requested.

------------------------------------------------------------------------
r1120 | sdake | 2006-07-13 15:02:47 -0700 (Thu, 13 Jul 2006) | 2 lines

Add support for s390 and s390x architectures.

------------------------------------------------------------------------
r1119 | sdake | 2006-07-13 14:57:35 -0700 (Thu, 13 Jul 2006) | 2 lines

Fix library renames to 2.0.0 as needed by distros.

------------------------------------------------------------------------
r1118 | sdake | 2006-07-11 16:41:56 -0700 (Tue, 11 Jul 2006) | 2 lines

Update to checkpoint service to use new APIs as rest of services do.

------------------------------------------------------------------------
r1117 | sdake | 2006-07-10 16:51:43 -0700 (Mon, 10 Jul 2006) | 2 lines

Fix broken timers when release type set to RELEASE

------------------------------------------------------------------------
r1116 | sdake | 2006-07-10 15:22:21 -0700 (Mon, 10 Jul 2006) | 2 lines

Remove dead definition of struct queue

------------------------------------------------------------------------
r1115 | sdake | 2006-07-10 15:19:46 -0700 (Mon, 10 Jul 2006) | 2 lines

Missing commit from previous rename of saServiceConnectTwo

------------------------------------------------------------------------
r1114 | sdake | 2006-07-10 15:18:32 -0700 (Mon, 10 Jul 2006) | 2 lines

Rename saConnectServiceTwo to saConnectService

------------------------------------------------------------------------
r1113 | sdake | 2006-07-10 15:12:49 -0700 (Mon, 10 Jul 2006) | 2 lines

Fix typo in saMsg.h header file.

------------------------------------------------------------------------
r1112 | sdake | 2006-07-10 15:11:43 -0700 (Mon, 10 Jul 2006) | 2 lines

Rev versions to 2.0 and update versions script for all services

------------------------------------------------------------------------
r1111 | sdake | 2006-07-07 12:44:11 -0700 (Fri, 07 Jul 2006) | 3 lines

The member list, joined list, and left list in configuration changes
was not valid.

------------------------------------------------------------------------
r1110 | fthomas | 2006-07-07 09:35:21 -0700 (Fri, 07 Jul 2006) | 1 line

remove commited conflict
------------------------------------------------------------------------
r1109 | pcaulfie | 2006-07-07 02:36:03 -0700 (Fri, 07 Jul 2006) | 2 lines

testcpg -i shows node ids as IP addresses.

------------------------------------------------------------------------
r1108 | hafe | 2006-07-07 01:04:01 -0700 (Fri, 07 Jul 2006) | 14 lines

- Error escalation improved, SU failover recovery action added
- Most runtime attributes in the inf. model calculated in runtime from
  more fundamental information. (improves consistency)
- sg_assign_si can now recalculate workloads considering existing
  assignments
- Logging improvements, similar to what is required as notification in
  AMF spec.
- CLC-CLI INSTANTIATE now exits aisexec when it fails (should later be
  sent as an NTF alarm)
- CLC-CLI CLEANUP correctly handles already terminated processes
- testamf1.c printouts removed for normal operation
- Iterator functions for SI/CSI assignments 


------------------------------------------------------------------------
r1105 | sdake | 2006-07-06 18:34:55 -0700 (Thu, 06 Jul 2006) | 2 lines

Make sure RELEASE version detaches from tty

------------------------------------------------------------------------
r1103 | sdake | 2006-07-06 15:34:14 -0700 (Thu, 06 Jul 2006) | 3 lines

The testcpg tool now prints IP addresses instead of a hex value indicating the
node id.

------------------------------------------------------------------------
r1102 | sdake | 2006-07-06 15:33:41 -0700 (Thu, 06 Jul 2006) | 3 lines

The recent endian/32/64 changes broke cpg callbacks.  The left list address
was incorrectly calculated.

------------------------------------------------------------------------
r1101 | sdake | 2006-07-06 14:08:48 -0700 (Thu, 06 Jul 2006) | 2 lines

The totem rrp incorrectly increased the wrong failure counter.

------------------------------------------------------------------------
r1100 | sdake | 2006-06-30 12:21:30 -0700 (Fri, 30 Jun 2006) | 2 lines

marshall of cpg_join name field is wrong.

------------------------------------------------------------------------
r1099 | sdake | 2006-06-29 15:03:08 -0700 (Thu, 29 Jun 2006) | 2 lines

Rework of the timer system to allow timers to be added in dispatch handlers.

------------------------------------------------------------------------
r1098 | sdake | 2006-06-29 14:41:51 -0700 (Thu, 29 Jun 2006) | 2 lines

Rewrite of the checkpoint benchmark using threads tool

------------------------------------------------------------------------
r1097 | sdake | 2006-06-28 21:05:47 -0700 (Wed, 28 Jun 2006) | 2 lines

set serialize lock to proper function.

------------------------------------------------------------------------
r1096 | sdake | 2006-06-28 17:01:10 -0700 (Wed, 28 Jun 2006) | 2 lines

Rework of IPC layer once again

------------------------------------------------------------------------
r1095 | sdake | 2006-06-27 16:42:38 -0700 (Tue, 27 Jun 2006) | 4 lines

Fix problem where AMF locks up system if two or more components are members
of the same service unit.  Also fixes problem where AMF asserts if two or
more components are specified in a service unit.

------------------------------------------------------------------------
r1094 | sdake | 2006-06-27 16:37:06 -0700 (Tue, 27 Jun 2006) | 2 lines

Fix 32/64 endian for all services from a previous missed commit.

------------------------------------------------------------------------
r1092 | sdake | 2006-06-27 16:31:21 -0700 (Tue, 27 Jun 2006) | 3 lines

Fix double free problem in ipc by reworking libais_disconnect to match previous
rewritten model in picacho.

------------------------------------------------------------------------
r1091 | hafe | 2006-06-27 01:49:07 -0700 (Tue, 27 Jun 2006) | 7 lines

AMF changes:
- Revised cluster start 
- Includes Steven's "amf invalid write patch"
- Includes "components not started with 0.76" patch
- New timer API use backed out of AMF (temporary)


------------------------------------------------------------------------
r1090 | sdake | 2006-06-26 14:02:00 -0700 (Mon, 26 Jun 2006) | 2 lines

Finally remove all references to ais_amf.h and replace with saAmf.h.

------------------------------------------------------------------------
r1089 | sdake | 2006-06-26 13:30:44 -0700 (Mon, 26 Jun 2006) | 3 lines

Corrected timer deadlock that occurs when a timer add or delete operation
occurs within a timer expiration event.

------------------------------------------------------------------------
r1088 | sdake | 2006-06-26 13:30:15 -0700 (Mon, 26 Jun 2006) | 2 lines

Removed ais_amf.h and instead point all refs to saAmf.h

------------------------------------------------------------------------
r1087 | sdake | 2006-06-25 13:29:14 -0700 (Sun, 25 Jun 2006) | 2 lines

Remove dead file

------------------------------------------------------------------------
r1086 | sdake | 2006-06-23 13:49:19 -0700 (Fri, 23 Jun 2006) | 2 lines

Missed commit of marshall file for some reason.

------------------------------------------------------------------------
r1085 | sdake | 2006-06-23 11:38:25 -0700 (Fri, 23 Jun 2006) | 2 lines

Make cpg 32/64 userland safe and endian safe.

------------------------------------------------------------------------
r1084 | pcaulfie | 2006-06-22 09:07:30 -0700 (Thu, 22 Jun 2006) | 3 lines

Fix message alignment in CPG.
we now unpack the message in the same way as we pack it.

------------------------------------------------------------------------
r1081 | sdake | 2006-06-21 16:32:46 -0700 (Wed, 21 Jun 2006) | 2 lines

Change makefile to install swab from correct place

------------------------------------------------------------------------
r1077 | sdake | 2006-06-21 16:03:11 -0700 (Wed, 21 Jun 2006) | 2 lines

New make release in top level makefile

------------------------------------------------------------------------
r1076 | sdake | 2006-06-21 14:32:03 -0700 (Wed, 21 Jun 2006) | 2 lines

Modify AMF to use new timer.c/timer.h routines properly

------------------------------------------------------------------------
r1074 | sdake | 2006-06-21 14:15:16 -0700 (Wed, 21 Jun 2006) | 2 lines

32/64/mixed endian support for checkpoint service.

------------------------------------------------------------------------
r1073 | sdake | 2006-06-21 14:13:34 -0700 (Wed, 21 Jun 2006) | 2 lines

Fix for early logging from Hans.

------------------------------------------------------------------------
r1072 | sdake | 2006-06-21 14:10:05 -0700 (Wed, 21 Jun 2006) | 2 lines

Fix error where pathlist buffer is overrun resulting in segfault

------------------------------------------------------------------------
r1071 | hafe | 2006-06-19 23:45:16 -0700 (Mon, 19 Jun 2006) | 10 lines

Refactoring of AMF into several files (based on classed in inf.
model). A central header file (amf.h) keeps all the definitions and
prototypes needed.

New things apart from that:
- some doxygen html generated from AMF e.g. each file has a description
- saAmfHAStateGet() now works
- component invoked healthchecks implemented (but not tested)


------------------------------------------------------------------------
r1070 | sdake | 2006-06-19 15:59:32 -0700 (Mon, 19 Jun 2006) | 2 lines

Fix off by one error in totemsrp.

------------------------------------------------------------------------
r1069 | sdake | 2006-06-19 03:51:41 -0700 (Mon, 19 Jun 2006) | 2 lines

Missed timer commit.

------------------------------------------------------------------------
r1068 | sdake | 2006-06-19 03:50:34 -0700 (Mon, 19 Jun 2006) | 2 lines

missed commit

------------------------------------------------------------------------
r1067 | sdake | 2006-06-16 12:51:55 -0700 (Fri, 16 Jun 2006) | 2 lines

deferred timer system so that timers may be deferred during synchronization.

------------------------------------------------------------------------
r1066 | sdake | 2006-06-16 12:16:22 -0700 (Fri, 16 Jun 2006) | 3 lines

Fix dependencies and install all header files for external service handlers.
New defination required to build external service handlers.

------------------------------------------------------------------------
r1065 | sdake | 2006-06-16 12:07:28 -0700 (Fri, 16 Jun 2006) | 3 lines

Allow CFLAGS and LDFLAGS to be overridden through the environment or command
line.

------------------------------------------------------------------------
r1061 | sdake | 2006-06-05 15:39:07 -0700 (Mon, 05 Jun 2006) | 2 lines

Remove warnings in AMF executive service.

------------------------------------------------------------------------
r1060 | sdake | 2006-06-05 15:18:09 -0700 (Mon, 05 Jun 2006) | 2 lines

Update TODO file with cluster membership 32/64/endian work being completed.

------------------------------------------------------------------------
r1059 | sdake | 2006-06-05 15:14:46 -0700 (Mon, 05 Jun 2006) | 2 lines

32/64/endian everything should work now for openais clm service.

------------------------------------------------------------------------
r1058 | hafe | 2006-05-31 06:20:43 -0700 (Wed, 31 May 2006) | 16 lines

- (Re-)introduction of event based multicast messages (not all yet)
- Use of Distinguished Names (DN) in API and multicast messages
- CSI resassignment properly handled (by using restarting state)
- State 'setter' functions with uniform printouts
- Simple 'assign SU to host' algorithm:
	- based on saAmfSUHostedByNode config attribute
	- see config file for example
- Debug print runtime attributes upon user request:
	$ pkill -USR2 aisexec
- Object-oriented naming of functions started (but not finished)
- testamf1.c updated with some new tests
- Minor fix in print.h and print.c
- AMF can be started on two nodes (example config file needs
  modification for this) 


------------------------------------------------------------------------
r1057 | sdake | 2006-05-28 15:14:44 -0700 (Sun, 28 May 2006) | 2 lines

Set to SCHED_RR:1 to match ipc layer

------------------------------------------------------------------------
r1056 | sdake | 2006-05-28 15:13:52 -0700 (Sun, 28 May 2006) | 2 lines

sched_setscheduler was passing wrong argument

------------------------------------------------------------------------
r1055 | sdake | 2006-05-27 00:17:24 -0700 (Sat, 27 May 2006) | 2 lines

Update TODO to match 2006 project priorities.

------------------------------------------------------------------------
r1054 | sdake | 2006-05-26 19:19:09 -0700 (Fri, 26 May 2006) | 8 lines

This sanitizes the makefiles in several ways
* .so and .so.1 files are linked to library.so.1.0.0 and installed with
make install
* renames all build targets to library.so.1.0.0 from library.so.1.0
* puts ld.so.conf.d files in the correct place
* allows not installing static libraries by using make install
STATICLIBS=NO

------------------------------------------------------------------------
r1053 | sdake | 2006-05-26 19:18:11 -0700 (Fri, 26 May 2006) | 6 lines

This patch checks the result of read operations on a socket which can
return errors or 0.  Now if those cases happen, the operation is
ignored.  This part of the code needs more attention later to handle
short reads.  This removes a warning when fortify source is defined to
the compiler.

------------------------------------------------------------------------
r1052 | sdake | 2006-05-26 19:17:33 -0700 (Fri, 26 May 2006) | 7 lines

This patch does the following things:
* changes the default search path for lcrso files to /usr/libexec/lcrso
* checks the result of getcwd which can fail and return an error - in
that case handle the error appropriately
* changes a comment that was incorrectly stating only the cwd was being
searched for lcrso files

------------------------------------------------------------------------
r1051 | sdake | 2006-05-26 19:16:21 -0700 (Fri, 26 May 2006) | 5 lines

Under load, it was observed that the token could be lost because the
totem protocol was not being scheduled above the other I/O processes.
This patch reinstalls the sched_setscheduler call which for some reason
was commented out.

------------------------------------------------------------------------
r1050 | sdake | 2006-05-26 12:41:01 -0700 (Fri, 26 May 2006) | 4 lines

defect 1270
Fix checkpoint read operation which would return invalid operation in some
circumstances.

------------------------------------------------------------------------
r1049 | sdake | 2006-05-25 23:46:24 -0700 (Thu, 25 May 2006) | 3 lines

Remove scandir error=%s printf since it spews a bunch of errors when the
aisexec is run after a make install

------------------------------------------------------------------------
r1048 | sdake | 2006-05-25 23:15:33 -0700 (Thu, 25 May 2006) | 2 lines

sanitize make install in Makefile

------------------------------------------------------------------------
r1047 | sdake | 2006-05-25 21:22:55 -0700 (Thu, 25 May 2006) | 2 lines

Fix segfault if rrp_mode: MODE isn't set in configuration file.

------------------------------------------------------------------------
r1046 | sdake | 2006-05-25 21:19:40 -0700 (Thu, 25 May 2006) | 3 lines

Remove warning about memb_set_print not being used.  This is only useful for
debugging.

------------------------------------------------------------------------
r1045 | sdake | 2006-05-25 21:08:18 -0700 (Thu, 25 May 2006) | 4 lines

Remove deliver_fn which is not the ipc delivery function handler but the
executive multicasted messages delivery function.  This was inadvertantly copied
and pasted from main.c

------------------------------------------------------------------------
r1044 | sdake | 2006-05-25 19:31:49 -0700 (Thu, 25 May 2006) | 2 lines

Properly process the ld.so.conf file if it has includes.

------------------------------------------------------------------------
r1043 | sdake | 2006-05-25 19:31:04 -0700 (Thu, 25 May 2006) | 2 lines

Remove warning about unsigned/signed passed to strcpy

------------------------------------------------------------------------
r1042 | sdake | 2006-05-25 19:25:20 -0700 (Thu, 25 May 2006) | 2 lines

Modified initscript to not start by default on redhat systems

------------------------------------------------------------------------
r1041 | sdake | 2006-05-25 19:21:03 -0700 (Thu, 25 May 2006) | 2 lines

Return unsigned char as needed by gcc 4.1

------------------------------------------------------------------------
r1040 | sdake | 2006-05-25 19:09:48 -0700 (Thu, 25 May 2006) | 3 lines

code analysis found a memset overwrote a data structure.


------------------------------------------------------------------------
r1039 | pcaulfie | 2006-05-25 00:33:12 -0700 (Thu, 25 May 2006) | 2 lines

Add missing endian conversion to memb_merge_detect

------------------------------------------------------------------------
r1038 | pcaulfie | 2006-05-23 01:43:02 -0700 (Tue, 23 May 2006) | 3 lines

Remove poinless man-page.
bug fix CPG example.

------------------------------------------------------------------------
r1035 | sdake | 2006-05-21 16:11:42 -0700 (Sun, 21 May 2006) | 4 lines

commit for redundant ring take 4 was only done from exec directory missing all
of the commits for the rest of the directories.  This commit will now allow the
tree to compile.

------------------------------------------------------------------------
r1034 | sdake | 2006-05-21 16:01:34 -0700 (Sun, 21 May 2006) | 2 lines

First take at doxygen support for openais APIs.

------------------------------------------------------------------------
r1033 | sdake | 2006-05-19 13:31:35 -0700 (Fri, 19 May 2006) | 3 lines

Endian fixes for the recent redundant ring protocol work plus the cluster
membership API support.

------------------------------------------------------------------------
r1032 | sdake | 2006-05-19 12:49:40 -0700 (Fri, 19 May 2006) | 4 lines

The redundant ring take 4 patch.  This includes modes for active, passive,
and none.  Read openais.conf.5 for information regarding how to configure
redundant ring.

------------------------------------------------------------------------
r1031 | sdake | 2006-05-19 12:40:40 -0700 (Fri, 19 May 2006) | 3 lines

Patch to allow system to work if no ld.so.conf is present.  ld.so.conf is
optional and may not be present on a system.

------------------------------------------------------------------------
r1030 | pcaulfie | 2006-05-19 00:38:30 -0700 (Fri, 19 May 2006) | 2 lines

Don't crash if we get an unathenticated connection from a library.

------------------------------------------------------------------------
r1029 | pcaulfie | 2006-05-19 00:36:49 -0700 (Fri, 19 May 2006) | 2 lines

Allow the syslog facility type to be set in the configuration file.

------------------------------------------------------------------------
r1028 | pcaulfie | 2006-05-17 05:54:37 -0700 (Wed, 17 May 2006) | 2 lines

Move CPG_SERVICE into service_types where it belongs.

------------------------------------------------------------------------
r1027 | pcaulfie | 2006-05-17 00:34:09 -0700 (Wed, 17 May 2006) | 2 lines

Close ld.so.conf file descriptor when finished with it.

------------------------------------------------------------------------
r1026 | hafe | 2006-05-17 00:22:43 -0700 (Wed, 17 May 2006) | 16 lines

Introduction of SA Forum information model for AMF as specified in
SAI-Overview-B.02.01.pdf. Other AMF changes as specified in
SAI-AIS-AMF-B.02.01.

Summary:

- SA Forum B.02 Information model for AMF
- groups.conf renamed to amf.conf
- amf.conf syntax changed heavily to follow SA Forum specs.
- AMF works when daemon.
- linux lists removed from AMF
- component cmd environment variables support
- component argv support
- multi value csi attributes


------------------------------------------------------------------------
r1025 | pcaulfie | 2006-05-15 06:38:25 -0700 (Mon, 15 May 2006) | 7 lines

getaddrinfo() doesn't actually set errno, it has its own error variable, so 
returning -errno is not useful (it may be zero even if getaddrinfo failed).

So, simply return -1 if getaddrinfo fails, to indicate a name resolution
or badly formed address.


------------------------------------------------------------------------
r1024 | sdake | 2006-05-10 17:40:06 -0700 (Wed, 10 May 2006) | 4 lines

Environment variable cleanup, documentation of environment variables in
man pages, and rename of one of the environment variables used to specify
the main openais configuration file.

------------------------------------------------------------------------
r1023 | fthomas | 2006-05-10 05:43:17 -0700 (Wed, 10 May 2006) | 1 line

fix compile under darwin: sched_setscheduler does not exist
------------------------------------------------------------------------
r1022 | hafe | 2006-05-09 23:20:00 -0700 (Tue, 09 May 2006) | 12 lines

- Preprocessor flags to control user, group and directory for
configuration files removed.

- Environment variables for the same thing added:
	OPENAIS_AISPARSER_FILE
	OPENAIS_AMF_CONFIG_FILE
	OPENAIS_TOTEM_AUTHKEY_FILE

- Make depend target in exec makefile updated with missing source files.



------------------------------------------------------------------------
r1021 | hafe | 2006-05-03 01:45:44 -0700 (Wed, 03 May 2006) | 8 lines

- printouts buffered before log_setup() has been called, flushed at early exit.
- rests of old logging removed from all code (#define LOG_SERVICE...).
- line feed added if not in message.
- new trace() function added so that trace macros adds minimum of code and runtime penalties to user code.
- ENTER_ARGS macro changed to ENTER. ENTER macro now requires arguments.
- openais.conf.5 man page updated with logger directives.


------------------------------------------------------------------------
r1020 | pcaulfie | 2006-05-02 07:49:23 -0700 (Tue, 02 May 2006) | 3 lines

Cope with >32 groups on a node that goes down.
Add a missing endian conversion.

------------------------------------------------------------------------
r1019 | sdake | 2006-04-29 21:57:22 -0700 (Sat, 29 Apr 2006) | 2 lines

Fix comile failures for BSD/Darwin port

------------------------------------------------------------------------
r1018 | sdake | 2006-04-29 21:52:21 -0700 (Sat, 29 Apr 2006) | 2 lines

add vsf none option for those that don't want a virtual synchrony filter

------------------------------------------------------------------------
r1017 | sdake | 2006-04-28 10:57:04 -0700 (Fri, 28 Apr 2006) | 2 lines

Fix up mutexes to avoid deadlocks

------------------------------------------------------------------------
r1016 | pcaulfie | 2006-04-28 01:55:33 -0700 (Fri, 28 Apr 2006) | 6 lines

A misplaced close brace, caused cpg to only return the first node in the
list went several went down.

Also, replaced totemip_equal() calls with nodeid comparisons as CPG works
entirely on nodeIDs anyway.

------------------------------------------------------------------------
r1015 | sdake | 2006-04-27 13:41:22 -0700 (Thu, 27 Apr 2006) | 2 lines

Remove prio commented out code

------------------------------------------------------------------------
r1014 | sdake | 2006-04-27 13:18:44 -0700 (Thu, 27 Apr 2006) | 2 lines

Add invalid handle definition

------------------------------------------------------------------------
r1013 | sdake | 2006-04-26 18:46:36 -0700 (Wed, 26 Apr 2006) | 3 lines

Remove priority from aispoll since we now use the kernel scheduler for
priorities for polling

------------------------------------------------------------------------
r1012 | sdake | 2006-04-26 18:43:28 -0700 (Wed, 26 Apr 2006) | 2 lines

Add IPC files from missing previous commit

------------------------------------------------------------------------
r1011 | sdake | 2006-04-26 18:39:10 -0700 (Wed, 26 Apr 2006) | 2 lines

This patch reworks IPC to use threads instead of the main poll loop

------------------------------------------------------------------------
r1010 | sdake | 2006-04-26 15:24:30 -0700 (Wed, 26 Apr 2006) | 4 lines

Fix segfault because list was not reinitialized after its entry was deleted
and it would later be deleted by closing the ipc.
the 

------------------------------------------------------------------------
r1009 | hafe | 2006-04-26 02:00:41 -0700 (Wed, 26 Apr 2006) | 1 line

test commit, one line amf.c change in clc_cli_cleanup
------------------------------------------------------------------------
r1008 | fthomas | 2006-04-25 00:28:20 -0700 (Tue, 25 Apr 2006) | 1 line

Remove warnings under Darwin
------------------------------------------------------------------------
r1007 | sdake | 2006-04-25 00:11:25 -0700 (Tue, 25 Apr 2006) | 2 lines

Fix scanning of LCRSOs not working on various systems

------------------------------------------------------------------------
r1006 | sdake | 2006-04-25 00:04:09 -0700 (Tue, 25 Apr 2006) | 3 lines

Patch to ensure backlogs are never negative which would cause problems with
the flow control algorithm and protocol in general.

------------------------------------------------------------------------
r1005 | sdake | 2006-04-25 00:03:09 -0700 (Tue, 25 Apr 2006) | 2 lines

Allow running with BUILD_DYNAMIC set to zero.

------------------------------------------------------------------------
r1002 | sdake | 2006-04-24 12:05:59 -0700 (Mon, 24 Apr 2006) | 3 lines

Patch from Hans to clean up some error handling in main.c when service handlers
do the wrong thing.

------------------------------------------------------------------------
r1001 | sdake | 2006-04-24 12:00:26 -0700 (Mon, 24 Apr 2006) | 2 lines

Patch from Hans to clean up main error handling a little bit

------------------------------------------------------------------------
r1000 | sdake | 2006-04-24 11:58:36 -0700 (Mon, 24 Apr 2006) | 2 lines

Clean out private key memory area in case of parser override is used

------------------------------------------------------------------------
r999 | sdake | 2006-04-24 11:56:02 -0700 (Mon, 24 Apr 2006) | 2 lines

Patch from Hans to fix segfault in loading of LCR components

------------------------------------------------------------------------
r998 | sdake | 2006-04-20 16:17:16 -0700 (Thu, 20 Apr 2006) | 2 lines

More make install work to install all necessary files

------------------------------------------------------------------------
r997 | markh | 2006-04-20 10:14:38 -0700 (Thu, 20 Apr 2006) | 2 lines

Updated copyright dates.

------------------------------------------------------------------------
r996 | sdake | 2006-04-19 13:39:25 -0700 (Wed, 19 Apr 2006) | 3 lines

Make install now works along with different search paths for openais's
lcrsos.

------------------------------------------------------------------------
r995 | sdake | 2006-04-18 12:53:18 -0700 (Tue, 18 Apr 2006) | 3 lines

Patch from Hans to significantly improve the logging functionality
read openais.conf.5 for info on how the new logging works.

------------------------------------------------------------------------
r994 | sdake | 2006-04-15 19:05:27 -0700 (Sat, 15 Apr 2006) | 2 lines

Remove segfault when object database can't be loaded

------------------------------------------------------------------------
r993 | sdake | 2006-04-15 19:03:45 -0700 (Sat, 15 Apr 2006) | 2 lines

Remove segfaults when object database can't be loaded for some reason.

------------------------------------------------------------------------
r992 | sdake | 2006-04-15 01:28:28 -0700 (Sat, 15 Apr 2006) | 2 lines

remove -DDEBUG from release build

------------------------------------------------------------------------
r991 | sdake | 2006-04-15 01:27:48 -0700 (Sat, 15 Apr 2006) | 3 lines

defect 1201
cleanup poll_dispatch_delete in trunk

------------------------------------------------------------------------
r990 | sdake | 2006-04-15 01:04:21 -0700 (Sat, 15 Apr 2006) | 3 lines

remove warnings form totemrrp and also fix bug where send_flush wasn't
being called for the active replication algorithm

------------------------------------------------------------------------
r989 | sdake | 2006-04-15 00:52:28 -0700 (Sat, 15 Apr 2006) | 2 lines

remove printf on evs join because groups may be binary data and crash executive

------------------------------------------------------------------------
r988 | sdake | 2006-04-15 00:42:30 -0700 (Sat, 15 Apr 2006) | 2 lines

Fix warning about unsigned int passed to orf_token_rtr for flow control count

------------------------------------------------------------------------
r987 | sdake | 2006-04-15 00:41:45 -0700 (Sat, 15 Apr 2006) | 2 lines

Fix warning regarding unsigned int for node_id

------------------------------------------------------------------------
r986 | sdake | 2006-04-15 00:38:25 -0700 (Sat, 15 Apr 2006) | 2 lines

Fix object_priv_get to actually call object_priv_get instead of object_priv_set

------------------------------------------------------------------------
r985 | sdake | 2006-04-15 00:29:57 -0700 (Sat, 15 Apr 2006) | 3 lines

cleanup warning in service.c because unsigned char * is passed to atoi instead
of char *

------------------------------------------------------------------------
r984 | sdake | 2006-04-15 00:28:11 -0700 (Sat, 15 Apr 2006) | 2 lines

Add missing vsf.h from previous commit 

------------------------------------------------------------------------
r983 | sdake | 2006-04-13 16:20:03 -0700 (Thu, 13 Apr 2006) | 3 lines

fix fc5 segfault correctly by removing code that violates strict aliasing
rules.

------------------------------------------------------------------------
r982 | sdake | 2006-04-13 16:11:07 -0700 (Thu, 13 Apr 2006) | 3 lines

scale part 3
componentize YKD dynamic linear voting algorithm

------------------------------------------------------------------------
r981 | sdake | 2006-04-12 22:39:51 -0700 (Wed, 12 Apr 2006) | 3 lines

Improvement of the rrp_algo data structure to support only running totemnet
api calls on the appropriate totemnet interfaces.

------------------------------------------------------------------------
r980 | sdake | 2006-04-12 19:51:39 -0700 (Wed, 12 Apr 2006) | 3 lines

Workaround possible optimizer bug in gcc 4.1 by forcing a function not to
inline.  This would cause segfaults on fc4.

------------------------------------------------------------------------
r979 | sdake | 2006-04-12 19:50:51 -0700 (Wed, 12 Apr 2006) | 2 lines

move nodeid from interface section to totem section

------------------------------------------------------------------------
r978 | pcaulfie | 2006-04-10 02:40:30 -0700 (Mon, 10 Apr 2006) | 3 lines

- Fix BUILD_DYNAMIC=0 (add amfconfig.o to SERV_OBJS)
- add objdb->object_find_reset() before looking for user/group names.

------------------------------------------------------------------------
r977 | pcaulfie | 2006-04-10 01:24:34 -0700 (Mon, 10 Apr 2006) | 2 lines

Split the logging config options into three keys: to_file, to_stderr & to_syslog

------------------------------------------------------------------------
r976 | sdake | 2006-04-08 16:14:52 -0700 (Sat, 08 Apr 2006) | 3 lines

defect 1191
Add more support for the redundant ring protocol.

------------------------------------------------------------------------
r975 | sdake | 2006-04-08 15:25:14 -0700 (Sat, 08 Apr 2006) | 4 lines

defect 1190
scale to 128 nodes more effectively by dynamically sending partial structures
in the commit token ahd memb_join messages.

------------------------------------------------------------------------
r972 | sdake | 2006-04-08 15:05:51 -0700 (Sat, 08 Apr 2006) | 3 lines

defect 1139
reorg of code to better support creating external service handlers

------------------------------------------------------------------------
r971 | sdake | 2006-04-08 15:05:00 -0700 (Sat, 08 Apr 2006) | 3 lines

defect 1170
another fix for the assertion in memb_recovery_enter

------------------------------------------------------------------------
r970 | pcaulfie | 2006-04-07 08:05:24 -0700 (Fri, 07 Apr 2006) | 4 lines

Use the tmp variable in the right iterator loop !
With debug enabled, that's a guaranteed crash in cpg when a node leaves.


------------------------------------------------------------------------
r969 | pcaulfie | 2006-04-06 03:31:28 -0700 (Thu, 06 Apr 2006) | 9 lines

Use objdb for configuration. All components now get a reference to
the objdb rather than openais_config.

The default config object "aisparser" reads openais.conf as before, but can
be overridden by an environment variable.

Bug 1132


------------------------------------------------------------------------
r968 | sdake | 2006-04-06 00:37:08 -0700 (Thu, 06 Apr 2006) | 3 lines

defect 1170
remove extra debug exit(1

------------------------------------------------------------------------
r967 | sdake | 2006-04-06 00:32:21 -0700 (Thu, 06 Apr 2006) | 3 lines

defect 1170
Fix recovery protocol to avoid assertion in memb_state_recovery_enter

------------------------------------------------------------------------
r966 | sdake | 2006-04-03 15:45:13 -0700 (Mon, 03 Apr 2006) | 3 lines

defect 205
implement totem single ring protocol flow control algorithm

------------------------------------------------------------------------
r965 | pcaulfie | 2006-04-03 01:47:42 -0700 (Mon, 03 Apr 2006) | 2 lines

Set the object value length too.

------------------------------------------------------------------------
r963 | sdake | 2006-03-31 13:10:33 -0700 (Fri, 31 Mar 2006) | 2 lines

Fix typo is clc_cli_script

------------------------------------------------------------------------
r962 | sdake | 2006-03-31 12:55:52 -0700 (Fri, 31 Mar 2006) | 3 lines

defect 1172
checkpoint service asserts under load during configuration changes

------------------------------------------------------------------------
r961 | fthomas | 2006-03-31 01:14:55 -0700 (Fri, 31 Mar 2006) | 1 line

defect 1178: use synchronous lock structure on reply
------------------------------------------------------------------------
r960 | sdake | 2006-03-29 12:02:42 -0700 (Wed, 29 Mar 2006) | 3 lines

defect 1153
Fix segfault with sync service if syncronization is interrupted during recovery.

------------------------------------------------------------------------
r959 | muniba | 2006-03-28 14:49:49 -0700 (Tue, 28 Mar 2006) | 3 lines

defect 1192
Fixes the issue of ckpt sections getting reordered and also fixes the issue of synchronizing ckpt while under the retention timer.

------------------------------------------------------------------------
r958 | pcaulfie | 2006-03-28 05:32:45 -0700 (Tue, 28 Mar 2006) | 4 lines

Call a service's config_init_fn() as soon as it is loaded. 
Then call exec_init_fn() after other initialisation has happened.


------------------------------------------------------------------------
r957 | sdake | 2006-03-27 10:37:21 -0700 (Mon, 27 Mar 2006) | 2 lines

patch from Hans to support amf B types

------------------------------------------------------------------------
r956 | sdake | 2006-03-24 11:48:47 -0700 (Fri, 24 Mar 2006) | 4 lines

enhancement 1145
Patch from Lars to implement csi attribute setting in config file and delivered
via callback.

------------------------------------------------------------------------
r955 | sdake | 2006-03-24 11:25:55 -0700 (Fri, 24 Mar 2006) | 3 lines

Patch from Hans to fix up the configurable /var/run and /etc/ais directory 
support.

------------------------------------------------------------------------
r954 | fthomas | 2006-03-24 01:28:12 -0700 (Fri, 24 Mar 2006) | 1 line

Bug 1130: add totempg log; remove warnings; add DPRINT macro
------------------------------------------------------------------------
r953 | sdake | 2006-03-23 10:32:42 -0700 (Thu, 23 Mar 2006) | 4 lines

objdb merge
add missing service.c file


------------------------------------------------------------------------
r952 | sdake | 2006-03-18 14:00:19 -0700 (Sat, 18 Mar 2006) | 3 lines

defect 1139
merge object database and do a general refactor of the code

------------------------------------------------------------------------
r951 | sdake | 2006-03-17 02:36:13 -0700 (Fri, 17 Mar 2006) | 8 lines

Patch from Hans
This patch (against r950) makes it possible to change the directory
where aisexec searches for configuration files. Pretty much in line with
the possibility to specify user and group. Just do:

make OPENAIS_CONFDIR=/tmp/ais


------------------------------------------------------------------------
r950 | sdake | 2006-03-15 22:41:28 -0700 (Wed, 15 Mar 2006) | 17 lines

Patch from Hans Feldt
This small patch (against r948) adds variable CPPFLAGS to all make rules 
that compiles `.c' files into `.o' files.

This makes it possible to set CPPFLAGS on the command line as in:

$ make CPPFLAGS=-DAMFDEBUG

Editing the makefile when prototyping is then not needed.

Another reason is that some of the openais C files are built using the 
implicit rule for C files (which uses CPPFLAGS). The change makes rules 
consistent with the implicit rule.

It also adds a few missing files to the clean make target.


------------------------------------------------------------------------
r949 | muniba | 2006-03-15 13:46:08 -0700 (Wed, 15 Mar 2006) | 2 lines

Fix the innacurate dataSize in the Checkpoint Read response reported by Bjorn.

------------------------------------------------------------------------
r948 | sdake | 2006-03-08 00:29:27 -0700 (Wed, 08 Mar 2006) | 5 lines

defect 1113
Checkpoint iteration is totally broken.  This patch makes checkpoint iteration
work properly for multiple checkpoint iterators and now is compliant with the
specifications for the trunk version.

------------------------------------------------------------------------
r947 | sdake | 2006-03-08 00:16:28 -0700 (Wed, 08 Mar 2006) | 3 lines

defect 1117
binding to localhost doesn't work.  This patch reenables that functionality.

------------------------------------------------------------------------
r946 | sdake | 2006-03-08 00:13:27 -0700 (Wed, 08 Mar 2006) | 4 lines

defect 1120
The AMF code doesn't detect invalid healthcheck keys and crashes when an
invalid healthcheck key is specified.

------------------------------------------------------------------------
r945 | sdake | 2006-03-08 00:10:51 -0700 (Wed, 08 Mar 2006) | 6 lines

defect 1116
The IPC code spins in recvmsg in the library resulting in poor performance
and deadlock in the AMF service.



------------------------------------------------------------------------
r944 | fthomas | 2006-03-07 15:50:50 -0700 (Tue, 07 Mar 2006) | 1 line

repair OPENAIS_COVERAGE, OPENAIS_PROFILE
------------------------------------------------------------------------
r943 | fthomas | 2006-03-07 15:48:43 -0700 (Tue, 07 Mar 2006) | 1 line

use sched_get_priority_max to set the maximum priority
------------------------------------------------------------------------
r942 | muniba | 2006-03-07 12:40:23 -0700 (Tue, 07 Mar 2006) | 3 lines

defect 1115
added support for reinitializing synchrony to support ongoing sync during a re-configuration.

------------------------------------------------------------------------
r941 | muniba | 2006-03-06 15:02:47 -0700 (Mon, 06 Mar 2006) | 3 lines

defect 1115
fix faulty check.

------------------------------------------------------------------------
r940 | pcaulfie | 2006-03-06 05:11:21 -0700 (Mon, 06 Mar 2006) | 2 lines

Add man pages for the libcpg functions.

------------------------------------------------------------------------
r939 | pcaulfie | 2006-03-06 01:46:56 -0700 (Mon, 06 Mar 2006) | 6 lines

Fix testcpg.c so it actually works.

in exec/cpg: Don't regard a process as joined until all all nodes have
             received the message.
             Don't send other nodes' processes in a joinlist message!

------------------------------------------------------------------------
r938 | muniba | 2006-03-05 19:44:04 -0700 (Sun, 05 Mar 2006) | 2 lines

bug 1115. Fixes the synchronization algorithm which was skipping services.

------------------------------------------------------------------------
r937 | muniba | 2006-03-05 15:33:24 -0700 (Sun, 05 Mar 2006) | 2 lines

Bug Fix for memory leak in ckpt section management. Bug 1112

------------------------------------------------------------------------
r936 | pcaulfie | 2006-03-03 01:46:45 -0700 (Fri, 03 Mar 2006) | 2 lines

Add cpg (closed process groups) component.

------------------------------------------------------------------------
r935 | sdake | 2006-03-02 16:26:58 -0700 (Thu, 02 Mar 2006) | 4 lines

defect 981
This patch fixes a problem where the synchronization engine would not work
cross endian.

------------------------------------------------------------------------
r934 | sdake | 2006-03-02 16:26:35 -0700 (Thu, 02 Mar 2006) | 3 lines

defect 981
This patch fixes a problem where ykd would not work cross endian

------------------------------------------------------------------------
r933 | sdake | 2006-03-02 16:25:51 -0700 (Thu, 02 Mar 2006) | 3 lines

defect 981
This patch fixes a problem where totempg would not work cross-endian.

------------------------------------------------------------------------
r932 | muniba | 2006-03-01 18:05:10 -0700 (Wed, 01 Mar 2006) | 2 lines

reverting fix to man page as only 0.72 is broken with last byte zero in bindnetaddress

------------------------------------------------------------------------
r931 | muniba | 2006-03-01 14:45:00 -0700 (Wed, 01 Mar 2006) | 2 lines

Remove the reference to the use of 0 as last byte in the bindnetaddr

------------------------------------------------------------------------
r927 | sdake | 2006-02-21 00:46:14 -0700 (Tue, 21 Feb 2006) | 4 lines

defect 1099
move "ais" init script to mvlcge
add redhat init script from Bjorn

------------------------------------------------------------------------
r926 | sdake | 2006-02-21 00:32:00 -0700 (Tue, 21 Feb 2006) | 2 lines

Fabien's patch for the BSD/Darwin port.

------------------------------------------------------------------------
r925 | sdake | 2006-02-14 19:08:34 -0700 (Tue, 14 Feb 2006) | 5 lines

Patch from Patrick
This patch restores the functionality in previous versions where the node
address could be specified as a network address in openais.conf


------------------------------------------------------------------------
r924 | sdake | 2006-02-14 19:02:55 -0700 (Tue, 14 Feb 2006) | 6 lines

enhancement 1049
Patch from Patrick
This simple patch stops a potential DoS. If a library tries to access a
component that is not loaded into the exec then it will crash trying to deref
ais_service_handlers[ service ]

------------------------------------------------------------------------
r923 | sdake | 2006-02-11 15:29:29 -0700 (Sat, 11 Feb 2006) | 4 lines

enhancement 1088
This replaces MSG_DONTWAIT with an fcntl to O_NONBLOCK to be more portable
for the BSD port since BSD doesn't support MSG_DONTWAIT properly.

------------------------------------------------------------------------
r922 | sdake | 2006-02-11 15:25:54 -0700 (Sat, 11 Feb 2006) | 5 lines

defect 981
big endian and little endian in the same network causes infinite loop.  This
patch fixes that problem for the totem layer only.  Other components are not
resolved.

------------------------------------------------------------------------
r921 | sdake | 2006-02-10 15:58:31 -0700 (Fri, 10 Feb 2006) | 2 lines

Get rid of junk debug statement

------------------------------------------------------------------------
r920 | sdake | 2006-02-10 15:53:18 -0700 (Fri, 10 Feb 2006) | 6 lines

defect 1088
First patch for porting to BSD systems.  This patch removes the WAITALL
flag entirely from the library handlers, as it appears there may be some
portability problems with this flag.  The code already handles partial
reads anyway, so it was not necessary.

------------------------------------------------------------------------
r918 | sdake | 2006-02-10 15:38:43 -0700 (Fri, 10 Feb 2006) | 3 lines

defect 1066
original 1066 fix introduced new bug found with saftest

------------------------------------------------------------------------
r917 | sdake | 2006-02-10 14:05:57 -0700 (Fri, 10 Feb 2006) | 3 lines

Some versions of GCC were optimizing out the static ctor section.  This patch
makes the ctor non-static so it is not optimized out.

------------------------------------------------------------------------
r916 | sdake | 2006-02-09 17:30:29 -0700 (Thu, 09 Feb 2006) | 3 lines

Cleanup of dynamic loading to allow using the same interface factory code for
statically linked components.

------------------------------------------------------------------------
r915 | sdake | 2006-02-01 16:46:44 -0700 (Wed, 01 Feb 2006) | 3 lines

Patch from Patrick to enable configuring the list of dynamic service handlers
in the configuration file.

------------------------------------------------------------------------
r914 | sdake | 2006-02-01 14:17:47 -0700 (Wed, 01 Feb 2006) | 5 lines

1049
make all service handlers dynamically loadable or compilable statically
use the BUILD_DYNAMIC flag in the makefile to set dynamic loading or static
compile.

------------------------------------------------------------------------
r912 | sdake | 2006-02-01 14:01:24 -0700 (Wed, 01 Feb 2006) | 3 lines

defect 1066
memory leak in saCkptSectionIterationInitialize

------------------------------------------------------------------------
r910 | sdake | 2006-02-01 13:57:01 -0700 (Wed, 01 Feb 2006) | 4 lines

defect 1065
memory leak in checkpoint iteration when IterationNext has a failure condition
(like NO_MORE_SECTIONS)

------------------------------------------------------------------------
r909 | sdake | 2006-02-01 13:45:26 -0700 (Wed, 01 Feb 2006) | 3 lines

defect 1068
bug in saHandleDestroy could cause extra put on handle when the check is invalid

------------------------------------------------------------------------
r906 | markh | 2006-01-25 12:16:31 -0700 (Wed, 25 Jan 2006) | 4 lines

defect 1049
Fix compile error in testlck and testmsg.  Use SA_AIS_OK.


------------------------------------------------------------------------
r905 | sdake | 2006-01-24 23:27:09 -0700 (Tue, 24 Jan 2006) | 3 lines

enhancement 1049
enhance services so dynamic service handlers are more easily possible

------------------------------------------------------------------------
r903 | markh | 2006-01-24 14:55:45 -0700 (Tue, 24 Jan 2006) | 5 lines

defect 1048 - make_event uses wrong handle database

Correct calls to saHandleDestroy to use the correct handle database.


------------------------------------------------------------------------
r902 | sdake | 2006-01-24 00:19:11 -0700 (Tue, 24 Jan 2006) | 3 lines

defect 1046
SaErrorT in trunk branch, but only SaAisErrorT should be used

------------------------------------------------------------------------
r898 | sdake | 2006-01-21 16:23:45 -0700 (Sat, 21 Jan 2006) | 3 lines

defect 1045
totempg is not thread safe, and AMF requires threads to instantiate components

------------------------------------------------------------------------
r892 | sdake | 2006-01-20 13:40:21 -0700 (Fri, 20 Jan 2006) | 8 lines

This is a major rework of the service handling code.  Now service handlers
can be dynamically loaded via the live component replacement service.  Sync
handlers are also dynamically contributed.

It is possible to build using either dynamic loading via LCR or static
linking of the entire executive.  This is controlled by the BUILD_DYNAMIC 
configuration option in the Makefile.

------------------------------------------------------------------------
r891 | sdake | 2006-01-15 23:29:08 -0700 (Sun, 15 Jan 2006) | 2 lines

remove old files that are no longer needed.

------------------------------------------------------------------------
r890 | sdake | 2006-01-13 16:50:21 -0700 (Fri, 13 Jan 2006) | 2 lines

Small man page cleanup

------------------------------------------------------------------------
r887 | markh | 2006-01-11 14:26:39 -0700 (Wed, 11 Jan 2006) | 5 lines

defect 1030

Check return pointer from malloc for NULL.  Back out any previous malloc
to eliminate memory leaks.  Return proper status.

------------------------------------------------------------------------
r886 | markh | 2006-01-11 14:23:56 -0700 (Wed, 11 Jan 2006) | 6 lines

defect 1030
This fixes the event handle leak on failure, the malloc check for hl,
removes the redundant memset when creating a handle, and makes sure
that the put of the channel handle is a valid handle.


------------------------------------------------------------------------
r885 | sdake | 2006-01-06 17:26:16 -0700 (Fri, 06 Jan 2006) | 3 lines

defect 1024
YKD algorithm doesn't always work when new_message_queue is full.

------------------------------------------------------------------------
r883 | markh | 2006-01-05 15:40:47 -0700 (Thu, 05 Jan 2006) | 4 lines

Fix for bug 1023.
Fixes a problem where the dispatcher can lose track of available
events if it gets SA_ERR_TRY_AGAIN from the exec.

------------------------------------------------------------------------
r882 | sdake | 2006-01-03 15:12:09 -0700 (Tue, 03 Jan 2006) | 3 lines

Add information about the event and amf directive in the openais.conf.5 man
page.

------------------------------------------------------------------------
r881 | sdake | 2006-01-03 14:18:00 -0700 (Tue, 03 Jan 2006) | 2 lines

Delete empty files.

------------------------------------------------------------------------
r880 | sdake | 2006-01-02 22:52:57 -0700 (Mon, 02 Jan 2006) | 3 lines

enhancement 1020
adds missing file from commit

------------------------------------------------------------------------
r879 | sdake | 2006-01-02 22:51:38 -0700 (Mon, 02 Jan 2006) | 3 lines

enhancement 1020
Adds AMF B.01.01 support - still needs alot of work

------------------------------------------------------------------------
r878 | sdake | 2006-01-02 21:10:17 -0700 (Mon, 02 Jan 2006) | 6 lines

enhancement 1019
Modify YKD to select primary component and execute the synchronization
operation only in the main partition.  In the non-primary partition, no
new requests are allowed - they are all returned with the error code
SA_AIS_ERR_TRY_AGAIN.

------------------------------------------------------------------------
r876 | sdake | 2006-01-01 23:49:37 -0700 (Sun, 01 Jan 2006) | 3 lines

defect 1006
on 64 bit platforms, the timer is not properly cleared resulting in segfaults

------------------------------------------------------------------------
r874 | sdake | 2006-01-01 23:44:44 -0700 (Sun, 01 Jan 2006) | 3 lines

enhancement 1007
need way to install openais into user selectable directories

------------------------------------------------------------------------
r873 | sdake | 2006-01-01 23:40:29 -0700 (Sun, 01 Jan 2006) | 3 lines

enhancement 1018
Add YKD dynamic voting algorithm to executive code

------------------------------------------------------------------------
r870 | sdake | 2005-12-27 11:38:43 -0700 (Tue, 27 Dec 2005) | 3 lines

defect 999
clm library doesn't exit from poll when executive crashes

------------------------------------------------------------------------
r869 | sdake | 2005-12-27 11:36:38 -0700 (Tue, 27 Dec 2005) | 3 lines

enhancement 989
improve process group membership interface in totem_pg

------------------------------------------------------------------------
r868 | sdake | 2005-12-22 13:12:50 -0700 (Thu, 22 Dec 2005) | 4 lines

lock service locks up under certain conditions this patch fixes that problem
from Mark


------------------------------------------------------------------------
r866 | sdake | 2005-12-20 12:01:30 -0700 (Tue, 20 Dec 2005) | 3 lines

defect 993
ckpt-rd.c and ckpt-wr.c in the test directory don't run with the latest code.

------------------------------------------------------------------------
r864 | sdake | 2005-12-20 11:48:35 -0700 (Tue, 20 Dec 2005) | 3 lines

defect 998
Sometimes the default section isn't synchronized

------------------------------------------------------------------------
r862 | sdake | 2005-12-08 11:27:57 -0700 (Thu, 08 Dec 2005) | 3 lines

defect 982
Fixes ckpt list corruption on failure to allocate checkpoint replica

------------------------------------------------------------------------
r860 | sdake | 2005-12-06 11:42:29 -0700 (Tue, 06 Dec 2005) | 4 lines

defect 988
The totem SRP handle is passed up the entire stack is not needed past certain
functions.

------------------------------------------------------------------------
r859 | sdake | 2005-12-05 15:01:22 -0700 (Mon, 05 Dec 2005) | 6 lines

fix documentation error from specification which identifies
SaLckResourceLockAsync as the function name in some places but
saLckResourceLockAsync in other places.  We settled on saLck since it matches
the rest of the specifications.


------------------------------------------------------------------------
r858 | sdake | 2005-11-30 16:36:00 -0700 (Wed, 30 Nov 2005) | 4 lines

shared object name incorrectly set for the lock service to libSaLCK instead of
libSaLck.


------------------------------------------------------------------------
r857 | sdake | 2005-11-30 16:01:00 -0700 (Wed, 30 Nov 2005) | 5 lines

fix documentation error from specification which identifies
SaLckResourceLockAsync as the function name in some places but
saLckResourceLockAsync in other places.  We settled on saLck since it matches
the rest of the specifications.

------------------------------------------------------------------------
r856 | sdake | 2005-11-30 12:44:40 -0700 (Wed, 30 Nov 2005) | 3 lines

defect 979
This enhancement adds support for IPV6 to the trunk of openais.

------------------------------------------------------------------------
r854 | sdake | 2005-11-30 12:41:28 -0700 (Wed, 30 Nov 2005) | 3 lines

Fix defect 974
There was an infinite loop problem in the fix for defect 974

------------------------------------------------------------------------
r852 | sdake | 2005-11-25 15:01:00 -0700 (Fri, 25 Nov 2005) | 4 lines

defect 932
This patch adds token sequence number and global sequence number rollover
support.  A window is used to ensure comparisons are done properly.

------------------------------------------------------------------------
r850 | sdake | 2005-11-23 15:29:59 -0700 (Wed, 23 Nov 2005) | 4 lines

defect 974
checkpoint service segfaults during synchronization because iteration item
is deleted and iteration continues in unsafe fashion.

------------------------------------------------------------------------
r848 | sdake | 2005-11-23 15:25:04 -0700 (Wed, 23 Nov 2005) | 4 lines

defect 969
processor_count_set is called in the wrong place causing the protocol to
fail to receive.

------------------------------------------------------------------------
r846 | sdake | 2005-11-23 15:13:02 -0700 (Wed, 23 Nov 2005) | 3 lines

defect 968
Heartbeat failure detection man page updates

------------------------------------------------------------------------
r844 | markh | 2005-11-22 14:20:35 -0700 (Tue, 22 Nov 2005) | 4 lines

Fix for Bug 875.  
Cleans up a channel that actually opened but
the library request timed out.

------------------------------------------------------------------------
r842 | sdake | 2005-11-18 14:44:40 -0700 (Fri, 18 Nov 2005) | 3 lines

defect 965
Fix synchronization service lockup if the new_message_queue is full

------------------------------------------------------------------------
r839 | sdake | 2005-11-18 14:38:31 -0700 (Fri, 18 Nov 2005) | 4 lines

defect 956
fix assertion where new_message_queue is overflowed when a message is pending
in the fragmentation queue.

------------------------------------------------------------------------
r837 | markh | 2005-11-18 14:31:01 -0700 (Fri, 18 Nov 2005) | 5 lines

Fix for BUG 955.
The base event ID needed to be set to one.  event zero was being detected
as already delivered and thrown away.


------------------------------------------------------------------------
r836 | sdake | 2005-11-18 14:29:11 -0700 (Fri, 18 Nov 2005) | 3 lines

defect 968
Improve worst-case failure detection time using active healthchecking

------------------------------------------------------------------------
r834 | sdake | 2005-10-26 17:53:36 -0700 (Wed, 26 Oct 2005) | 3 lines

defect 914
fix gcc 4 specific compile warnings and compile errors

------------------------------------------------------------------------
r832 | sdake | 2005-10-03 17:10:11 -0700 (Mon, 03 Oct 2005) | 4 lines

defect 909
c++ keywords are used in the internal implementation of list.h


------------------------------------------------------------------------
r830 | markh | 2005-09-29 07:38:18 -0700 (Thu, 29 Sep 2005) | 3 lines

Fix compiler warnings when HZ is defined to be a long.
Bugzilla #904

------------------------------------------------------------------------
r829 | sdake | 2005-09-28 20:38:59 -0700 (Wed, 28 Sep 2005) | 3 lines

defect 903
First cut at a distributed locking service.

------------------------------------------------------------------------
r827 | sdake | 2005-09-26 14:31:25 -0700 (Mon, 26 Sep 2005) | 4 lines

defect 898
don't need to copy message to fragmentation data buffer if message can be
multicasted as is.

------------------------------------------------------------------------
r825 | sdake | 2005-09-26 14:27:57 -0700 (Mon, 26 Sep 2005) | 3 lines

defect 897
fix new_message_queue can be overwritten

------------------------------------------------------------------------
r822 | sdake | 2005-09-22 12:51:48 -0700 (Thu, 22 Sep 2005) | 3 lines

defect 896
Ruppert reported there was a missing typecast

------------------------------------------------------------------------
r821 | sdake | 2005-09-22 12:51:12 -0700 (Thu, 22 Sep 2005) | 4 lines

defect 895
Ruppert reported that there is code that doesn't do anything but should.


------------------------------------------------------------------------
r818 | sdake | 2005-09-20 16:05:55 -0700 (Tue, 20 Sep 2005) | 2 lines

reduce maximum message size since 253000 is beyond the max.

------------------------------------------------------------------------
r816 | sdake | 2005-09-20 15:42:32 -0700 (Tue, 20 Sep 2005) | 2 lines

remove extraneous debug printf

------------------------------------------------------------------------
r814 | sdake | 2005-09-20 11:34:15 -0700 (Tue, 20 Sep 2005) | 5 lines

defect 892
Fix performance degradation when sending 10-15 messages per second because
of a large seqno_unchanged_const.  Also, seqno_unchanged_const does not have
a configurable option and this patch adds that support.

------------------------------------------------------------------------
r812 | sdake | 2005-09-06 14:54:49 -0700 (Tue, 06 Sep 2005) | 2 lines

defect 856 - CHANGES and CHANGES_ONLY have identical effect with saClmClusterTrack()

------------------------------------------------------------------------
r811 | sdake | 2005-09-06 14:51:46 -0700 (Tue, 06 Sep 2005) | 2 lines

defect 855 - implement view numbers and report them correctly as per specs

------------------------------------------------------------------------
r810 | sdake | 2005-09-06 14:50:24 -0700 (Tue, 06 Sep 2005) | 2 lines

defect 854 - invalid return value displayed in test program

------------------------------------------------------------------------
r809 | sdake | 2005-08-30 13:29:13 -0700 (Tue, 30 Aug 2005) | 5 lines

defect 841
Rabbe reported that cluster track callback operations dont work properly.
This patch fixes that problem.


------------------------------------------------------------------------
r808 | sdake | 2005-08-29 12:55:34 -0700 (Mon, 29 Aug 2005) | 6 lines

defect 839
The timer interval can be set to less then the platform timing interval.  This
could result in negative timer values configured by the user which confuse
the totem protocol.


------------------------------------------------------------------------
r807 | sdake | 2005-08-29 12:50:53 -0700 (Mon, 29 Aug 2005) | 5 lines

defect 828
assert in totemsrp_avail occurs with certain test cases.  The code was rounding
down to zero when calculating the number of messages required.  This patch adds
one in all cases so no roundoff occurs.

------------------------------------------------------------------------
r806 | sdake | 2005-08-29 12:47:01 -0700 (Mon, 29 Aug 2005) | 5 lines

defect 840
J Seltzer reported that closed checkpoints in the TRY_AGAIN state are not
closed in the executive but are closed in the library.  This patch fixes
that problem.

------------------------------------------------------------------------
r805 | sdake | 2005-08-25 15:10:26 -0700 (Thu, 25 Aug 2005) | 4 lines

defect 837
Muni reported the token retransmission timer doesn't need to be reset when 
receiving a retransmission

------------------------------------------------------------------------
r804 | sdake | 2005-08-25 15:09:03 -0700 (Thu, 25 Aug 2005) | 3 lines

defect 833
Rabbe reported that the encoding of the ipv4 address in SaClmNodeAddressT is incorrect

------------------------------------------------------------------------
r803 | sdake | 2005-08-25 15:07:53 -0700 (Thu, 25 Aug 2005) | 3 lines

defect 824:
replace network directive with totem directive in default configuration file

------------------------------------------------------------------------
r802 | sdake | 2005-08-25 15:06:49 -0700 (Thu, 25 Aug 2005) | 3 lines

defect 823
Typo in openias conf manpage reported by Rabbe

------------------------------------------------------------------------
r800 | markh | 2005-08-19 12:40:56 -0700 (Fri, 19 Aug 2005) | 5 lines

Fix for bug 825.
SaEvtChannelClose needed to handle SA_AIS_ERR_TRY_AGAIN so that the
eci_closing would be cleared before returning.


------------------------------------------------------------------------
r799 | sdake | 2005-08-18 12:53:20 -0700 (Thu, 18 Aug 2005) | 3 lines

This sets the receive and send transmission buffers to a larger size to avoid overruns
of the multicast buffer.

------------------------------------------------------------------------
r798 | sdake | 2005-08-18 12:23:32 -0700 (Thu, 18 Aug 2005) | 2 lines

This fixes an off by one in queue_avail which resulted in an assertion during testing.

------------------------------------------------------------------------
r797 | sdake | 2005-08-17 12:37:24 -0700 (Wed, 17 Aug 2005) | 3 lines

defect 501
this patch fixes short reads and writes between the library and executive

------------------------------------------------------------------------
r796 | sdake | 2005-08-17 12:27:25 -0700 (Wed, 17 Aug 2005) | 3 lines

enhancement 813
Rename ais_types.h header file to be more compliant with sa forum

------------------------------------------------------------------------
r795 | sdake | 2005-08-17 12:21:16 -0700 (Wed, 17 Aug 2005) | 4 lines

defect 822
checkpoint synchronization has serious bug after saftest fixups


------------------------------------------------------------------------
r794 | sdake | 2005-08-17 12:17:45 -0700 (Wed, 17 Aug 2005) | 13 lines

enhancmement 821
Global reorganization of totem code and also many feature enhancments
These include:
need to specify whether authentication is enabled or dislabed in config file
need to specify frame size in config file
need redundant ring placeholder
need to specify version field of totem
need to support large frame sizes
need to break out threading code from totemsrp
need to break out network code from totemsrp
need to break out parser code from parse.c
and some others

------------------------------------------------------------------------
r793 | sdake | 2005-08-12 15:29:35 -0700 (Fri, 12 Aug 2005) | 3 lines

Patch from Russell Bryant to fix up gcc 4 warnings


------------------------------------------------------------------------
r792 | markh | 2005-08-11 12:22:50 -0700 (Thu, 11 Aug 2005) | 7 lines

The current event service code will start rejecting received events
after 4gig because it thinks that they are duplicates.  
This update fixes that problem.  Now I am keeping a full 64 bit id for
checking for duplicate/re-sends, etc.  separate from the event ID.  I
also check that a new event ID is not in use by a retained event.


------------------------------------------------------------------------
r791 | markh | 2005-08-05 11:34:53 -0700 (Fri, 05 Aug 2005) | 4 lines

Add a check field to the handle structure to make it less
likely to get a random valid handle.
Fix a couple bugs in the event service that this change exposed.

------------------------------------------------------------------------
r790 | markh | 2005-08-02 14:35:34 -0700 (Tue, 02 Aug 2005) | 4 lines

Fix for BUG 803.  We need to complete a library call even if the
channel requested for unlink has been deleted previous to processing
an unlink request.

------------------------------------------------------------------------
r789 | sdake | 2005-07-29 15:19:50 -0700 (Fri, 29 Jul 2005) | 2 lines

fixes segfault when ctrl-c pressed with new totemmrp code

------------------------------------------------------------------------
r788 | sdake | 2005-07-29 14:37:21 -0700 (Fri, 29 Jul 2005) | 2 lines

fixes a missed merge in the totemmrp mergeup

------------------------------------------------------------------------
r787 | sdake | 2005-07-29 14:21:43 -0700 (Fri, 29 Jul 2005) | 2 lines

Fix a few compile warnings.

------------------------------------------------------------------------
r786 | sdake | 2005-07-29 14:18:45 -0700 (Fri, 29 Jul 2005) | 3 lines

defect 796
fix saClmClusterTrack to operate according to specs.

------------------------------------------------------------------------
r785 | sdake | 2005-07-29 14:17:49 -0700 (Fri, 29 Jul 2005) | 3 lines

defect 793
dont return SA_AIS_ERR_NOT_EXIST when tracking started with SA_TRACK_CURRENT only

------------------------------------------------------------------------
r784 | sdake | 2005-07-29 14:17:12 -0700 (Fri, 29 Jul 2005) | 3 lines

defect 792
saClmTrackStop not returning SA_AIS_ERR_NOT_EXIST

------------------------------------------------------------------------
r783 | sdake | 2005-07-29 14:15:14 -0700 (Fri, 29 Jul 2005) | 3 lines

defect 790
if sectionDescriptor is null in iteration next call, segfault occurs

------------------------------------------------------------------------
r782 | sdake | 2005-07-29 13:55:25 -0700 (Fri, 29 Jul 2005) | 4 lines

Add infrastructure support for multiring to totem library
Make totemsrp support multiple instances of a running protocol within one app.
Rename libtotem to libtotem_pg because of a name conflict with some movie player

------------------------------------------------------------------------
r781 | markh | 2005-07-27 13:22:04 -0700 (Wed, 27 Jul 2005) | 4 lines

Move the check of subscription ID in lib_evt_event_subscribe before 
processing the filters.


------------------------------------------------------------------------
r780 | markh | 2005-07-27 13:19:39 -0700 (Wed, 27 Jul 2005) | 4 lines

Fix for bug 776.  Don't require retained events to expire 
before deleting the channel on unlink.


------------------------------------------------------------------------
r779 | sdake | 2005-07-27 13:07:35 -0700 (Wed, 27 Jul 2005) | 3 lines

defect 784
readSize is not properly set after return from checkpoint read operation.

------------------------------------------------------------------------
r778 | sdake | 2005-07-27 13:06:35 -0700 (Wed, 27 Jul 2005) | 3 lines

defect 785
ckptbenchth is completely broken.  This patch fixes it to operate properly.

------------------------------------------------------------------------
r777 | sdake | 2005-07-27 13:05:34 -0700 (Wed, 27 Jul 2005) | 4 lines

defect 788
ckptbench returns error 7 at 20000 byte size writes.  The benchmark program
improperly creates the checkpoint parameters.

------------------------------------------------------------------------
r776 | markh | 2005-07-26 15:48:31 -0700 (Tue, 26 Jul 2005) | 4 lines

Fix for bug 773.  Not quite the full fix, but the best we can do
for now.


------------------------------------------------------------------------
r775 | markh | 2005-07-26 15:47:27 -0700 (Tue, 26 Jul 2005) | 3 lines

Fix for bug 774.  Check malloc return before accessing pointer.


------------------------------------------------------------------------
r774 | markh | 2005-07-26 15:45:56 -0700 (Tue, 26 Jul 2005) | 3 lines

Fix for bug 782.  Receved events may not be modified.


------------------------------------------------------------------------
r773 | sdake | 2005-07-26 12:43:31 -0700 (Tue, 26 Jul 2005) | 3 lines

defect 777
fix reference counting bugs in aispoll

------------------------------------------------------------------------
r772 | markh | 2005-07-25 10:43:25 -0700 (Mon, 25 Jul 2005) | 3 lines

Update saEvtEventPublist to return the correct error code
when the event data size in too big.  Bug 768.

------------------------------------------------------------------------
r771 | sdake | 2005-07-15 10:06:12 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 754
tests dont build because makefile damaged

------------------------------------------------------------------------
r770 | sdake | 2005-07-15 10:00:27 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 752
fix reference counting in checkpoint library

------------------------------------------------------------------------
r769 | sdake | 2005-07-15 09:59:53 -0700 (Fri, 15 Jul 2005) | 4 lines

defect 751
when ckptSectionIterationNext iterates all sections, SA_AIS_ERR_NO_SECTIONS
not being returned.

------------------------------------------------------------------------
r768 | sdake | 2005-07-15 09:59:13 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 750
in saCkptIterationFinalize if no active replica set, return error

------------------------------------------------------------------------
r767 | sdake | 2005-07-15 09:58:42 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 749
Make handle put work properly for IterationFinalize

------------------------------------------------------------------------
r766 | sdake | 2005-07-15 09:58:02 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 748
rename sectioniterator to sectioniteration in executive and library

------------------------------------------------------------------------
r765 | sdake | 2005-07-15 09:57:23 -0700 (Fri, 15 Jul 2005) | 4 lines

defecct 747
in saCkptSectionIterationInitialize if sectionsChosen invalid,
return INVALID_PARAM

------------------------------------------------------------------------
r764 | sdake | 2005-07-15 09:56:43 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 746
return INVALID_PARAM in saCkptSectionIterationInitialize if address is NULL

------------------------------------------------------------------------
r763 | sdake | 2005-07-15 09:56:09 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 745
in saCkptSectionCreate if initialData == NULL return INVALID_PARAM

------------------------------------------------------------------------
r762 | sdake | 2005-07-15 09:54:37 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 744
return SA_AIS_ERR_EXIST in saCkptSectionCreate if maxSections == 1

------------------------------------------------------------------------
r761 | sdake | 2005-07-15 09:53:55 -0700 (Fri, 15 Jul 2005) | 4 lines

defect 743
in saCkptCheckpointSectionCreate return SA_AIS_ERR_NO_SPACE if
current sections == maxSections

------------------------------------------------------------------------
r760 | sdake | 2005-07-15 09:52:55 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 742
error not returned in saCkptSectionCreate if sectionCreationAttributes == NULL

------------------------------------------------------------------------
r759 | sdake | 2005-07-15 09:52:15 -0700 (Fri, 15 Jul 2005) | 4 lines

defect 741
saCkptCheckpointOpenAsync doesn't return error when
checkpointSize > maxSections * maxSectionsSize

------------------------------------------------------------------------
r758 | sdake | 2005-07-15 09:51:37 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 740
if open callback isn't set on saCkptCheckpointOpenAsync, return SA_AIS_ERR_INIT

------------------------------------------------------------------------
r757 | sdake | 2005-07-15 09:50:34 -0700 (Fri, 15 Jul 2005) | 3 lines

defect 739
saCkptCheckpointOpenAsync callback doesn't return error as per spec

------------------------------------------------------------------------
r756 | sdake | 2005-07-13 13:13:25 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 718
if no active replica is not set do not set expiration time and return error.

------------------------------------------------------------------------
r755 | sdake | 2005-07-13 13:12:49 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 717
if checkpoint is not writeable in durationset, return error

------------------------------------------------------------------------
r754 | sdake | 2005-07-13 13:12:23 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 716
in durationtimeset if sectionId is null, return error

------------------------------------------------------------------------
r753 | sdake | 2005-07-13 13:11:57 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 715
synchronize open missing break in dispatch causing checkpointsyncasync callback
not to be called.

------------------------------------------------------------------------
r752 | sdake | 2005-07-13 13:11:22 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 714
if checkpoint doesn't have write permissions in section delete, return error

------------------------------------------------------------------------
r751 | sdake | 2005-07-13 13:10:56 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 713
if active replica not set in section delete, return error

------------------------------------------------------------------------
r750 | sdake | 2005-07-13 13:10:32 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 712
if sectionId is null in sectiondelete, return INVALID_PARAM

------------------------------------------------------------------------
r749 | sdake | 2005-07-13 13:10:02 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 711
if no active replica set in checkpoint write, error not returned

------------------------------------------------------------------------
r748 | sdake | 2005-07-13 13:09:39 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 710
if ioVector == NULL in checkpoint read error should be returned

------------------------------------------------------------------------
r747 | sdake | 2005-07-13 13:09:11 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 709
if synchronize async called, but no callback set, error not returned

------------------------------------------------------------------------
r746 | sdake | 2005-07-13 13:08:39 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 708
checkpoint synchronize async call not implemented

------------------------------------------------------------------------
r745 | sdake | 2005-07-13 13:08:13 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 707
if checkpoint synchronize executedd with timeout=0, TIMEOUT error not returned

------------------------------------------------------------------------
r744 | sdake | 2005-07-13 13:07:45 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 706
replica is not set based upon open flags as per specification

------------------------------------------------------------------------
r743 | sdake | 2005-07-13 13:07:20 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 705
if synchronize executed on a checkpoint that was created WR_ALL_REPLICAS return
error.

------------------------------------------------------------------------
r742 | sdake | 2005-07-13 13:06:48 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 704
if checkpoint is opened without read permissions, checkpoint synchronize
should return SA_AIS_ERR_ACCESS.

------------------------------------------------------------------------
r741 | sdake | 2005-07-13 13:06:04 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 703
checkpoint synchronize calls do not check if active replica set

------------------------------------------------------------------------
r740 | sdake | 2005-07-13 13:05:42 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 702
checkpoint synchronize missing executive handler

------------------------------------------------------------------------
r739 | sdake | 2005-07-13 13:05:15 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 684
return INVALID_PARAM in checkpoint read if dataSize greater then
maxSections * maxsectionsSize.

------------------------------------------------------------------------
r738 | sdake | 2005-07-13 13:04:21 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 683
if active replica not set, checkpointread should return SA_AIS_ERR_NOT_EXIST

------------------------------------------------------------------------
r737 | sdake | 2005-07-13 13:03:41 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 682
null iovector caues checkpointRead to segfault


------------------------------------------------------------------------
r736 | sdake | 2005-07-13 13:03:15 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 681
if null paramter passed to checkpoint service as iovector element, allocate
the io vector element

------------------------------------------------------------------------
r735 | sdake | 2005-07-13 13:02:20 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 680
ckptsectionoverwrite should return INVALID if dataSize greater then
maxSections * maxSectionsSize

------------------------------------------------------------------------
r734 | sdake | 2005-07-13 13:01:29 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 677
SectionOverwrite with null sectionId segfaults

------------------------------------------------------------------------
r733 | sdake | 2005-07-13 13:00:58 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 676
sectionoverwrite doesn't return correct error when checkpoint section
doesn't exist

------------------------------------------------------------------------
r732 | sdake | 2005-07-13 13:00:15 -0700 (Wed, 13 Jul 2005) | 3 lines

defect 675
section overwrite with null dataBuffer parameter locks up

------------------------------------------------------------------------
r731 | sdake | 2005-07-13 12:57:48 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 734
cleanup include files and exports from libraries


------------------------------------------------------------------------
r730 | sdake | 2005-07-13 12:29:02 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 732
req_amf_componentregister used instead of req_lib_amf_componentregister.  There
is no definition for req_amf_componentregister.

------------------------------------------------------------------------
r729 | sdake | 2005-07-13 12:22:13 -0700 (Wed, 13 Jul 2005) | 4 lines

defect 731
error - saSendReceiveReply instead of error = function


------------------------------------------------------------------------
r728 | markh | 2005-07-07 13:26:01 -0700 (Thu, 07 Jul 2005) | 3 lines

Check for reserved event ID and return SA_AIS_ERR_INVALID_PARAM.
Bug 694

------------------------------------------------------------------------
r727 | markh | 2005-06-30 15:36:10 -0700 (Thu, 30 Jun 2005) | 4 lines

Wait to return status to the library until the clear request
was received over the network so that the publish and receipt of the
event is in sync with the time clear request.

------------------------------------------------------------------------
r726 | sdake | 2005-06-30 13:32:55 -0700 (Thu, 30 Jun 2005) | 3 lines

defect 673
fix checkpoint unlink not cleaning up checkpoints.

------------------------------------------------------------------------
r725 | sdake | 2005-06-30 13:29:33 -0700 (Thu, 30 Jun 2005) | 3 lines

defect 502
fix assert when packet added in multicast message handler.

------------------------------------------------------------------------
r724 | sdake | 2005-06-29 16:10:37 -0700 (Wed, 29 Jun 2005) | 3 lines

Remove some warnings from the compile.


------------------------------------------------------------------------
r723 | markh | 2005-06-29 15:14:51 -0700 (Wed, 29 Jun 2005) | 3 lines

Error comparing unsigned to less than zero.


------------------------------------------------------------------------
r722 | sdake | 2005-06-29 14:36:51 -0700 (Wed, 29 Jun 2005) | 4 lines

Enables test caes in saftest to pass by returning failure return codes in both
callback and return function.  This may have to change later if a later errata
changes this functionality.

------------------------------------------------------------------------
r721 | sdake | 2005-06-29 14:34:08 -0700 (Wed, 29 Jun 2005) | 3 lines

defect 669
token retransmits dont work under heavy load.

------------------------------------------------------------------------
r720 | sdake | 2005-06-29 14:33:26 -0700 (Wed, 29 Jun 2005) | 3 lines

defect 656
libraries not built with position independent code.  This causes x86_64 not to build.

------------------------------------------------------------------------
r719 | sdake | 2005-06-29 14:32:43 -0700 (Wed, 29 Jun 2005) | 3 lines

defect 655
invalid checkpoint open flags should return ERR_BAD_FLAGS

------------------------------------------------------------------------
r718 | sdake | 2005-06-29 14:32:08 -0700 (Wed, 29 Jun 2005) | 4 lines

defect 654
wrong error code returned when checkpointSize > maxSections * maxSectionsSize in
checkpoint open.

------------------------------------------------------------------------
r717 | sdake | 2005-06-29 14:31:28 -0700 (Wed, 29 Jun 2005) | 3 lines

defect 653
saCkptCheckpointOpen segfaults if null parameter passed in checkpointName

------------------------------------------------------------------------
r716 | sdake | 2005-06-29 14:30:35 -0700 (Wed, 29 Jun 2005) | 3 lines

defect 652
saCkptCheckpointOpen segfaults if null parameter passed to checkpointHandle

------------------------------------------------------------------------
r715 | sdake | 2005-06-29 14:29:37 -0700 (Wed, 29 Jun 2005) | 2 lines

defect 651 - saCkptCheckpointUnlink segfaults if checkpointName attribute is null

------------------------------------------------------------------------
r714 | sdake | 2005-06-29 14:28:06 -0700 (Wed, 29 Jun 2005) | 2 lines

defect 646 - wrong return code in checkpoint open

------------------------------------------------------------------------
r713 | sdake | 2005-06-28 12:01:25 -0700 (Tue, 28 Jun 2005) | 3 lines

Patch from Muni Bajpai to improve synchronization after a merge.


------------------------------------------------------------------------
r712 | markh | 2005-06-27 14:33:30 -0700 (Mon, 27 Jun 2005) | 3 lines

saEvtEventAttributesSet needs to check that the priority value passed in
is valid.

------------------------------------------------------------------------
r711 | sdake | 2005-06-27 13:26:21 -0700 (Mon, 27 Jun 2005) | 3 lines

Patch from Szakacsits Szabolcs to improve error detection in parsing
configuration files.

------------------------------------------------------------------------
r710 | markh | 2005-06-24 14:20:17 -0700 (Fri, 24 Jun 2005) | 6 lines

The channel open functions need to check for bad flags.

I set the newly created event elements to the default 
values in the B spec.


------------------------------------------------------------------------
r709 | markh | 2005-06-24 14:19:02 -0700 (Fri, 24 Jun 2005) | 4 lines

I discovered that our SaAisErrorT is incorrect.  I have included a patch
to fix that.  The SA_AIS_ERR_BAD_CHECKPOINT code doesn't exist.  I
replaced it with SA_AIS_ERR_BAD_OPERATION.

------------------------------------------------------------------------
r708 | markh | 2005-06-23 07:44:29 -0700 (Thu, 23 Jun 2005) | 4 lines

The A spec required patterns to be set but the B
spec doesn't.  Fix lib/evt.c and test/testevt.c


------------------------------------------------------------------------
r707 | markh | 2005-06-21 15:22:02 -0700 (Tue, 21 Jun 2005) | 4 lines


This fixes some B spec related parameter checks


------------------------------------------------------------------------
r706 | markh | 2005-06-21 15:19:03 -0700 (Tue, 21 Jun 2005) | 20 lines

Some fixes to the event service based on the saftest event
tests results.  

The changes may affect applications currently using the event service. 

1. Timeout value to the saEvtChannelOpen call was updated to use
SA_TIME_MAX instead of 0 for infinite timeout.

2. added cleanup in the library to remove associated events when a
channel is closed, and remove associated channels when finalize is
called.

3. Added some new checking args for NULL and returning the correct error
code.

4. fixed dispatch to return correct status with SA_DISPATCH_ONE and no
available poll data.

5. Makefile had bad dependency for evt library build.

------------------------------------------------------------------------
r705 | mvista.com!sdake | 2005-06-17 11:52:55 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 643
saClmNodeGet timeout parameter of 0 should return SA_AIS_ERR_TIMEOUT

(Logical change 1.224)

------------------------------------------------------------------------
r704 | mvista.com!sdake | 2005-06-17 11:52:55 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 643
  saClmNodeGet timeout parameter of 0 should return SA_AIS_ERR_TIMEOUT

BKrev: 42b31c07wymW-ntnqdOvHrTrCDEEhA

------------------------------------------------------------------------
r703 | mvista.com!sdake | 2005-06-17 11:52:08 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 642
fix segfault when null clusterNode parameter passed to saClusterNodeGet

(Logical change 1.223)

------------------------------------------------------------------------
r702 | mvista.com!sdake | 2005-06-17 11:52:08 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 642
  fix segfault when null clusterNode parameter passed to saClusterNodeGet

BKrev: 42b31bd8J6eYpNHnpFWwHWc3waURXw

------------------------------------------------------------------------
r701 | mvista.com!sdake | 2005-06-17 11:51:15 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 641
  NodeGetAsync called with no nodeget callback should return SA_AIS_ERR_INIT

BKrev: 42b31ba3yncxyr2C6XoRwB_9yMdvRA

------------------------------------------------------------------------
r700 | mvista.com!sdake | 2005-06-17 11:51:15 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 641
NodeGetAsync called with no nodeget callback should return SA_AIS_ERR_INIT

(Logical change 1.222)

------------------------------------------------------------------------
r699 | mvista.com!sdake | 2005-06-17 11:50:27 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 640
fix wrong error code when null version parameter passed to saClmInitialize

(Logical change 1.221)

------------------------------------------------------------------------
r698 | mvista.com!sdake | 2005-06-17 11:50:27 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 640
  fix wrong error code when null version parameter passed to saClmInitialize

BKrev: 42b31b73Cok4gPBc42AbPIksg9Rw2w

------------------------------------------------------------------------
r697 | mvista.com!sdake | 2005-06-17 11:49:33 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 639
  fix segfault if null callback parameter passed to saClmInitialize

BKrev: 42b31b3dnxjnqS8cEzAPHPJmbMdVEw

------------------------------------------------------------------------
r696 | mvista.com!sdake | 2005-06-17 11:49:33 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 639
fix segfault if null callback parameter passed to saClmInitialize

(Logical change 1.220)

------------------------------------------------------------------------
r695 | mvista.com!sdake | 2005-06-17 11:48:50 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 638
fix segfault if clmHandle is null to saClmInitialize

(Logical change 1.219)

------------------------------------------------------------------------
r694 | mvista.com!sdake | 2005-06-17 11:48:50 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 638
  fix segfault if clmHandle is null to saClmInitialize

BKrev: 42b31b12gslEYBvbGYQJgGi6uFw8hg

------------------------------------------------------------------------
r693 | mvista.com!sdake | 2005-06-17 11:47:46 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 637
  Fix saClmFinalize will block with threads

BKrev: 42b31ad2mqut41t3GjnF-5BmQYDkOA

------------------------------------------------------------------------
r692 | mvista.com!sdake | 2005-06-17 11:47:46 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 637
Fix saClmFinalize will block with threads

(Logical change 1.218)

------------------------------------------------------------------------
r691 | mvista.com!sdake | 2005-06-17 11:47:03 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 636
fix saClmDispatch blocks on invalid dispatch flags

(Logical change 1.217)

------------------------------------------------------------------------
r690 | mvista.com!sdake | 2005-06-17 11:47:03 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 636
  fix saClmDispatch blocks on invalid dispatch flags

BKrev: 42b31aa7DNo7fwD1STjEtZQflKEaCw

------------------------------------------------------------------------
r689 | mvista.com!sdake | 2005-06-17 11:46:22 -0700 (Fri, 17 Jun 2005) | 6 lines

clm.c:
  defect 635
  saClmSelectionObjectGet crashes if selection object pointer is null

BKrev: 42b31a7e1tftUaCVpz36dDVxSI0wBA

------------------------------------------------------------------------
r688 | mvista.com!sdake | 2005-06-17 11:46:22 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 635
saClmSelectionObjectGet crashes if selection object pointer is null

(Logical change 1.216)

------------------------------------------------------------------------
r687 | mvista.com!sdake | 2005-06-17 11:45:25 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 634
saCkptDispatch blocks if invalid dispatch flag is set

(Logical change 1.215)

------------------------------------------------------------------------
r686 | mvista.com!sdake | 2005-06-17 11:45:25 -0700 (Fri, 17 Jun 2005) | 6 lines

ckpt.c:
  defect 634
  saCkptDispatch blocks if invalid dispatch flag is set

BKrev: 42b31a459dDwB00enI3nSeayQwFODA

------------------------------------------------------------------------
r685 | mvista.com!sdake | 2005-06-17 11:44:41 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 633
saCkptInitialize crashes if callbacks parameter is null

(Logical change 1.214)

------------------------------------------------------------------------
r684 | mvista.com!sdake | 2005-06-17 11:44:41 -0700 (Fri, 17 Jun 2005) | 6 lines

ckpt.c:
  defect 633
  saCkptInitialize crashes if callbacks parameter is null

BKrev: 42b31a19Ti58H5PxsI2NaDivhyz-fQ

------------------------------------------------------------------------
r683 | mvista.com!sdake | 2005-06-17 11:43:52 -0700 (Fri, 17 Jun 2005) | 5 lines

ckpt.c:
  Fix segfault when address of checkpoint handle is null to the initialize function

BKrev: 42b319e8cJKg9zY0XT9um2oqVst5Ug

------------------------------------------------------------------------
r682 | mvista.com!sdake | 2005-06-17 11:43:52 -0700 (Fri, 17 Jun 2005) | 4 lines

Fix segfault when address of checkpoint handle is null to the initialize function

(Logical change 1.213)

------------------------------------------------------------------------
r681 | mvista.com!sdake | 2005-06-17 11:42:52 -0700 (Fri, 17 Jun 2005) | 7 lines

ckpt.c:
  defect 631
  Fix segfault if null pointer passed to selection object address of
  saCkptSelectionObjectGet

BKrev: 42b319acUTulJHw99ALuUlMGTcgL1g

------------------------------------------------------------------------
r680 | mvista.com!sdake | 2005-06-17 11:42:52 -0700 (Fri, 17 Jun 2005) | 6 lines

defect 631
Fix segfault if null pointer passed to selection object address of
saCkptSelectionObjectGet

(Logical change 1.212)

------------------------------------------------------------------------
r679 | mvista.com!sdake | 2005-06-17 11:41:54 -0700 (Fri, 17 Jun 2005) | 7 lines

ckpt.c:
  defect 630
  if a checkpoint is unlinked then opened it should return
  SA_AIS_ERR_NOT_EXIST

BKrev: 42b31972GC0d7zd0Xw4yt4RcQrxcCg

------------------------------------------------------------------------
r678 | mvista.com!sdake | 2005-06-17 11:41:54 -0700 (Fri, 17 Jun 2005) | 6 lines

defect 630
if a checkpoint is unlinked then opened it should return
SA_AIS_ERR_NOT_EXIST

(Logical change 1.211)

------------------------------------------------------------------------
r677 | mvista.com!sdake | 2005-06-17 11:40:45 -0700 (Fri, 17 Jun 2005) | 6 lines

ckpt.c:
  defect 629
  Return error if checkpoint has been unlinked on retentation duration set

BKrev: 42b3192dcHnUOXNAKirryjp4WHDl9g

------------------------------------------------------------------------
r676 | mvista.com!sdake | 2005-06-17 11:40:45 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 629
Return error if checkpoint has been unlinked on retentation duration set

(Logical change 1.210)

------------------------------------------------------------------------
r675 | mvista.com!sdake | 2005-06-17 11:39:51 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 628
saCkptCheckpointStatusGet test case 13 from saftest fails

(Logical change 1.209)

------------------------------------------------------------------------
r674 | mvista.com!sdake | 2005-06-17 11:39:51 -0700 (Fri, 17 Jun 2005) | 6 lines

ckpt.c, ckpt.h:
  defect 628
  saCkptCheckpointStatusGet test case 13 from saftest fails

BKrev: 42b318f7gBulPAY6sscL0tMMMi9jMw

------------------------------------------------------------------------
r673 | mvista.com!sdake | 2005-06-17 11:38:53 -0700 (Fri, 17 Jun 2005) | 6 lines

Makefile, ckpt.c:
  defect 627
  Fix API crash when second parameter of saCkptCheckpointStatusGet is null

BKrev: 42b318bd2NjZ6GGEcjf0mUQr9yL1EA

------------------------------------------------------------------------
r672 | mvista.com!sdake | 2005-06-17 11:38:53 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 627
Fix API crash when second parameter of saCkptCheckpointStatusGet is null

(Logical change 1.208)

------------------------------------------------------------------------
r671 | mvista.com!sdake | 2005-06-17 11:36:36 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 611
add some manual pages to openais

(Logical change 1.207)

------------------------------------------------------------------------
r670 | mvista.com!sdake | 2005-06-17 11:36:36 -0700 (Fri, 17 Jun 2005) | 5 lines

defect 577
Implement token holding mode

(Logical change 1.207)

------------------------------------------------------------------------
r669 | mvista.com!sdake | 2005-06-17 11:36:36 -0700 (Fri, 17 Jun 2005) | 11 lines

Makefile, index.html:
  defect 611
  add some manual pages to openais
openais_overview.8, openais.conf.5:
  new file
Many files:
  defect 577
  Implement token holding mode

BKrev: 42b31834M2cICKgskYf4EnywBr9Fiw

------------------------------------------------------------------------
r668 | mvista.com!sdake | 2005-06-17 11:36:36 -0700 (Fri, 17 Jun 2005) | 2 lines

(Logical change 1.207)

------------------------------------------------------------------------
r667 | mvista.com!sdake | 2005-06-17 11:36:35 -0700 (Fri, 17 Jun 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r666 | osdl.net!markh | 2005-06-15 14:09:42 -0700 (Wed, 15 Jun 2005) | 9 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_work

2005/06/15 14:09:09-07:00 osdl.net!markh
Fix version handling code to be B spec compliant.
BUG 623.

BKrev: 42b09916lexB-dFgQMudnN6k_mmmkw

------------------------------------------------------------------------
r665 | osdl.net!markh | 2005-06-15 14:09:42 -0700 (Wed, 15 Jun 2005) | 5 lines

Fix version handling code to be B spec compliant.
BUG 623.

(Logical change 1.206)

------------------------------------------------------------------------
r664 | osdl.net!markh | 2005-06-15 14:09:42 -0700 (Wed, 15 Jun 2005) | 8 lines

Auto merged

2005/06/15 14:09:08-07:00 osdl.net!markh
Fix version handling code to be B spec compliant.
BUG 623.

(Logical change 1.206)

------------------------------------------------------------------------
r663 | osdl.net!markh | 2005-06-15 14:04:28 -0700 (Wed, 15 Jun 2005) | 6 lines

Move the closing of file descriptors from the destructor to
the finalize function.  This allows threads waiting on poll to
wake up and release handle references.

BKrev: 42b097dceYknwQw6iUHoWmtoiZRCAQ

------------------------------------------------------------------------
r662 | osdl.net!markh | 2005-06-15 14:04:28 -0700 (Wed, 15 Jun 2005) | 6 lines

Move the closing of file descriptors from the destructor to
the finalize function.  This allows threads waiting on poll to
wake up and release handle references.

(Logical change 1.205)

------------------------------------------------------------------------
r661 | osdl.net!markh | 2005-06-13 13:07:55 -0700 (Mon, 13 Jun 2005) | 4 lines

Fixes to patterns and filters for B API spec support.

(Logical change 1.204)

------------------------------------------------------------------------
r660 | osdl.net!markh | 2005-06-13 13:07:55 -0700 (Mon, 13 Jun 2005) | 4 lines

Fixes to patterns and filters for B API spec support.

BKrev: 42ade79b0MPjVuydg8XjvOCQs9MTkw

------------------------------------------------------------------------
r659 | mvista.com!sdake | 2005-06-07 14:23:48 -0700 (Tue, 07 Jun 2005) | 6 lines

totempg.c:
  defect 604
  report fragmentation messages missing.

BKrev: 42a61064-RatmX2Oh0W-yAQkVrhuLA

------------------------------------------------------------------------
r658 | mvista.com!sdake | 2005-06-07 14:23:48 -0700 (Tue, 07 Jun 2005) | 5 lines

defect 604
report fragmentation messages missing.

(Logical change 1.203)

------------------------------------------------------------------------
r657 | mvista.com!sdake | 2005-06-06 13:35:05 -0700 (Mon, 06 Jun 2005) | 6 lines

defect 600
Qian Zhang reported defect 599 which was a missing
pthread_mutex_unlock.  Patch attached to fix it.

(Logical change 1.202)

------------------------------------------------------------------------
r656 | mvista.com!sdake | 2005-06-06 13:35:05 -0700 (Mon, 06 Jun 2005) | 2 lines

(Logical change 1.202)

------------------------------------------------------------------------
r655 | mvista.com!sdake | 2005-06-06 13:35:05 -0700 (Mon, 06 Jun 2005) | 7 lines

clm.c:
  defect 600
  Qian Zhang reported defect 599 which was a missing
  pthread_mutex_unlock.  Patch attached to fix it.

BKrev: 42a4b379jtJP5rnRmyVL92o1PyIDDw

------------------------------------------------------------------------
r654 | mvista.com!sdake | 2005-06-06 13:33:59 -0700 (Mon, 06 Jun 2005) | 7 lines

clm.c:
  defect 599
  Qian Zhang reported defect 599 which was a missing
  pthread_mutex_unlock.  Patch attached to fix it.

BKrev: 42a4b337flt6FdzG6hqwbxOqSyl59w

------------------------------------------------------------------------
r653 | mvista.com!sdake | 2005-06-06 13:33:59 -0700 (Mon, 06 Jun 2005) | 6 lines

defect 599
Qian Zhang reported defect 599 which was a missing
pthread_mutex_unlock.  Patch attached to fix it.

(Logical change 1.201)

------------------------------------------------------------------------
r652 | mvista.com!sdake | 2005-06-06 13:19:36 -0700 (Mon, 06 Jun 2005) | 8 lines

ipc_ckpt.h, testckpt.c, ckptbench.c, util.c, ckpt.c:
  defect 595
  There are various bugs with saCkptCheckpointOpenAsync that result in it
  crashing the executive, library, or just failing the saftest conformance
  suite.

BKrev: 42a4afd8Fg5CFXDzyZ_v5qo_ad-Guw

------------------------------------------------------------------------
r651 | mvista.com!sdake | 2005-06-06 13:19:36 -0700 (Mon, 06 Jun 2005) | 7 lines

defect 595
There are various bugs with saCkptCheckpointOpenAsync that result in it
crashing the executive, library, or just failing the saftest conformance
suite..

(Logical change 1.200)

------------------------------------------------------------------------
r650 | mvista.com!sdake | 2005-06-06 13:19:36 -0700 (Mon, 06 Jun 2005) | 7 lines

defect 595
There are various bugs with saCkptCheckpointOpenAsync that result in it
crashing the executive, library, or just failing the saftest conformance
suite.

(Logical change 1.200)

------------------------------------------------------------------------
r649 | mvista.com!sdake | 2005-06-06 13:12:20 -0700 (Mon, 06 Jun 2005) | 5 lines

ckpt.c:
  The selection object get in sync with openAsync doesn't work.

BKrev: 42a4ae24bww-nX_J3YlTL9lMO3KZvQ

------------------------------------------------------------------------
r648 | mvista.com!sdake | 2005-06-06 13:12:20 -0700 (Mon, 06 Jun 2005) | 4 lines

The selection object get in sync with openAsync doesn't work.

(Logical change 1.199)

------------------------------------------------------------------------
r647 | mvista.com!sdake | 2005-06-06 13:11:20 -0700 (Mon, 06 Jun 2005) | 7 lines

ckpt.c, ipc_ckpt.h:
  defect 592
  If ActiveReplicaSet is called, the correct return values are not
  returned, causing failures in the saf test suite.

BKrev: 42a4ade8M7A9p_GJDKQGsWWbJxc41w

------------------------------------------------------------------------
r646 | mvista.com!sdake | 2005-06-06 13:11:20 -0700 (Mon, 06 Jun 2005) | 6 lines

defect 592
If ActiveReplicaSet is called, the correct return values are not
returned, causing failures in the saf test suite.

(Logical change 1.198)

------------------------------------------------------------------------
r645 | mvista.com!sdake | 2005-06-06 13:10:13 -0700 (Mon, 06 Jun 2005) | 7 lines

defect 591
If checkpoint open is called, but checkpoint close isn't called before
saCkptFinalize is called, the reference count of the checkpoints gets
out of kilter.

(Logical change 1.197)

------------------------------------------------------------------------
r644 | mvista.com!sdake | 2005-06-06 13:10:13 -0700 (Mon, 06 Jun 2005) | 8 lines

ckpt.c:
  defect 591
  If checkpoint open is called, but checkpoint close isn't called before
  saCkptFinalize is called, the reference count of the checkpoints gets
  out of kilter.

BKrev: 42a4ada5nUMOYQy74W2MQ1eTlNNC0g

------------------------------------------------------------------------
r643 | mvista.com!sdake | 2005-05-26 15:37:31 -0700 (Thu, 26 May 2005) | 2 lines

(Logical change 1.196)

------------------------------------------------------------------------
r642 | mvista.com!sdake | 2005-05-26 15:37:31 -0700 (Thu, 26 May 2005) | 4 lines

adds evs_membership_get api

(Logical change 1.196)

------------------------------------------------------------------------
r641 | mvista.com!sdake | 2005-05-26 15:37:31 -0700 (Thu, 26 May 2005) | 7 lines

Many files:
  adds evs_membership_get api
evs_membership_get.3:
  new file

BKrev: 42964fab28riN6pUGbG3uqbjbAjKcA

------------------------------------------------------------------------
r640 | mvista.com!sdake | 2005-05-26 15:37:30 -0700 (Thu, 26 May 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r639 | osdl.net!markh | 2005-05-26 15:19:26 -0700 (Thu, 26 May 2005) | 6 lines

Allow services to use the openais.conf file for setting custom options.
Evt now allows the maximum delivery queue size and the resume size to be
set in openais.conf

(Logical change 1.195)

------------------------------------------------------------------------
r638 | osdl.net!markh | 2005-05-26 15:19:26 -0700 (Thu, 26 May 2005) | 6 lines

Allow services to use the openais.conf file for setting custom options.
Evt now allows the maximum delivery queue size and the resume size to be
set in openais.conf

BKrev: 42964b6eDjhuwHSUD_2OVfOPwqZf3w

------------------------------------------------------------------------
r637 | osdl.net!markh | 2005-05-26 15:19:26 -0700 (Thu, 26 May 2005) | 4 lines

Allow services to use the openais.conf file for setting custom options.

(Logical change 1.195)

------------------------------------------------------------------------
r636 | sakai!sakai | 2005-05-25 13:47:14 -0700 (Wed, 25 May 2005) | 4 lines

Failover doesn't happen when CTL-Z and process kill

(Logical change 1.194)

------------------------------------------------------------------------
r635 | osdl.net!markh | 2005-05-25 13:47:14 -0700 (Wed, 25 May 2005) | 9 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_work

2005/05/18 01:03:02+09:00 sakai!sakai
amf.c:
  Failover doesn't happen when CTL-Z and process kill

BKrev: 4294e4525GqfTV54xRLGWs-383Stsg

------------------------------------------------------------------------
r634 | osdl.net!markh | 2005-05-25 13:46:41 -0700 (Wed, 25 May 2005) | 4 lines

More updates to make event conform to B spec.

BKrev: 4294e431odUeu4s7HWbqMRrsByv4rQ

------------------------------------------------------------------------
r633 | osdl.net!markh | 2005-05-25 13:46:41 -0700 (Wed, 25 May 2005) | 4 lines

More updates to make event conform to B spec.

(Logical change 1.193)

------------------------------------------------------------------------
r632 | osdl.net!markh | 2005-05-25 13:42:45 -0700 (Wed, 25 May 2005) | 4 lines

Fix memory leak.

BKrev: 4294e345EM8L82mcgFGtNXNOOrANVg

------------------------------------------------------------------------
r631 | osdl.net!markh | 2005-05-25 13:42:45 -0700 (Wed, 25 May 2005) | 4 lines

Fix memory leak.

(Logical change 1.192)

------------------------------------------------------------------------
r630 | osdl.net!markh | 2005-05-04 10:08:55 -0700 (Wed, 04 May 2005) | 4 lines

Added a description of the timeout section of openais.conf

(Logical change 1.191)

------------------------------------------------------------------------
r629 | osdl.net!markh | 2005-05-04 10:08:55 -0700 (Wed, 04 May 2005) | 4 lines

Add support for user specified timeouts from openais.conf

BKrev: 427901a7TTHofqEBWm_tyZgxLVSn8g

------------------------------------------------------------------------
r628 | osdl.net!markh | 2005-05-04 10:08:55 -0700 (Wed, 04 May 2005) | 4 lines

Add support for user specified timeouts from openais.conf

(Logical change 1.191)

------------------------------------------------------------------------
r627 | mvista.com!sdake | 2005-04-29 14:10:39 -0700 (Fri, 29 Apr 2005) | 5 lines

defect 529
dont ignore commit token which was causing strange semantics.

(Logical change 1.190)

------------------------------------------------------------------------
r626 | mvista.com!sdake | 2005-04-29 14:10:39 -0700 (Fri, 29 Apr 2005) | 6 lines

totemsrp.c:
  defect 529
  dont ignore commit token which was causing strange semantics.

BKrev: 4272a2cfQng6C3XBRPdeo8GZx7KIlQ

------------------------------------------------------------------------
r625 | mvista.com!sdake | 2005-04-22 11:46:23 -0700 (Fri, 22 Apr 2005) | 5 lines

Many files:
  defect 512 - some ais header file defines are wrong.

BKrev: 4269467fUqljxZ1cZm7rYtXJgozkZQ

------------------------------------------------------------------------
r624 | mvista.com!sdake | 2005-04-22 11:46:23 -0700 (Fri, 22 Apr 2005) | 4 lines

defect 512 - some ais header file defines are wrong.

(Logical change 1.189)

------------------------------------------------------------------------
r623 | mvista.com!sdake | 2005-04-22 11:44:20 -0700 (Fri, 22 Apr 2005) | 5 lines

totemsrp.c:
  defect 498 - reduce network traffic from merge detection

BKrev: 42694604csBxR35HgvFh1cX-WdsjPw

------------------------------------------------------------------------
r622 | mvista.com!sdake | 2005-04-22 11:44:20 -0700 (Fri, 22 Apr 2005) | 4 lines

defect 498 - reduce network traffic from merge detection

(Logical change 1.188)

------------------------------------------------------------------------
r621 | mvista.com!sdake | 2005-04-21 11:32:17 -0700 (Thu, 21 Apr 2005) | 5 lines

testckpt.c, ckpt.c, ipc_ckpt.h:
  defect 323 - defect 410 - CheckpointOpenAsync and Dispatch not working

BKrev: 4267f1b1iKpaZFwASGi0Hpg6NPVlvA

------------------------------------------------------------------------
r620 | mvista.com!sdake | 2005-04-21 11:32:17 -0700 (Thu, 21 Apr 2005) | 4 lines

defect 323 - defect 410 - CheckpointOpenAsync and Dispatch not working

(Logical change 1.187)

------------------------------------------------------------------------
r619 | mvista.com!sdake | 2005-04-20 17:57:34 -0700 (Wed, 20 Apr 2005) | 4 lines

defect 505 - fix uncompilable with gcc 2.95

(Logical change 1.186)

------------------------------------------------------------------------
r618 | mvista.com!sdake | 2005-04-20 17:57:34 -0700 (Wed, 20 Apr 2005) | 5 lines

ckpt-wr.c, evt.c, ckpt.c, amf.c:
  defect 505 - fix uncompilable with gcc 2.95

BKrev: 4266fa7e2AAxpdYH2FJH4NEZ75Hc9w

------------------------------------------------------------------------
r617 | osdl.net!markh | 2005-04-20 15:13:34 -0700 (Wed, 20 Apr 2005) | 6 lines

Defect 501.

Fix some mutex and error return problems.

(Logical change 1.185)

------------------------------------------------------------------------
r616 | osdl.net!markh | 2005-04-20 15:13:34 -0700 (Wed, 20 Apr 2005) | 6 lines

Defect 501.

Fix some mutex and error return problems.

BKrev: 4266d40eIENsfJQEvDM6MjMDhFcqLA

------------------------------------------------------------------------
r615 | osdl.net!markh | 2005-04-20 14:46:14 -0700 (Wed, 20 Apr 2005) | 6 lines

For defect 501.
Fix possible stale pointers in async lists if an application
disconnects before its command has been fully processed.

(Logical change 1.184)

------------------------------------------------------------------------
r614 | osdl.net!markh | 2005-04-20 14:46:14 -0700 (Wed, 20 Apr 2005) | 10 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_work

2005/04/20 14:43:05-07:00 osdl.net!markh
For defect 501.
Fix possible stale pointers in async lists if an application
disconnects before its command has been fully processed.

BKrev: 4266cda65e-fXv0kW4Qe-4Fr4Sbrww

------------------------------------------------------------------------
r613 | mvista.com!sdake | 2005-04-18 14:27:27 -0700 (Mon, 18 Apr 2005) | 5 lines

evs.c:
  defect 42 - evs service doesn't send config change on evs_initialize

BKrev: 4264263fzzgV2yL8rAEqgs69wjGnZA

------------------------------------------------------------------------
r612 | mvista.com!sdake | 2005-04-18 14:27:27 -0700 (Mon, 18 Apr 2005) | 4 lines

defect 42 - evs service doesn't send config change on evs_initialize

(Logical change 1.183)

------------------------------------------------------------------------
r611 | mvista.com!sdake | 2005-04-18 12:53:25 -0700 (Mon, 18 Apr 2005) | 5 lines

totemsrp.c:
  Fix assert when recovery fails and messages are accepted in the gather state.

BKrev: 42641035MxBKYwCZ1zOkFr_h-WES3Q

------------------------------------------------------------------------
r610 | mvista.com!sdake | 2005-04-18 12:53:25 -0700 (Mon, 18 Apr 2005) | 4 lines

Fix assert when recovery fails and messages are accepted in the gather state.

(Logical change 1.182)

------------------------------------------------------------------------
r609 | mvista.com!sdake | 2005-04-15 16:30:39 -0700 (Fri, 15 Apr 2005) | 7 lines

totemsrp.c:
  Fixes a condition which would result in a proc set and failed set
  being equal which would force the algorithm to never reach
  consensus in the membership algorithm.

BKrev: 42604e9fCBYactncuQuguPZ_IEfQsQ

------------------------------------------------------------------------
r608 | mvista.com!sdake | 2005-04-15 16:30:39 -0700 (Fri, 15 Apr 2005) | 6 lines

Fixes a condition which would result in a proc set and failed set
being equal which would force the algorithm to never reach
consensus in the membership algorithm.

(Logical change 1.181)

------------------------------------------------------------------------
r607 | mvista.com!sdake | 2005-04-15 16:29:31 -0700 (Fri, 15 Apr 2005) | 5 lines

totem packet size changed from 1408 to 1404 because a field was
added to the mcast header.

(Logical change 1.180)

------------------------------------------------------------------------
r606 | mvista.com!sdake | 2005-04-15 16:29:31 -0700 (Fri, 15 Apr 2005) | 4 lines

add some sort queue functions.

(Logical change 1.180)

------------------------------------------------------------------------
r605 | mvista.com!sdake | 2005-04-15 16:29:31 -0700 (Fri, 15 Apr 2005) | 11 lines

turn off random dropping of packets by default.

2005/04/15 16:27:14-07:00 mvista.com!sdake
Major fixes to the recovery phase of the totem protocol.  The
remainder of the protocol remains unchanged.
The protocol now properly adds the right messages to the right
queues during recovery.  The protocol properly handles failures
in the recovery state.

(Logical change 1.180)

------------------------------------------------------------------------
r604 | mvista.com!sdake | 2005-04-15 16:29:31 -0700 (Fri, 15 Apr 2005) | 18 lines

totemsrp.c:
  turn off random dropping of packets by default.
totemsrp.h:
  totem packet size changed from 1408 to 1404 because a field was
  added to the mcast header.
sq.h:
  add some sort queue functions.
totemsrp.c:
  Major fixes to the recovery phase of the totem protocol.  The
  remainder of the protocol remains unchanged.
  The protocol now properly adds the right messages to the right
  queues during recovery.  The protocol properly handles failures
  in the recovery state.
totempg.c:
  add an assert to catch a weird case.

BKrev: 42604e5bSfwCdUnySrgU1nlV7yDYNQ

------------------------------------------------------------------------
r603 | mvista.com!sdake | 2005-04-15 16:29:31 -0700 (Fri, 15 Apr 2005) | 4 lines

add an assert to catch a weird case.

(Logical change 1.180)

------------------------------------------------------------------------
r602 | mvista.com!sdake | 2005-04-15 14:15:41 -0700 (Fri, 15 Apr 2005) | 5 lines

crypto.c:
  autodetect endian and wordsize with gnuisms

BKrev: 42602efdZ8LfQwIHBFrdtsjrK3BtCg

------------------------------------------------------------------------
r601 | mvista.com!sdake | 2005-04-15 14:15:41 -0700 (Fri, 15 Apr 2005) | 4 lines

autodetect endian and wordsize with gnuisms

(Logical change 1.179)

------------------------------------------------------------------------
r600 | mvista.com!sdake | 2005-04-15 14:07:01 -0700 (Fri, 15 Apr 2005) | 5 lines

evs.c:
  fix defect 477 - header size calculated incorrectly results in assert

BKrev: 42602cf5j6Zi2RZtyz9xB83lZW9R6g

------------------------------------------------------------------------
r599 | mvista.com!sdake | 2005-04-15 14:07:01 -0700 (Fri, 15 Apr 2005) | 4 lines

fix defect 477 - header size calculated incorrectly results in assert

(Logical change 1.178)

------------------------------------------------------------------------
r598 | mvista.com!sdake | 2005-04-15 13:48:57 -0700 (Fri, 15 Apr 2005) | 9 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2005/04/15 13:48:35-07:00 mvista.com!sdake
Makefile, util.h, util.c, evt.c, evs.c, clm.c, ckpt.c, amf.c:
  defect 188 missed initial checkin

BKrev: 426028b9DQDC6BgUEBBsQmVJmhyxOg

------------------------------------------------------------------------
r597 | mvista.com!sdake | 2005-04-15 13:48:57 -0700 (Fri, 15 Apr 2005) | 4 lines

defect 188 missed initial checkin

(Logical change 1.177)

------------------------------------------------------------------------
r596 | osdl.net!markh | 2005-04-15 13:05:46 -0700 (Fri, 15 Apr 2005) | 4 lines

Test updates to handle SA_AIS_ERR_TRY_AGAIN return codes.

(Logical change 1.176)

------------------------------------------------------------------------
r595 | osdl.net!markh | 2005-04-15 13:05:46 -0700 (Fri, 15 Apr 2005) | 8 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_work

2005/04/15 13:01:00-07:00 osdl.net!markh
Test updates to handle SA_AIS_ERR_TRY_AGAIN return codes.

BKrev: 42601e9aBWGIREypBcTjO5NC8bK8uA

------------------------------------------------------------------------
r594 | mvista.com!sdake | 2005-04-15 12:08:20 -0700 (Fri, 15 Apr 2005) | 4 lines

defect 188 - use two fds instead of one fd for I/Os to executive

(Logical change 1.175)

------------------------------------------------------------------------
r593 | mvista.com!sdake | 2005-04-15 12:08:20 -0700 (Fri, 15 Apr 2005) | 7 lines

Many files:
  defect 188 - use two fds instead of one fd for I/Os to executive
testevsth.c:
  test evs threading

BKrev: 42601124xiPxCobiccGpS7CZ62Ol7w

------------------------------------------------------------------------
r592 | mvista.com!sdake | 2005-04-15 12:08:20 -0700 (Fri, 15 Apr 2005) | 2 lines

(Logical change 1.175)

------------------------------------------------------------------------
r591 | mvista.com!sdake | 2005-04-15 12:08:19 -0700 (Fri, 15 Apr 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r590 | mvista.com!sdake | 2005-04-15 12:03:18 -0700 (Fri, 15 Apr 2005) | 4 lines

defect 478 - remove extra parameter to config change.

(Logical change 1.174)

------------------------------------------------------------------------
r589 | mvista.com!sdake | 2005-04-15 12:03:18 -0700 (Fri, 15 Apr 2005) | 5 lines

Many files:
  defect 478 - remove extra parameter to config change.

BKrev: 42600ff6Tg7hfUjwYnckeK8uBxBGrg

------------------------------------------------------------------------
r588 | mvista.com!sdake | 2005-04-11 14:33:33 -0700 (Mon, 11 Apr 2005) | 5 lines

Fix defect 456
when checkpoint expirse, the executive crashes if no bind address was specified

(Logical change 1.173)

------------------------------------------------------------------------
r587 | mvista.com!sdake | 2005-04-11 14:33:33 -0700 (Mon, 11 Apr 2005) | 6 lines

main.c:
  Fix defect 456
  when checkpoint expirse, the executive crashes if no bind address was specified

BKrev: 425aed2d6P3dBt_7UO1Cv6d5kt4haQ

------------------------------------------------------------------------
r586 | mvista.com!sdake | 2005-04-11 14:25:27 -0700 (Mon, 11 Apr 2005) | 4 lines

add default section to testcase

(Logical change 1.172)

------------------------------------------------------------------------
r585 | mvista.com!sdake | 2005-04-11 14:25:27 -0700 (Mon, 11 Apr 2005) | 4 lines

add default section to testcase.

(Logical change 1.172)

------------------------------------------------------------------------
r584 | mvista.com!sdake | 2005-04-11 14:25:27 -0700 (Mon, 11 Apr 2005) | 4 lines

Add default section support to checkpoints.

(Logical change 1.172)

------------------------------------------------------------------------
r583 | mvista.com!sdake | 2005-04-11 14:25:27 -0700 (Mon, 11 Apr 2005) | 2 lines

(Logical change 1.172)

------------------------------------------------------------------------
r582 | mvista.com!sdake | 2005-04-11 14:25:27 -0700 (Mon, 11 Apr 2005) | 7 lines

testckpt.c, ckpt-rd.c, ckpt-wr:
  add default section to testcase.
ckpt.c:
  Add default section support to checkpoints.

BKrev: 425aeb47Mb_N8HKGtX_BdmRGaLP-Jg

------------------------------------------------------------------------
r581 | mvista.com!sdake | 2005-04-08 14:12:48 -0700 (Fri, 08 Apr 2005) | 7 lines

ckpt.c:
  Patch from Muni and Mark to properly calculate the header size
  field so that the totem delivery assertion doesn't assert when
  using ckpt services.

BKrev: 4256f3d0FFsh6CwpsXs-w4_225C4Wg

------------------------------------------------------------------------
r580 | mvista.com!sdake | 2005-04-08 14:12:48 -0700 (Fri, 08 Apr 2005) | 6 lines

Patch from Muni and Mark to properly calculate the header size
field so that the totem delivery assertion doesn't assert when
using ckpt services.

(Logical change 1.171)

------------------------------------------------------------------------
r579 | osdl.net!markh | 2005-04-06 12:37:30 -0700 (Wed, 06 Apr 2005) | 5 lines

Make sure that the message count in the message matches the actual length
of the message.

BKrev: 42543a7aj_fChUtiZ_ZWH0wdZ6JN3Q

------------------------------------------------------------------------
r578 | osdl.net!markh | 2005-04-06 12:37:30 -0700 (Wed, 06 Apr 2005) | 5 lines

Make sure that the message count in the message matches the actual length
of the message.

(Logical change 1.170)

------------------------------------------------------------------------
r577 | osdl.net!markh | 2005-04-05 08:56:49 -0700 (Tue, 05 Apr 2005) | 10 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_work

2005/04/05 08:56:39-07:00 osdl.net!markh
Replace assert with a return.  This will allow the custer to continue
to run.  This happens when a joining node receives a message from a node
that it doesn't know about yet.  This is a temporary fix for now.

BKrev: 4252b541e1CWSNFoD816nTIzzKKPDg

------------------------------------------------------------------------
r576 | osdl.net!markh | 2005-04-05 08:56:49 -0700 (Tue, 05 Apr 2005) | 6 lines

Replace assert with a return.  This will allow the custer to continue
to run.  This happens when a joining node receives a message from a node
that it doesn't know about yet.  This is a temporary fix for now.

(Logical change 1.169)

------------------------------------------------------------------------
r575 | mvista.com!sdake | 2005-04-04 18:51:09 -0700 (Mon, 04 Apr 2005) | 4 lines

Patch from Miyotaka Sakai to fix access to free area defect 426.

(Logical change 1.168)

------------------------------------------------------------------------
r574 | mvista.com!sdake | 2005-04-04 18:51:09 -0700 (Mon, 04 Apr 2005) | 5 lines

totemsrp.c:
  Patch from Miyotaka Sakai to fix access to free area defect 426.

BKrev: 4251ef0dubnPmmnqD-elKTQ_vgpq9Q

------------------------------------------------------------------------
r573 | mvista.com!sdake | 2005-04-01 14:20:11 -0700 (Fri, 01 Apr 2005) | 4 lines

change around this_ip to better support ifup/ifdown

(Logical change 1.167)

------------------------------------------------------------------------
r572 | mvista.com!sdake | 2005-04-01 14:20:11 -0700 (Fri, 01 Apr 2005) | 4 lines

add some support functions relating to this_ip

(Logical change 1.167)

------------------------------------------------------------------------
r571 | mvista.com!sdake | 2005-04-01 14:20:11 -0700 (Fri, 01 Apr 2005) | 4 lines

add ifup/ifdown binding to totem single ring protocol

(Logical change 1.167)

------------------------------------------------------------------------
r570 | mvista.com!sdake | 2005-04-01 14:20:11 -0700 (Fri, 01 Apr 2005) | 4 lines

minor improvements to the ckpt tests

(Logical change 1.167)

------------------------------------------------------------------------
r569 | mvista.com!sdake | 2005-04-01 14:20:11 -0700 (Fri, 01 Apr 2005) | 11 lines

testckpt.c:
  minor improvements to the ckpt tests
totemsrp.h, totemsrp.c:
  add ifup/ifdown binding to totem single ring protocol
main.h, main.c:
  add some support functions relating to this_ip
clm.c, ckpt.c, amf.c:
  change around this_ip to better support ifup/ifdown

BKrev: 424dbb0bUeDXpnbGn8TxJlPYWRvT6A

------------------------------------------------------------------------
r568 | sakai!sakai | 2005-03-30 15:29:58 -0700 (Wed, 30 Mar 2005) | 4 lines

fix not to transit state when process terminate

(Logical change 1.166)

------------------------------------------------------------------------
r567 | sakai!sakai | 2005-03-30 15:29:58 -0700 (Wed, 30 Mar 2005) | 5 lines

amf.c:
  fix not to transit state when process terminate

BKrev: 424b286648uPUwF_B-hMgKOF5Mgwzw

------------------------------------------------------------------------
r566 | mvista.com!sdake | 2005-03-30 14:26:35 -0700 (Wed, 30 Mar 2005) | 7 lines

Updated with comments from Michael Howard
added evt and evs service tests to quickstart information
added text about running as root
removed default route setup instructions since they are no longer needed.

(Logical change 1.165)

------------------------------------------------------------------------
r565 | mvista.com!sdake | 2005-03-30 14:26:35 -0700 (Wed, 30 Mar 2005) | 8 lines

QUICKSTART:
  Updated with comments from Michael Howard
  added evt and evs service tests to quickstart information
  added text about running as root
  removed default route setup instructions since they are no longer needed.

BKrev: 424b198bYLqB2blTRdYtgLgjFmHjIA

------------------------------------------------------------------------
r564 | mvista.com!sdake | 2005-03-29 15:43:15 -0700 (Tue, 29 Mar 2005) | 13 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2005/03/29 15:03:30-07:00 mvista.com!sdake
testckpt.c:
  Create section after section is unlinked in test code.
ckpt.c:
  Patch from Muni Bajpai to not setup a cleanup handler for a
  checkpoint when a checkpoint open fails.  Patch also fixes up
  checkpoint iterators so they do not crash on process exit.

BKrev: 4249da03fKPlzZG0QP8eZriaAtoM-w

------------------------------------------------------------------------
r563 | mvista.com!sdake | 2005-03-29 15:43:15 -0700 (Tue, 29 Mar 2005) | 6 lines

Patch from Muni Bajpai to not setup a cleanup handler for a
checkpoint when a checkpoint open fails.  Patch also fixes up
checkpoint iterators so they do not crash on process exit.

(Logical change 1.164)

------------------------------------------------------------------------
r562 | mvista.com!sdake | 2005-03-29 15:43:15 -0700 (Tue, 29 Mar 2005) | 4 lines

Create section after section is unlinked in test code.

(Logical change 1.164)

------------------------------------------------------------------------
r561 | sakai!sakai | 2005-03-28 15:49:18 -0700 (Mon, 28 Mar 2005) | 4 lines

fix configuration change

(Logical change 1.163)

------------------------------------------------------------------------
r560 | sakai!sakai | 2005-03-28 15:49:18 -0700 (Mon, 28 Mar 2005) | 5 lines

amf.c:
  fix configuration change

BKrev: 424889eehbHC-A5YNtbXzaEzVMhcVQ

------------------------------------------------------------------------
r559 | mvista.com!sdake | 2005-03-28 11:57:21 -0700 (Mon, 28 Mar 2005) | 4 lines

Remove extra debug printf.

(Logical change 1.162)

------------------------------------------------------------------------
r558 | mvista.com!sdake | 2005-03-28 11:57:21 -0700 (Mon, 28 Mar 2005) | 5 lines

totemsrp.c:
  Remove extra debug printf.

BKrev: 42485391qM7HG2et7RcmNIHInqXxTA

------------------------------------------------------------------------
r557 | mvista.com!sdake | 2005-03-28 11:39:16 -0700 (Mon, 28 Mar 2005) | 17 lines

defect 368
A report of totemsrp not merging configurations led to this
enhancement.

totemsrp.c:
  The totem protocol would not previously merge a configuration
  until a multicast message was sent.  This change sends a special
  "merge detect" message if no message has been multicast in some
  time from the representative.  This merge detect message will
  trigger other processors to enter the gather state and form
  a new configuration if they were not previously part of the
  current configuration.
Makefile:
  Build aisexec when libtotem.a changes.

BKrev: 42484f5453Wf6HN2Gbyg9dznFaQGtw

------------------------------------------------------------------------
r556 | mvista.com!sdake | 2005-03-28 11:39:16 -0700 (Mon, 28 Mar 2005) | 10 lines

The totem protocol would not previously merge a configuration
until a multicast message was sent.  This change sends a special
"merge detect" message if no message has been multicast in some
time from the representative.  This merge detect message will
trigger other processors to enter the gather state and form
a new configuration if they were not previously part of the
current configuration.

(Logical change 1.161)

------------------------------------------------------------------------
r555 | mvista.com!sdake | 2005-03-28 11:39:16 -0700 (Mon, 28 Mar 2005) | 4 lines

Build aisexec when libtotem.a changes.

(Logical change 1.161)

------------------------------------------------------------------------
r554 | osdl.net!markh | 2005-03-28 11:22:39 -0700 (Mon, 28 Mar 2005) | 6 lines

This update allows retained events from a merging partition to
be delivered to applications with the associated channels already
open at the time of the merge.

BKrev: 42484b6f0IXKK1Bql-GCaHwTbXg0dQ

------------------------------------------------------------------------
r553 | osdl.net!markh | 2005-03-28 11:22:39 -0700 (Mon, 28 Mar 2005) | 6 lines

This update allows retained events from a merging partition to
be delivered to applications with the associated channels already
open at the time of the merge.

(Logical change 1.160)

------------------------------------------------------------------------
r552 | osdl.net!markh | 2005-03-28 10:26:27 -0700 (Mon, 28 Mar 2005) | 5 lines

Async open and subscribe needed to check for registered call back
functions and retrun an error if there were no assocated callbacks.

BKrev: 42483e43sOS_W8zCqoAZNHTy43FhkA

------------------------------------------------------------------------
r551 | osdl.net!markh | 2005-03-28 10:26:27 -0700 (Mon, 28 Mar 2005) | 5 lines

Async open and subscribe needed to check for registered call back
functions and retrun an error if there were no assocated callbacks.

(Logical change 1.159)

------------------------------------------------------------------------
r550 | osdl.net!markh | 2005-03-23 13:12:44 -0700 (Wed, 23 Mar 2005) | 4 lines

Only dispatch a callback if it is non-null.

(Logical change 1.158)

------------------------------------------------------------------------
r549 | osdl.net!markh | 2005-03-23 13:12:44 -0700 (Wed, 23 Mar 2005) | 4 lines

Only dispatch a callback if it is non-null.

BKrev: 4241cdbcbgCCwsZLJEXicZZTvGpuGQ

------------------------------------------------------------------------
r548 | mvista.com!sdake | 2005-03-22 16:37:45 -0700 (Tue, 22 Mar 2005) | 4 lines

defect325 - rename saCkptActiveCheckpointSet to saCkptActiveReplicaSet

(Logical change 1.157)

------------------------------------------------------------------------
r547 | mvista.com!sdake | 2005-03-22 16:37:45 -0700 (Tue, 22 Mar 2005) | 5 lines

ckpt.c:
  defect325 - rename saCkptActiveCheckpointSet to saCkptActiveReplicaSet

BKrev: 4240ac49svEd0Uoaf0zn8-6YXK5akw

------------------------------------------------------------------------
r546 | mvista.com!sdake | 2005-03-22 16:36:53 -0700 (Tue, 22 Mar 2005) | 6 lines

Makefile:
  Link to seperate libraries.
  Provide seperate libraries per service as well as the consolidated libais library.

BKrev: 4240ac15wtabDEmO2ooaShdbFZP-wg

------------------------------------------------------------------------
r545 | mvista.com!sdake | 2005-03-22 16:36:53 -0700 (Tue, 22 Mar 2005) | 4 lines

Link to seperate libraries.

(Logical change 1.156)

------------------------------------------------------------------------
r544 | mvista.com!sdake | 2005-03-22 16:36:53 -0700 (Tue, 22 Mar 2005) | 4 lines

Provide seperate libraries per service as well as the consolidated libais library.

(Logical change 1.156)

------------------------------------------------------------------------
r543 | osdl.net!markh | 2005-03-22 16:22:34 -0700 (Tue, 22 Mar 2005) | 5 lines

Fix an off by one error causing a bad event ID to be sent after
a recovery in some cases.

BKrev: 4240a8ba6cGIAgqLoTZNAUZJJOgyrg

------------------------------------------------------------------------
r542 | osdl.net!markh | 2005-03-22 16:22:34 -0700 (Tue, 22 Mar 2005) | 5 lines

Fix an off by one error causing a bad event ID to be sent after
a recovery in some cases.

(Logical change 1.155)

------------------------------------------------------------------------
r541 | osdl.net!markh | 2005-03-17 15:44:28 -0700 (Thu, 17 Mar 2005) | 5 lines

Event service now reconciles open channels and retained events between active
merging partitions.

(Logical change 1.154)

------------------------------------------------------------------------
r540 | osdl.net!markh | 2005-03-17 15:44:28 -0700 (Thu, 17 Mar 2005) | 9 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_work

2005/03/17 14:44:09-08:00 osdl.net!markh
Event service now reconciles open channels and retained events between active
merging partitions.

BKrev: 423a084c-3ULQ_tcgSf5isGBiqzUWA

------------------------------------------------------------------------
r539 | mvista.com!sdake | 2005-03-17 14:25:31 -0700 (Thu, 17 Mar 2005) | 9 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2005/03/17 14:25:22-07:00 mvista.com!sdake
ckpt.c:
  Change few ERROR loggings to DEBUG loggings from Muni Bajpai.

BKrev: 4239f5cbSrwx6_k9jxG2_GjW1OoVHQ

------------------------------------------------------------------------
r538 | mvista.com!sdake | 2005-03-17 14:25:31 -0700 (Thu, 17 Mar 2005) | 4 lines

Change few ERROR loggings to DEBUG loggings from Muni Bajpai.

(Logical change 1.153)

------------------------------------------------------------------------
r537 | osdl.net!markh | 2005-03-17 11:12:22 -0700 (Thu, 17 Mar 2005) | 4 lines

Handle possible SA_AIS_ERR_TRY_AGAIN status.

BKrev: 4239c886n6J6MzMfIVjaN1QvFnsfzg

------------------------------------------------------------------------
r536 | osdl.net!markh | 2005-03-17 11:12:22 -0700 (Thu, 17 Mar 2005) | 4 lines

Handle possible SA_AIS_ERR_TRY_AGAIN status.

(Logical change 1.152)

------------------------------------------------------------------------
r535 | mvista.com!sdake | 2005-03-16 16:41:41 -0700 (Wed, 16 Mar 2005) | 4 lines

Block multicast messages during synchronization.

(Logical change 1.151)

------------------------------------------------------------------------
r534 | mvista.com!sdake | 2005-03-16 16:41:41 -0700 (Wed, 16 Mar 2005) | 7 lines

ckptbench.c:
  retry writes when it appears the system is blocked, perhaps during a resynchronization.
Many files:
  Block multicast messages during synchronization.

BKrev: 4238c435y6ZGwBr-M4xFHDUJ7HhLaQ

------------------------------------------------------------------------
r533 | mvista.com!sdake | 2005-03-16 16:41:41 -0700 (Wed, 16 Mar 2005) | 4 lines

retry writes when it appears the system is blocked, perhaps during a resynchronization.

(Logical change 1.151)

------------------------------------------------------------------------
r532 | mvista.com!sdake | 2005-03-16 11:23:54 -0700 (Wed, 16 Mar 2005) | 4 lines

cleanup some shared datatypes.

(Logical change 1.150)

------------------------------------------------------------------------
r531 | mvista.com!sdake | 2005-03-16 11:23:54 -0700 (Wed, 16 Mar 2005) | 4 lines

cleanup some shared datatypes

(Logical change 1.150)

------------------------------------------------------------------------
r530 | mvista.com!sdake | 2005-03-16 11:23:54 -0700 (Wed, 16 Mar 2005) | 2 lines

(Logical change 1.150)

------------------------------------------------------------------------
r529 | mvista.com!sdake | 2005-03-16 11:23:54 -0700 (Wed, 16 Mar 2005) | 11 lines

Mark Haverkamp reported some compile warnings with his compiler.  Cleanup
those warnings by unifying the datatypes used in totempg and totemsrp into
one set of datatypes.

Many files:
  cleanup some shared datatypes for the totem protocol.
totem.h:
  new file

BKrev: 423879baJvLZpm8nNaRfQHRfWB2fOA

------------------------------------------------------------------------
r528 | mvista.com!sdake | 2005-03-16 11:23:53 -0700 (Wed, 16 Mar 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r527 | mvista.com!sdake | 2005-03-16 11:17:48 -0700 (Wed, 16 Mar 2005) | 4 lines

Improved synchronization test code from Muni Bajpai.

(Logical change 1.149)

------------------------------------------------------------------------
r526 | mvista.com!sdake | 2005-03-16 11:17:48 -0700 (Wed, 16 Mar 2005) | 5 lines

ckpt-wr.c, ckpt-rd.c:
  Improved synchronization test code from Muni Bajpai.

BKrev: 4238784c5RBxBXc3aHA68KOVGhAEWw

------------------------------------------------------------------------
r525 | mvista.com!sdake | 2005-03-15 10:29:25 -0700 (Tue, 15 Mar 2005) | 4 lines

Fix bug in sync which caused segfault.

(Logical change 1.148)

------------------------------------------------------------------------
r524 | mvista.com!sdake | 2005-03-15 10:29:25 -0700 (Tue, 15 Mar 2005) | 7 lines

totemsrp.h, totemsrp.c:
  Allow totemsrp to remove the reference information for a token callback.
sync.c:
  Fix bug in sync which caused segfault.

BKrev: 42371b753plEvd2J96qRpg6mRxki1Q

------------------------------------------------------------------------
r523 | mvista.com!sdake | 2005-03-15 10:29:25 -0700 (Tue, 15 Mar 2005) | 4 lines

Allow totemsrp to remove the reference information for a token callback.

(Logical change 1.148)

------------------------------------------------------------------------
r522 | mvista.com!sdake | 2005-03-14 17:46:57 -0700 (Mon, 14 Mar 2005) | 4 lines

Add checkpoint reader and writer to test synchronization

(Logical change 1.147)

------------------------------------------------------------------------
r521 | mvista.com!sdake | 2005-03-14 17:46:57 -0700 (Mon, 14 Mar 2005) | 7 lines

Makefile:
  Add checkpoint reader and writer to test synchronization
ckpt-wr.c, ckpt-rd.c:
  new file

BKrev: 42363081enPpMuQpdvw2e1uqFAqD0A

------------------------------------------------------------------------
r520 | mvista.com!sdake | 2005-03-14 17:46:57 -0700 (Mon, 14 Mar 2005) | 2 lines

(Logical change 1.147)

------------------------------------------------------------------------
r519 | mvista.com!sdake | 2005-03-14 17:46:56 -0700 (Mon, 14 Mar 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r518 | mvista.com!sdake | 2005-03-14 15:39:56 -0700 (Mon, 14 Mar 2005) | 9 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2005/03/14 15:39:42-07:00 mvista.com!sdake
ipc_gen.h, ipc_ckpt.h, ckpt.c:
  Checkpoint synchronization patch from Muni Bajpai.

BKrev: 423612bc5lRZOqj0qi_o6zXGw1bAwg

------------------------------------------------------------------------
r517 | mvista.com!sdake | 2005-03-14 15:39:56 -0700 (Mon, 14 Mar 2005) | 4 lines

Checkpoint synchronization patch from Muni Bajpai.

(Logical change 1.146)

------------------------------------------------------------------------
r516 | osdl.net!markh | 2005-03-11 12:03:05 -0700 (Fri, 11 Mar 2005) | 5 lines

Update the publish API to return SA_AIS_ERR_TRY_AGAIN to the application
instead of handling it in the library.

(Logical change 1.145)

------------------------------------------------------------------------
r515 | osdl.net!markh | 2005-03-11 12:03:05 -0700 (Fri, 11 Mar 2005) | 5 lines

Update the publish API to return SA_AIS_ERR_TRY_AGAIN to the application
instead of handling it in the library.

BKrev: 4231eb69MvlifP_ykH0Nfj693tUWMA

------------------------------------------------------------------------
r514 | osdl.net!markh | 2005-03-09 15:08:07 -0700 (Wed, 09 Mar 2005) | 5 lines

New event service recovery code implementation for totem and the new
sync services.

(Logical change 1.144)

------------------------------------------------------------------------
r513 | osdl.net!markh | 2005-03-09 15:08:07 -0700 (Wed, 09 Mar 2005) | 5 lines

New event service recovery code implementation for totem and the new
sync services.

BKrev: 422f73c7NkihQaud_tc4WYQOjavwhg

------------------------------------------------------------------------
r512 | mvista.com!sdake | 2005-03-09 12:46:11 -0700 (Wed, 09 Mar 2005) | 4 lines

Cluster membership synchronization support

(Logical change 1.143)

------------------------------------------------------------------------
r511 | mvista.com!sdake | 2005-03-09 12:46:11 -0700 (Wed, 09 Mar 2005) | 5 lines

clm.c:
  Cluster membership synchronization support

BKrev: 422f5283JgT5AkInLBoHrZMu0wx2rQ

------------------------------------------------------------------------
r510 | mvista.com!sdake | 2005-03-02 15:10:45 -0700 (Wed, 02 Mar 2005) | 13 lines

Added synchronization base code.  Four new APIs are required for a service
to support synchronization.  sync_init, sync_process, sync_activate, and
sync_abort provide the calls into the recovery mechanism.

sync.h, sync.c:
  new file
totemsrp.h, totemsrp.c, print.h, print.c, Makefile, main.c, handlers.h:
  Synchronization base code added.
ipc_gen.h:
  Synchronization base code.

BKrev: 422639e5L_FEDTWgRgI-w8vKm8zhMQ

------------------------------------------------------------------------
r509 | mvista.com!sdake | 2005-03-02 15:10:45 -0700 (Wed, 02 Mar 2005) | 4 lines

Synchronization base code.

(Logical change 1.142)

------------------------------------------------------------------------
r508 | mvista.com!sdake | 2005-03-02 15:10:45 -0700 (Wed, 02 Mar 2005) | 4 lines

Synchronization base code added.

(Logical change 1.142)

------------------------------------------------------------------------
r507 | mvista.com!sdake | 2005-03-02 15:10:45 -0700 (Wed, 02 Mar 2005) | 2 lines

(Logical change 1.142)

------------------------------------------------------------------------
r506 | mvista.com!sdake | 2005-03-02 15:10:44 -0700 (Wed, 02 Mar 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r505 | broked.org!sdake | 2005-02-26 23:27:31 -0700 (Sat, 26 Feb 2005) | 4 lines

em64t support

(Logical change 1.141)

------------------------------------------------------------------------
r504 | broked.org!sdake | 2005-02-26 23:27:31 -0700 (Sat, 26 Feb 2005) | 5 lines

Many files:
  em64t support

BKrev: 42216853DGp9Hwgh8mvnixFj_QMRUQ

------------------------------------------------------------------------
r503 | mvista.com!sdake | 2005-02-18 12:56:58 -0700 (Fri, 18 Feb 2005) | 5 lines

Many files:
  Pass handle by value instead of address.

BKrev: 4216488aoAf2Eu5qvs7qGxx8rO9zXw

------------------------------------------------------------------------
r502 | mvista.com!sdake | 2005-02-18 12:56:58 -0700 (Fri, 18 Feb 2005) | 4 lines

Pass handle by value instead of address.

(Logical change 1.140)

------------------------------------------------------------------------
r501 | mvista.com!sdake | 2005-02-16 17:25:01 -0700 (Wed, 16 Feb 2005) | 7 lines

Auto merged

2005/02/16 17:24:12-07:00 mvista.com!sdake
send ring_id through configuration changes patch from Muni Bajpai.

(Logical change 1.139)

------------------------------------------------------------------------
r500 | mvista.com!sdake | 2005-02-16 17:25:01 -0700 (Wed, 16 Feb 2005) | 11 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2005/02/16 17:24:48-07:00 mvista.com!sdake
Many files:
  send ring_id through configuration changes patch from Muni Bajpai.
clm.c:
  mutex bug fixes as reported by Kristen Smith.

BKrev: 4213e45dnMl87bYQKSfi4_98X352Lg

------------------------------------------------------------------------
r499 | mvista.com!sdake | 2005-02-16 17:25:01 -0700 (Wed, 16 Feb 2005) | 4 lines

send ring_id through configuration changes patch from Muni Bajpai.

(Logical change 1.139)

------------------------------------------------------------------------
r498 | mvista.com!sdake | 2005-02-16 17:25:01 -0700 (Wed, 16 Feb 2005) | 4 lines

mutex bug fixes as reported by Kristen Smith.

(Logical change 1.139)

------------------------------------------------------------------------
r497 | osdl.net!markh | 2005-02-15 16:10:40 -0700 (Tue, 15 Feb 2005) | 4 lines

Look for SA_EVT_EVENTID_LOST when receiving an event.

(Logical change 1.138)

------------------------------------------------------------------------
r496 | osdl.net!markh | 2005-02-15 16:10:40 -0700 (Tue, 15 Feb 2005) | 4 lines

Set default event ID.

(Logical change 1.138)

------------------------------------------------------------------------
r495 | osdl.net!markh | 2005-02-15 16:10:40 -0700 (Tue, 15 Feb 2005) | 4 lines

Set lost event ID on dropped events.

(Logical change 1.138)

------------------------------------------------------------------------
r494 | osdl.net!markh | 2005-02-15 16:10:40 -0700 (Tue, 15 Feb 2005) | 5 lines

Use special event ID for setting the default in a new event and to indicate
a lost event.  Update subscription test to look for the "lost" event ID.

BKrev: 42128170Q5DcNymwbx8NushEykXwmg

------------------------------------------------------------------------
r493 | osdl.net!markh | 2005-02-15 09:54:46 -0700 (Tue, 15 Feb 2005) | 4 lines

Add unlink function.

(Logical change 1.137)

------------------------------------------------------------------------
r492 | osdl.net!markh | 2005-02-15 09:54:46 -0700 (Tue, 15 Feb 2005) | 8 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_work

2005/02/15 08:54:34-08:00 osdl.net!markh
Add unlink function.

BKrev: 42122956O-InvJqb6K70vMTy4gl8yQ

------------------------------------------------------------------------
r491 | mvista.com!sdake | 2005-02-08 17:34:16 -0700 (Tue, 08 Feb 2005) | 4 lines

Increase code coverage by calling more API functions.

(Logical change 1.136)

------------------------------------------------------------------------
r490 | mvista.com!sdake | 2005-02-08 17:34:16 -0700 (Tue, 08 Feb 2005) | 10 lines

testevs.c, testckpt.c:
  Increase code coverage by calling more API functions.
testamf.c:
  Fix bug in test script which was causing test not to run.
  Increase code coverage by allowing few more apis to be called.
totemsrp.c:
  Increase code coverage by removing some debug code

BKrev: 42095a88Q0lU2eqEirC1FAZ05pxlmg

------------------------------------------------------------------------
r489 | mvista.com!sdake | 2005-02-08 17:34:16 -0700 (Tue, 08 Feb 2005) | 5 lines

Fix bug in test script which was causing test not to run.
Increase code coverage by allowing few more apis to be called.

(Logical change 1.136)

------------------------------------------------------------------------
r488 | mvista.com!sdake | 2005-02-08 17:34:16 -0700 (Tue, 08 Feb 2005) | 4 lines

Increase code coverage by removing some debug code

(Logical change 1.136)

------------------------------------------------------------------------
r487 | mvista.com!sdake | 2005-02-08 13:56:38 -0700 (Tue, 08 Feb 2005) | 2 lines

(Logical change 1.135)

------------------------------------------------------------------------
r486 | mvista.com!sdake | 2005-02-08 13:56:38 -0700 (Tue, 08 Feb 2005) | 11 lines

Many files:
  defect 245 - revise checkpoint service to B.01.01.
saCkpt.h, ipc_ckpt.h, sa_error.h:
  new file
.del-ais_clm.h~ed02cd4c7506e43:
  Delete: include/ais_clm.h
.del-ais_ckpt.h~b3c15abf536a6fbc:
  Delete: include/ais_ckpt.h

BKrev: 42092786pSJQ8uC11PWAhWTC1Hwjqw

------------------------------------------------------------------------
r485 | mvista.com!sdake | 2005-02-08 13:56:38 -0700 (Tue, 08 Feb 2005) | 4 lines

defect 245 - revise checkpoint service to B.01.01.

(Logical change 1.135)

------------------------------------------------------------------------
r484 | mvista.com!sdake | 2005-02-08 13:56:38 -0700 (Tue, 08 Feb 2005) | 4 lines

Delete: include/ais_ckpt.h

}(Logical change 1.135)

------------------------------------------------------------------------
r483 | mvista.com!sdake | 2005-02-08 13:56:38 -0700 (Tue, 08 Feb 2005) | 4 lines

Delete: include/ais_clm.h

}(Logical change 1.135)

------------------------------------------------------------------------
r482 | mvista.com!sdake | 2005-02-08 13:56:37 -0700 (Tue, 08 Feb 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r481 | mvista.com!sdake | 2005-02-08 13:51:46 -0700 (Tue, 08 Feb 2005) | 9 lines

totemsrp.c:
  Add more text output to display what occurs during recovery.
  Fix recovery bug which results in segfault.
  fix defect 228 - ring id file deleted causes assert.
  Fix recovery bug where recovery doesn't complete.
  Fix assert on commit phase.

BKrev: 42092662LEVSqJlhbISw-Hweb4Cbfg

------------------------------------------------------------------------
r480 | mvista.com!sdake | 2005-02-08 13:51:46 -0700 (Tue, 08 Feb 2005) | 8 lines

Add more text output to display what occurs during recovery.
Fix recovery bug which results in segfault.
fix defect 228 - ring id file deleted causes assert.
Fix recovery bug where recovery doesn't complete.
Fix assert on commit phase.

(Logical change 1.134)

------------------------------------------------------------------------
r479 | osdl.net!markh | 2005-02-08 10:16:52 -0700 (Tue, 08 Feb 2005) | 4 lines

Add test for channel open async

(Logical change 1.133)

------------------------------------------------------------------------
r478 | osdl.net!markh | 2005-02-08 10:16:52 -0700 (Tue, 08 Feb 2005) | 4 lines

Add handler for channel open async

(Logical change 1.133)

------------------------------------------------------------------------
r477 | osdl.net!markh | 2005-02-08 10:16:52 -0700 (Tue, 08 Feb 2005) | 7 lines

Add handler for channel open async and add a test to
testevt for the async channel open function.
Bug fix for event retention time clear exec code and added comments
when converting nanoseconds to milliseconds.

BKrev: 4208f4048DxJP7FLwfqHo7TfAoEJlA

------------------------------------------------------------------------
r476 | osdl.net!markh | 2005-02-04 14:33:20 -0700 (Fri, 04 Feb 2005) | 7 lines

This fixes a potential problem where, because of a config change, a joining
node may not have a previous fragment of a message.  It now discards
continuations of that message until it is complete and a new message
arrives.

(Logical change 1.132)

------------------------------------------------------------------------
r475 | osdl.net!markh | 2005-02-04 14:33:20 -0700 (Fri, 04 Feb 2005) | 7 lines

This fixes a potential problem where, because of a config change, a joining
node may not have a previous fragment of a message.  It now discards
continuations of that message until it is complete and a new message
arrives.

BKrev: 4203ea20pYSrD8ZyY3pxIHSXFSooeg

------------------------------------------------------------------------
r474 | osdl.net!markh | 2005-02-04 14:22:13 -0700 (Fri, 04 Feb 2005) | 4 lines

Remove ais_evt.h since its content has been moved.

BKrev: 4203e785HE6cQ-KCAgc-CHHOiZ0tEg

------------------------------------------------------------------------
r473 | osdl.net!markh | 2005-02-04 14:22:13 -0700 (Fri, 04 Feb 2005) | 4 lines

Delete: include/ais_evt.h

}(Logical change 1.131)

------------------------------------------------------------------------
r472 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 4 lines

Update to B spec API

(Logical change 1.130)

------------------------------------------------------------------------
r471 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 4 lines

Update event service to B spec API.

BKrev: 4203e6d8nLXD7EMTNFZNfFwMnzt8mA

------------------------------------------------------------------------
r470 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 4 lines

Conver to B spec API.

(Logical change 1.130)

------------------------------------------------------------------------
r469 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 4 lines

update dependencies.

(Logical change 1.130)

------------------------------------------------------------------------
r468 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 2 lines

(Logical change 1.130)

------------------------------------------------------------------------
r467 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 5 lines

Update evt to B spec
remove event related code and move to ipc_evt.h and saEvt.h

(Logical change 1.130)

------------------------------------------------------------------------
r466 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 4 lines

Use B spec include files

(Logical change 1.130)

------------------------------------------------------------------------
r465 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 5 lines

Convert to B spec.
Add in endian conversion functions.

(Logical change 1.130)

------------------------------------------------------------------------
r464 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 4 lines

Moved from ais_msg.h so ais_msg.h doesn't need to be included by evt.

(Logical change 1.130)

------------------------------------------------------------------------
r463 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 5 lines

update evt to B spec.
remove evt related code and move to ipc_evt.h and saEvt.h

(Logical change 1.130)

------------------------------------------------------------------------
r462 | osdl.net!markh | 2005-02-04 14:19:20 -0700 (Fri, 04 Feb 2005) | 4 lines

update dependencies

(Logical change 1.130)

------------------------------------------------------------------------
r461 | osdl.net!markh | 2005-02-04 14:19:19 -0700 (Fri, 04 Feb 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r460 | mvista.com!sdake | 2005-02-04 12:56:15 -0700 (Fri, 04 Feb 2005) | 5 lines

util.c:
  Fix merge error in util.c file

BKrev: 4203d35fqEwtXJ4ZtIAnGz5HWpHsEQ

------------------------------------------------------------------------
r459 | mvista.com!sdake | 2005-02-04 12:56:15 -0700 (Fri, 04 Feb 2005) | 4 lines

Fix merge error in util.c file

(Logical change 1.129)

------------------------------------------------------------------------
r458 | mvista.com!sdake | 2005-02-04 12:54:01 -0700 (Fri, 04 Feb 2005) | 4 lines

Small fix for data types.

(Logical change 1.128)

------------------------------------------------------------------------
r457 | mvista.com!sdake | 2005-02-04 12:54:01 -0700 (Fri, 04 Feb 2005) | 5 lines

util.c:
  Small fix for data types.

BKrev: 4203d2d97z9HmoblaHq8etKUqRGF0w

------------------------------------------------------------------------
r456 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

Update to use 64 bit data types for handles.

(Logical change 1.127)

------------------------------------------------------------------------
r455 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 23 lines

testamf1.c, testamf2.c:
  64 bit handles.
testevs.c, testclm.c, testamfth.c, testamf6.c, testamf4.c, testamf3.c:
  64 bit handles
evs.h:
  change data type of handle to 64 bits for evs_handle_t.
ais_types.h:
  remove cluster membership types and put in saClm.h file.
ais_msg.h:
  remove cluster membership code and put in ipc file.
util.h, util.c:
  Update to use 64 bit data types for handles.
clm.c:
  Update cluster membership to B.01.01.
print.h:
  Update print data to new node structure.
clm.h, clm.c:
  Update cluster membership service to B.01.01.
saClm.h, ipc_gen.h, ipc_clm.h:
  new file

BKrev: 4203ce72I415G1q4yQQNjFfAxSJVOA

------------------------------------------------------------------------
r454 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

64 bit handles

(Logical change 1.127)

------------------------------------------------------------------------
r453 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

remove cluster membership code and put in ipc file.

(Logical change 1.127)

------------------------------------------------------------------------
r452 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

Update cluster membership service to B.01.01.

(Logical change 1.127)

------------------------------------------------------------------------
r451 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 2 lines

(Logical change 1.127)

------------------------------------------------------------------------
r450 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

64 bit handles.

(Logical change 1.127)

------------------------------------------------------------------------
r449 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

Update print data to new node structure.

(Logical change 1.127)

------------------------------------------------------------------------
r448 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

remove cluster membership types and put in saClm.h file.

(Logical change 1.127)

------------------------------------------------------------------------
r447 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

change data type of handle to 64 bits for evs_handle_t.

(Logical change 1.127)

------------------------------------------------------------------------
r446 | mvista.com!sdake | 2005-02-04 12:35:14 -0700 (Fri, 04 Feb 2005) | 4 lines

Update cluster membership to B.01.01.

(Logical change 1.127)

------------------------------------------------------------------------
r445 | mvista.com!sdake | 2005-02-04 12:35:13 -0700 (Fri, 04 Feb 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r444 | mvista.com!sdake | 2005-02-01 13:40:07 -0700 (Tue, 01 Feb 2005) | 4 lines

fix defect 131 - member element not set in cluster membership service

(Logical change 1.126)

------------------------------------------------------------------------
r443 | mvista.com!sdake | 2005-02-01 13:40:07 -0700 (Tue, 01 Feb 2005) | 9 lines

More fixes for defect 204.  From Mark Haverkamp:
|Looking at the totempg config change function, I think that leaving
|members should have their assembly area reset.  I assume that any data
|that is there is now invalid, and we wouldn't want it hanging around if
|they return.  Also, I think that the wrong index was being used to
|initialize the assembly area index.

(Logical change 1.126)

------------------------------------------------------------------------
r442 | mvista.com!sdake | 2005-02-01 13:40:07 -0700 (Tue, 01 Feb 2005) | 12 lines

totempg.c:
  More fixes for defect 204.  From Mark Haverkamp:
  |Looking at the totempg config change function, I think that leaving
  |members should have their assembly area reset.  I assume that any data
  |that is there is now invalid, and we wouldn't want it hanging around if
  |they return.  Also, I think that the wrong index was being used to
  |initialize the assembly area index.
clm.c:
  fix defect 131 - member element not set in cluster membership service

BKrev: 41ffe9278sM8ZyWmj_3tmUK0YiqgSQ

------------------------------------------------------------------------
r441 | mvista.com!sdake | 2005-01-31 15:07:48 -0700 (Mon, 31 Jan 2005) | 5 lines

Fix from mark and daniel for small packet sizes in totempg resulting
in segfault.

(Logical change 1.125)

------------------------------------------------------------------------
r440 | mvista.com!sdake | 2005-01-31 15:07:48 -0700 (Mon, 31 Jan 2005) | 4 lines

random drop defined to on..  turning off.

(Logical change 1.125)

------------------------------------------------------------------------
r439 | mvista.com!sdake | 2005-01-31 15:07:48 -0700 (Mon, 31 Jan 2005) | 8 lines

totemsrp.c:
  random drop defined to on..  turning off.
totempg.c:
  Fix from mark and daniel for small packet sizes in totempg resulting
  in segfault.

BKrev: 41feac34ILMg8MsBZNAXgHefIA22zw

------------------------------------------------------------------------
r438 | mvista.com!sdake | 2005-01-31 12:53:30 -0700 (Mon, 31 Jan 2005) | 6 lines

totempg.c:
  Fixes defect 204 : messages not delivered correctly
  Patch from Mark Haverkamp.

BKrev: 41fe8cbaM4eR7_3dP91qFSahtT23dA

------------------------------------------------------------------------
r437 | mvista.com!sdake | 2005-01-31 12:53:30 -0700 (Mon, 31 Jan 2005) | 5 lines

Fixes defect 204 : messages not delivered correctly
Patch from Mark Haverkamp.

(Logical change 1.124)

------------------------------------------------------------------------
r436 | mvista.com!sdake | 2005-01-31 12:52:36 -0700 (Mon, 31 Jan 2005) | 4 lines

Fix bug in implementation that deviates from specification.

(Logical change 1.123)

------------------------------------------------------------------------
r435 | mvista.com!sdake | 2005-01-31 12:52:36 -0700 (Mon, 31 Jan 2005) | 5 lines

totemsrp.c:
  Fix bug in implementation that deviates from specification.

BKrev: 41fe8c84mIHGgf3brH_kZTiOR_ACvQ

------------------------------------------------------------------------
r434 | mvista.com!sdake | 2005-01-29 11:30:56 -0700 (Sat, 29 Jan 2005) | 5 lines

bug 214
Fix pthread mutex not unlocked in error path

(Logical change 1.122)

------------------------------------------------------------------------
r433 | mvista.com!sdake | 2005-01-29 11:30:56 -0700 (Sat, 29 Jan 2005) | 5 lines

remove priority fields from evs service.
..

(Logical change 1.122)

------------------------------------------------------------------------
r432 | mvista.com!sdake | 2005-01-29 11:30:56 -0700 (Sat, 29 Jan 2005) | 4 lines

remove priority fields from evs service.

(Logical change 1.122)

------------------------------------------------------------------------
r431 | mvista.com!sdake | 2005-01-29 11:30:56 -0700 (Sat, 29 Jan 2005) | 11 lines

evs_mcast_joined.3:
  remove priority fields from evs service.
  ..
evs_mcast_groups.3, evs.h, ais_msg.h:
  remove priority fields from evs service.
util.c:
  bug 214
  Fix pthread mutex not unlocked in error path

BKrev: 41fbd660W-BROulgsZt4S6LYD_pcvw

------------------------------------------------------------------------
r430 | mvista.com!sdake | 2005-01-27 12:37:39 -0700 (Thu, 27 Jan 2005) | 9 lines

testevs.c, evsbench.c:
  Remove priorities from interfaces.
evs.c:
  Remove priorities from evs interfaces.
totempg.h, totempg.c, main.c, handlers.h, evt.c, evs.c, clm.c, ckpt.c, amf.c:
  Remove priorities from all interfaces.

BKrev: 41f943030jN3Y5g5v10371Hgb2007A

------------------------------------------------------------------------
r429 | mvista.com!sdake | 2005-01-27 12:37:39 -0700 (Thu, 27 Jan 2005) | 4 lines

Remove priorities from evs interfaces.

(Logical change 1.121)

------------------------------------------------------------------------
r428 | mvista.com!sdake | 2005-01-27 12:37:39 -0700 (Thu, 27 Jan 2005) | 4 lines

Remove priorities from interfaces.

(Logical change 1.121)

------------------------------------------------------------------------
r427 | mvista.com!sdake | 2005-01-27 12:37:39 -0700 (Thu, 27 Jan 2005) | 4 lines

Remove priorities from all interfaces.

(Logical change 1.121)

------------------------------------------------------------------------
r426 | mvista.com!sdake | 2005-01-24 12:44:07 -0700 (Mon, 24 Jan 2005) | 4 lines

Fix defect 203 commit token asserts

(Logical change 1.120)

------------------------------------------------------------------------
r425 | mvista.com!sdake | 2005-01-24 12:44:07 -0700 (Mon, 24 Jan 2005) | 5 lines

totemsrp.c:
  Fix defect 203 commit token asserts

BKrev: 41f55007suViMhWrhOICprHxyacUwg

------------------------------------------------------------------------
r424 | osdl.net!markh | 2005-01-24 12:04:45 -0700 (Mon, 24 Jan 2005) | 6 lines

Small fixes.
evt: fix member count until recovery code is done.
totempg: remove dbug print.

BKrev: 41f546cd0Fq27HJzalqHeE69x99WKg

------------------------------------------------------------------------
r423 | osdl.net!markh | 2005-01-24 12:04:45 -0700 (Mon, 24 Jan 2005) | 4 lines

Temp config change code

(Logical change 1.119)

------------------------------------------------------------------------
r422 | osdl.net!markh | 2005-01-24 12:04:45 -0700 (Mon, 24 Jan 2005) | 4 lines

remove debug print

(Logical change 1.119)

------------------------------------------------------------------------
r421 | broked.org!sdake | 2005-01-22 14:28:45 -0700 (Sat, 22 Jan 2005) | 4 lines

Remove random dropping of packets in released version.

(Logical change 1.118)

------------------------------------------------------------------------
r420 | broked.org!sdake | 2005-01-22 14:28:45 -0700 (Sat, 22 Jan 2005) | 5 lines

totemsrp.c:
  Remove random dropping of packets in released version.

BKrev: 41f2c58dbLMQ6YcKCJxEwIKRUk7lxw

------------------------------------------------------------------------
r419 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

update to new totem code

(Logical change 1.117)

------------------------------------------------------------------------
r418 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

enable some testing code.

(Logical change 1.117)

------------------------------------------------------------------------
r417 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

Add test.cpp to makefile

(Logical change 1.117)

------------------------------------------------------------------------
r416 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

Delete: exec/gmi.c

}(Logical change 1.117)

------------------------------------------------------------------------
r415 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

new benchmark runs for 10 seconds.

(Logical change 1.117)

------------------------------------------------------------------------
r414 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

update to new crypto code

(Logical change 1.117)

------------------------------------------------------------------------
r413 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

update to new crypto code.

(Logical change 1.117)

------------------------------------------------------------------------
r412 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 2 lines

(Logical change 1.117)

------------------------------------------------------------------------
r411 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 23 lines

Makefile:
  Add test.cpp to makefile
testckpt.c:
  enable some testing code.
evsbench.c, ckptbench.c:
  new benchmark runs for 10 seconds.
test.cpp, rmd.h, totemsrp.h, totemsrp.c, totempg.h, totempg.c, swab.h:
  new file
sq.h, Makefile, evt.c, evs.c, clm.c, amf.c, crypto.c, ckpt.c, aispoll.c:
  update to new totem code.
queue.h, ais_msg.h:
  update to new totem code
parse.h, parse.c, Makefile, main.h:
  update to new crypto code
main.c, handlers.h:
  update to new crypto code.
.del-gmi.h~7d81bcdb10af22b3:
  Delete: exec/gmi.h
.del-gmi.c~df0f77a7b91ff206:
  Delete: exec/gmi.c

BKrev: 41f2bdd3a_mEhs2wkBZHsD4_aft9vA

------------------------------------------------------------------------
r410 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

update to new totem code.

(Logical change 1.117)

------------------------------------------------------------------------
r409 | mvista.com!sdake | 2005-01-22 13:55:47 -0700 (Sat, 22 Jan 2005) | 4 lines

Delete: exec/gmi.h

}(Logical change 1.117)

------------------------------------------------------------------------
r408 | mvista.com!sdake | 2005-01-22 13:55:46 -0700 (Sat, 22 Jan 2005) | 2 lines

Initial revision

------------------------------------------------------------------------
r407 | osdl.net!markh | 2005-01-11 09:59:10 -0700 (Tue, 11 Jan 2005) | 4 lines

add in missing mutex unlock

BKrev: 41e405deOyfzWPCaxv7_aIpgxL5C5g

------------------------------------------------------------------------
r406 | osdl.net!markh | 2005-01-11 09:59:10 -0700 (Tue, 11 Jan 2005) | 4 lines

add in missing mutex unlock

(Logical change 1.116)

------------------------------------------------------------------------
r405 | osdl.net!markh | 2005-01-11 09:35:28 -0700 (Tue, 11 Jan 2005) | 4 lines

Need to specify create because the channel probably doesn't exist anymore.

BKrev: 41e40050NKYAEN3N5kB1-R-klUXqUQ

------------------------------------------------------------------------
r404 | osdl.net!markh | 2005-01-11 09:35:28 -0700 (Tue, 11 Jan 2005) | 4 lines

Need to specify create because the channel probably doesn't exist anymore.

(Logical change 1.115)

------------------------------------------------------------------------
r403 | sakai!sakai | 2005-01-10 08:28:00 -0700 (Mon, 10 Jan 2005) | 5 lines

amf.c:
  For Protection Group Tracking Bug

BKrev: 41e29f00Yz2GqTwTyBhpW_zo6WjI1Q

------------------------------------------------------------------------
r402 | sakai!sakai | 2005-01-10 08:28:00 -0700 (Mon, 10 Jan 2005) | 4 lines

For Protection Group Tracking Bug

(Logical change 1.114)

------------------------------------------------------------------------
r401 | mvista.com!sdake | 2005-01-08 10:53:32 -0700 (Sat, 08 Jan 2005) | 5 lines

tlist.h:
  Fix required for previous tlist.c commit.

BKrev: 41e01e1cFsurlTBuApZjiZ3l9RFdBw

------------------------------------------------------------------------
r400 | mvista.com!sdake | 2005-01-08 10:53:32 -0700 (Sat, 08 Jan 2005) | 4 lines

Fix required for previous tlist.c commit.

(Logical change 1.113)

------------------------------------------------------------------------
r399 | mvista.com!sdake | 2005-01-08 02:16:42 -0700 (Sat, 08 Jan 2005) | 13 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2005/01/08 02:16:10-07:00 mvista.com!sdake
tlist.c:
  Fix use of memory area after free when timer_fn deletes a timer.
  The 3 cases are:
  1. timer_fn deletes its own timer
  2. timer_fn deletes next timer after its own timer
  3. timer_fn deletes any other timer

BKrev: 41dfa4faNWgA_s0fcyzlj-jhOFNKAA

------------------------------------------------------------------------
r398 | mvista.com!sdake | 2005-01-08 02:16:42 -0700 (Sat, 08 Jan 2005) | 8 lines

Fix use of memory area after free when timer_fn deletes a timer.
The 3 cases are:
1. timer_fn deletes its own timer
2. timer_fn deletes next timer after its own timer
3. timer_fn deletes any other timer

(Logical change 1.112)

------------------------------------------------------------------------
r397 | broked.org!sdake | 2005-01-07 13:21:11 -0700 (Fri, 07 Jan 2005) | 5 lines

evs.c, clm.c, amf.c:
  Fix missing unlock in error conditions reported by Kristen Smith

BKrev: 41deef37lfq4PXPbgolOpenG8xUJYg

------------------------------------------------------------------------
r396 | broked.org!sdake | 2005-01-07 13:21:11 -0700 (Fri, 07 Jan 2005) | 4 lines

Fix missing unlock in error conditions reported by Kristen Smith

(Logical change 1.111)

------------------------------------------------------------------------
r395 | nortelnetworks.com!kjsmith | 2005-01-07 10:28:29 -0700 (Fri, 07 Jan 2005) | 4 lines

Add missing mutex unlocks in evt dispatch function.

BKrev: 41dec6bdm_JzS8aFCPMDziJhBZprSw

------------------------------------------------------------------------
r394 | nortelnetworks.com!kjsmith | 2005-01-07 10:28:29 -0700 (Fri, 07 Jan 2005) | 28 lines

I was running into a problem where the evt api appeared to be getting into a
deadlock situtation. The problem would occur when I would kill aisexec
while my program was running (using EVT and CLM apis). My program is
multi-threaded where 1 thread is calling evtDispatch and other threads
can be calling evtPublish at various times. The problem I ran into is when I
killed aisexec, the evtDispatch would take a lock, but never give it back.
At the same time, my sending thread would call evtPublish which would take
the lock and hang since evtDispatch never gave up the lock it took.

The fix was to add a few unlocks in evt.c where they appeared to be missing.
Here is the info:

1) line 504 in evt.c (lib dir) calls

pthread_mutex_unlock(&evti->ei_mutex);
goto error_unlock;

2) There are subsequent calls to goto error_unlock in later error statements
that do not unlock the mutex before the goto call - the lines are 534 and 541

Adding the unlock right before the goto @ 534 and @ 541 fixes the deadlock
for my scenario.

Kristen Smith
Nortel Networks

(Logical change 1.110)

------------------------------------------------------------------------
r393 | mvista.com!sdake | 2004-11-29 13:10:07 -0700 (Mon, 29 Nov 2004) | 4 lines

Improve code coverage by testing a few more APIs in the AMF.

(Logical change 1.109)

------------------------------------------------------------------------
r392 | mvista.com!sdake | 2004-11-29 13:10:07 -0700 (Mon, 29 Nov 2004) | 5 lines

testamf.c:
  Improve code coverage by testing a few more APIs in the AMF.

BKrev: 41ab821fPmG01mXBZYuPJWKuOLHj5A

------------------------------------------------------------------------
r391 | mvista.com!sdake | 2004-11-24 16:48:25 -0700 (Wed, 24 Nov 2004) | 4 lines

code coverage work cleanup

(Logical change 1.108)

------------------------------------------------------------------------
r390 | mvista.com!sdake | 2004-11-24 16:48:25 -0700 (Wed, 24 Nov 2004) | 4 lines

fix double ;; which causes gcc 2.95 to fail to compile

(Logical change 1.108)

------------------------------------------------------------------------
r389 | mvista.com!sdake | 2004-11-24 16:48:25 -0700 (Wed, 24 Nov 2004) | 7 lines

testparse.c:
  code coverage work cleanup
evt.c:
  fix double ;; which causes gcc 2.95 to fail to compile

BKrev: 41a51dc9RLGeGsr9z5GLjSGzFovoKQ

------------------------------------------------------------------------
r388 | mvista.com!sdake | 2004-11-24 16:28:48 -0700 (Wed, 24 Nov 2004) | 4 lines

correct stack corruption when logging data.

(Logical change 1.107)

------------------------------------------------------------------------
r387 | mvista.com!sdake | 2004-11-24 16:28:48 -0700 (Wed, 24 Nov 2004) | 4 lines

remove extra printf from gmi.

(Logical change 1.107)

------------------------------------------------------------------------
r386 | mvista.com!sdake | 2004-11-24 16:28:48 -0700 (Wed, 24 Nov 2004) | 7 lines

parse.c:
  correct stack corruption when logging data.
gmi.c:
  remove extra printf from gmi.

BKrev: 41a51930u36bUFf2s34EDiXBXWb-1Q

------------------------------------------------------------------------
r385 | mvista.com!sdake | 2004-11-24 15:32:21 -0700 (Wed, 24 Nov 2004) | 4 lines

Fix compile with gcc 2.95.

(Logical change 1.106)

------------------------------------------------------------------------
r384 | mvista.com!sdake | 2004-11-24 15:32:21 -0700 (Wed, 24 Nov 2004) | 5 lines

gmi.c, amf.c:
  Fix compile with gcc 2.95.

BKrev: 41a50bf5bDdOboBSLlLamrDIChW6LQ

------------------------------------------------------------------------
r383 | mvista.com!sdake | 2004-11-12 12:17:34 -0700 (Fri, 12 Nov 2004) | 6 lines

evs.c:
  Kristen Smith reported a bug where evs would return 0.0.0.0 in the
  source address.  This patch fixes that defect 182.

BKrev: 41950c4eWm2WAOmtw1VmnIPUzCirKw

------------------------------------------------------------------------
r382 | mvista.com!sdake | 2004-11-12 12:17:34 -0700 (Fri, 12 Nov 2004) | 5 lines

Kristen Smith reported a bug where evs would return 0.0.0.0 in the
source address.  This patch fixes that defect 182.

(Logical change 1.105)

------------------------------------------------------------------------
r381 | somacoma.net!dns | 2004-11-07 16:33:57 -0700 (Sun, 07 Nov 2004) | 8 lines

Merge

2004/10/29 00:13:35+02:00 somacoma.net!dns
evt.c:
  Fix type-punning warnings with gcc-3.3 and later.

BKrev: 418eb0e5AwiqPJ0GA8LlrTmNOv1pVQ

------------------------------------------------------------------------
r380 | somacoma.net!dns | 2004-11-07 16:33:57 -0700 (Sun, 07 Nov 2004) | 4 lines

Fix type-punning warnings with gcc-3.3 and later.

(Logical change 1.104)

------------------------------------------------------------------------
r379 | mvista.com!sdake | 2004-11-06 10:42:26 -0700 (Sat, 06 Nov 2004) | 5 lines

Commit timeout wasn't stopped when entering gather state.  This patch stops
the commit timeout when the gather state is entered.

(Logical change 1.103)

------------------------------------------------------------------------
r378 | mvista.com!sdake | 2004-11-06 10:42:26 -0700 (Sat, 06 Nov 2004) | 10 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2004/11/06 10:42:19-07:00 mvista.com!sdake
gmi.c:
  Commit timeout wasn't stopped when entering gather state.  This patch stops
  the commit timeout when the gather state is entered.

BKrev: 418d0d02UJqL-86F2zLxnkruJk2Z7Q

------------------------------------------------------------------------
r377 | sakai!sakai | 2004-11-05 09:29:29 -0700 (Fri, 05 Nov 2004) | 7 lines

Makefile:
  append keygen.o to clean target
amf.c:
  match function name to coding style

BKrev: 418baa69pjW8OB2yd60kweHMtHG5Fg

------------------------------------------------------------------------
r376 | sakai!sakai | 2004-11-05 09:29:29 -0700 (Fri, 05 Nov 2004) | 4 lines

match function name to coding style

(Logical change 1.102)

------------------------------------------------------------------------
r375 | sakai!sakai | 2004-11-05 09:29:29 -0700 (Fri, 05 Nov 2004) | 4 lines

append keygen.o to clean target

(Logical change 1.102)

------------------------------------------------------------------------
r374 | sakai!sakai | 2004-11-04 15:37:03 -0700 (Thu, 04 Nov 2004) | 4 lines

implement gmi_token_callback in amf.c

(Logical change 1.101)

------------------------------------------------------------------------
r373 | sakai!sakai | 2004-11-04 15:37:03 -0700 (Thu, 04 Nov 2004) | 7 lines

Makefile:
  get rid of make error
amf.c:
  implement gmi_token_callback in amf.c

BKrev: 418aaf0fKs_99rjhstkG78ZR02mT9g

------------------------------------------------------------------------
r372 | sakai!sakai | 2004-11-04 15:37:03 -0700 (Thu, 04 Nov 2004) | 4 lines

get rid of make error

(Logical change 1.101)

------------------------------------------------------------------------
r371 | sakai!sakai | 2004-11-02 14:02:49 -0700 (Tue, 02 Nov 2004) | 4 lines

fix wrong Hastat after node join

(Logical change 1.100)

------------------------------------------------------------------------
r370 | sakai!sakai | 2004-11-02 14:02:49 -0700 (Tue, 02 Nov 2004) | 4 lines

fix wrong HaStat after node join

(Logical change 1.100)

------------------------------------------------------------------------
r369 | mvista.com!sdake | 2004-11-02 14:02:49 -0700 (Tue, 02 Nov 2004) | 11 lines

Merge persist.az.mvista.com:/home/sdake/openais
into persist.az.mvista.com:/export/hadev/openais/defect-174

2004/10/31 00:48:17+09:00 sakai!sakai
ais_msg.h:
  fix wrong Hastat after node join
amf.c:
  fix wrong HaStat after node join

BKrev: 4187f5f99iXw5l-V34v_kR2YTLDpgg

------------------------------------------------------------------------
r368 | mvista.com!sdake | 2004-10-29 17:07:11 -0700 (Fri, 29 Oct 2004) | 4 lines

Add rlimit code to allow openais to work with linux kernel 2.6.9 or later

(Logical change 1.99)

------------------------------------------------------------------------
r367 | mvista.com!sdake | 2004-10-29 17:07:11 -0700 (Fri, 29 Oct 2004) | 4 lines

Add rlimit code to allow openais to work with linux kernel 2.6.9 or later

BKrev: 4182db2fMpOhxCxRnyhHxC5YOCUhvg

------------------------------------------------------------------------
r366 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

64bit safe ais types

(Logical change 1.98)

------------------------------------------------------------------------
r365 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

Remove specific o files instead of all objects.

(Logical change 1.98)

------------------------------------------------------------------------
r364 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

Type checking changes for printf's

(Logical change 1.98)

------------------------------------------------------------------------
r363 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

Fix off by one which oculd cause invalid handle to be used.

(Logical change 1.98)

------------------------------------------------------------------------
r362 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

Fix off by one which could cause invalid handle to be used.

(Logical change 1.98)

------------------------------------------------------------------------
r361 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

type safeness printing.

(Logical change 1.98)

------------------------------------------------------------------------
r360 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 24 lines

Several fixes by Daniel Stodden.  Possible crash on invalid handle fixed in library
and executive.  Also parser could crash when out of memory occurs.

util.c:
  Fix off by one which oculd cause invalid handle to be used.
testevt.c, testckpt.c, subscription.c, evtbench.c:
  type safeness printing.
publish.c:
  type safeness prnting.
ais_types.h:
  64bit safe ais types
Makefile:
  Remove specific o files instead of all objects.
parse.c:
  Fix crash in parser.
hdb.c:
  Fix off by one which could cause invalid handle to be used.
gmi.c:
  remove type-punned pointer warning
ckpt.c, amf.c:
  Type checking changes for printf's

BKrev: 4180200fVk1m035hXoENX87UgLUrKg

------------------------------------------------------------------------
r359 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

type safeness prnting.

(Logical change 1.98)

------------------------------------------------------------------------
r358 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

remove type-punned pointer warning

(Logical change 1.98)

------------------------------------------------------------------------
r357 | mvista.com!sdake | 2004-10-27 15:24:15 -0700 (Wed, 27 Oct 2004) | 4 lines

Fix crash in parser.

(Logical change 1.98)

------------------------------------------------------------------------
r356 | osdl.net!markh | 2004-10-22 14:16:53 -0700 (Fri, 22 Oct 2004) | 5 lines

I added some cases to test multiple channel and subscriptions as well
as some retained event tests.

(Logical change 1.97)

------------------------------------------------------------------------
r355 | osdl.net!markh | 2004-10-22 14:16:53 -0700 (Fri, 22 Oct 2004) | 13 lines

Here some updates to the event code.  The first are changes to
exec/evt.c:
1. manage the base event ID a little better.
2. I also added some private log levels to allow me to selectively turn
on debug output in some sections of the code without turning on
everything.
3. Remove (EVT) from all the printf calls.

The next is an update to the testevt program. I added some cases to test
multiple channel and subscriptions as well as some retained event tests.

BKrev: 417978c5I2I15AFzIQ0zITa5_ESuZQ

------------------------------------------------------------------------
r354 | osdl.net!markh | 2004-10-22 14:16:53 -0700 (Fri, 22 Oct 2004) | 8 lines

1. manage the base event ID a little better.
2. I also added some private log levels to allow me to selectively turn
on debug output in some sections of the code without turning on
everything.
3. Remove (EVT) from all the printf calls.

(Logical change 1.97)

------------------------------------------------------------------------
r353 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Change logging to include service and description.

(Logical change 1.96)

------------------------------------------------------------------------
r352 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Change loggint o include service and description.

(Logical change 1.96)

------------------------------------------------------------------------
r351 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Add log print service.

(Logical change 1.96)

------------------------------------------------------------------------
r350 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Delete: exec/log/print.c

}(Logical change 1.96)

------------------------------------------------------------------------
r349 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Add log service level.

(Logical change 1.96)

------------------------------------------------------------------------
r348 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 27 lines

Big update for better logging to file, syslog, or stderr.

print.h:
  Change loggint o include service and description.
print.c:
  Change logging to include service and description.
parse.h, parse.c:
  Change parser to read new configuration file format.
main.c:
  Some changes for log services.
gmi.c, evt.c, evs.c, clm.c, ckpt.c:
  Add log service level.
amf.c:
  Add log print service.
openais.conf:
  new file
.del-network.conf~b38a0f011c4341a7:
  Delete: conf/network.conf
QUICKSTART:
  Updates that explains new configuration file options.
.del-print.h~e83281cecec7f02d:
  Delete: exec/log/print.h
.del-print.c~53000a4a22b4cd:
  Delete: exec/log/print.c

BKrev: 41740e46Y1NJgmUMM6WceFwxBVXOVg

------------------------------------------------------------------------
r347 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 2 lines

(Logical change 1.96)

------------------------------------------------------------------------
r346 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Updates that explains new configuration file options.

(Logical change 1.96)

------------------------------------------------------------------------
r345 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Change parser to read new configuration file format.

(Logical change 1.96)

------------------------------------------------------------------------
r344 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Delete: conf/network.conf

}(Logical change 1.96)

------------------------------------------------------------------------
r343 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Delete: exec/log/print.h

}(Logical change 1.96)

------------------------------------------------------------------------
r342 | mvista.com!sdake | 2004-10-18 11:41:10 -0700 (Mon, 18 Oct 2004) | 4 lines

Some changes for log services.

(Logical change 1.96)

------------------------------------------------------------------------
r341 | mvista.com!sdake | 2004-10-18 11:41:09 -0700 (Mon, 18 Oct 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r340 | osdl.net!markh | 2004-10-15 07:35:37 -0700 (Fri, 15 Oct 2004) | 10 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_event

2004/10/15 07:34:46-07:00 osdl.net!markh
Fix some problems in the open channel recovery code that could cause
remaining nodes to have an incorrect count when a node left the
membership.

BKrev: 416fe0393RmyVFqRVwmPFENov-OyGw

------------------------------------------------------------------------
r339 | osdl.net!markh | 2004-10-15 07:35:37 -0700 (Fri, 15 Oct 2004) | 6 lines

Fix some problems in the open channel recovery code that could cause
remaining nodes to have an incorrect count when a node left the
membership.

(Logical change 1.95)

------------------------------------------------------------------------
r338 | mvista.com!sdake | 2004-10-14 17:37:47 -0700 (Thu, 14 Oct 2004) | 4 lines

Make testevs exit on evs_initialize if the return code is not EVS_OK.

(Logical change 1.94)

------------------------------------------------------------------------
r337 | mvista.com!sdake | 2004-10-14 17:37:47 -0700 (Thu, 14 Oct 2004) | 5 lines

Add handle instance destructor code.  Previously it was set to
null and was being called which caused a null jump.

(Logical change 1.94)

------------------------------------------------------------------------
r336 | mvista.com!sdake | 2004-10-14 17:37:47 -0700 (Thu, 14 Oct 2004) | 8 lines

testevs.c:
  Make testevs exit on evs_initialize if the return code is not EVS_OK.
evs.c:
  Add handle instance destructor code.  Previously it was set to
  null and was being called which caused a null jump.

BKrev: 416f1bdbIKOv0YEK2JzYcGImsLWrsA

------------------------------------------------------------------------
r335 | osdl.net!markh | 2004-10-12 14:59:46 -0700 (Tue, 12 Oct 2004) | 4 lines

Fix some compiler warnings with gcc 3.4

(Logical change 1.93)

------------------------------------------------------------------------
r334 | osdl.net!markh | 2004-10-12 14:59:46 -0700 (Tue, 12 Oct 2004) | 7 lines

Auto merged

2004/10/12 14:57:45-07:00 osdl.net!markh
Message type support for tracking open channels

(Logical change 1.93)

------------------------------------------------------------------------
r333 | osdl.net!markh | 2004-10-12 14:59:46 -0700 (Tue, 12 Oct 2004) | 10 lines

Auto merged

2004/10/12 14:57:45-07:00 osdl.net!markh
This takes care of tracking open channels through configuration
changes.  The channel structures and data are maintained until the last
instance is closed and there are no unexpired retained events.  Then the
data is freed up.

(Logical change 1.93)

------------------------------------------------------------------------
r332 | osdl.net!markh | 2004-10-12 14:59:46 -0700 (Tue, 12 Oct 2004) | 11 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_event

2004/10/12 14:57:46-07:00 osdl.net!markh
Handle open channels cluster wide and track opens.  Free up channel
data when there are no more references.

Also, fix some compiler warnings in lib/evt.c

BKrev: 416c53d279cT2JNVM_jQ5qBjLGe6EQ

------------------------------------------------------------------------
r331 | sakai!sakai | 2004-10-11 02:12:20 -0700 (Mon, 11 Oct 2004) | 4 lines

correct defalut component name

(Logical change 1.92)

------------------------------------------------------------------------
r330 | sakai!sakai | 2004-10-11 02:12:20 -0700 (Mon, 11 Oct 2004) | 7 lines

testamf5.c, testamf3.c:
  correct defalut component name
testamf4.c:
   correct defalut component name

BKrev: 416a4e740QCv2KoVOb0lbFRJYINodA

------------------------------------------------------------------------
r329 | sakai!sakai | 2004-10-11 02:12:20 -0700 (Mon, 11 Oct 2004) | 4 lines

 correct defalut component name

(Logical change 1.92)

------------------------------------------------------------------------
r328 | sakai!sakai | 2004-10-11 00:50:26 -0700 (Mon, 11 Oct 2004) | 5 lines

main.c, handlers.h, evt.c, evs.c, clm.c, ckpt.c, amf.c:
  exec_dump_fn support as SIGUSR2 handler to easy to debug

BKrev: 416a3b42053878SDRpbH_G7EUB4rAQ

------------------------------------------------------------------------
r327 | sakai!sakai | 2004-10-11 00:50:26 -0700 (Mon, 11 Oct 2004) | 4 lines

exec_dump_fn support as SIGUSR2 handler to easy to debug

(Logical change 1.91)

------------------------------------------------------------------------
r326 | mvista.com!sdake | 2004-10-05 13:20:12 -0700 (Tue, 05 Oct 2004) | 7 lines

Auto merged

2004/10/04 16:08:46-07:00 mvista.com!sdake
Remove unneeded debug printf

(Logical change 1.90)

------------------------------------------------------------------------
r325 | mvista.com!sdake | 2004-10-05 13:20:12 -0700 (Tue, 05 Oct 2004) | 5 lines

Change req_header to res_header to match rest of
library, especially for out of order queued messages.

(Logical change 1.90)

------------------------------------------------------------------------
r324 | mvista.com!sdake | 2004-10-05 13:20:12 -0700 (Tue, 05 Oct 2004) | 14 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2004/10/04 16:10:02-07:00 mvista.com!sdake
testamf.c:
  Change testamf to just test protection group tracking
  and componentcapabilitymodelget.
amf.c:
  Change req_header to res_header to match rest of
  library, especially for out of order queued messages.
  Remove unneeded debug printf

BKrev: 416301fc-l-UbKOcLV0FMuNqzCEQIw

------------------------------------------------------------------------
r323 | mvista.com!sdake | 2004-10-05 13:20:12 -0700 (Tue, 05 Oct 2004) | 8 lines

Auto merged

2004/10/04 16:09:33-07:00 mvista.com!sdake
Change testamf to just test protection group tracking
and componentcapabilitymodelget.

(Logical change 1.90)

------------------------------------------------------------------------
r322 | sakai!sakai | 2004-10-05 09:01:06 -0700 (Tue, 05 Oct 2004) | 5 lines

amf.h, main.c, amf.c:
  add Amfcomponent state dump mechanism

BKrev: 4162c542Q_AtRTLkaWtprRi7H3ew7w

------------------------------------------------------------------------
r321 | sakai!sakai | 2004-10-05 09:01:06 -0700 (Tue, 05 Oct 2004) | 4 lines

add Amfcomponent state dump mechanism

(Logical change 1.89)

------------------------------------------------------------------------
r320 | sakai!sakai | 2004-10-02 02:30:26 -0700 (Sat, 02 Oct 2004) | 4 lines

add surpressing health check printf message

(Logical change 1.88)

------------------------------------------------------------------------
r319 | sakai!sakai | 2004-10-02 02:30:26 -0700 (Sat, 02 Oct 2004) | 7 lines

testamf.c:
  add to reduce health check printf message
testamf6.c, testamf5.c, testamf4.c, testamf3.c, testamf2.c, testamf1.c:
  add to reduce health check printf message

BKrev: 415e7532j5RNbHSwQl4tF2HzMJjayQ

------------------------------------------------------------------------
r318 | sakai!sakai | 2004-10-02 02:30:26 -0700 (Sat, 02 Oct 2004) | 4 lines

add suppressing healthcheck pritf message

(Logical change 1.88)

------------------------------------------------------------------------
r317 | mvista.com!sdake | 2004-10-01 18:23:54 -0700 (Fri, 01 Oct 2004) | 4 lines

Fix a bunch of errors in node get and async node get.

(Logical change 1.87)

------------------------------------------------------------------------
r316 | mvista.com!sdake | 2004-10-01 18:23:54 -0700 (Fri, 01 Oct 2004) | 4 lines

Increase code coverage of clm code.

(Logical change 1.87)

------------------------------------------------------------------------
r315 | mvista.com!sdake | 2004-10-01 18:23:54 -0700 (Fri, 01 Oct 2004) | 7 lines

testclm.c:
  Increase code coverage of clm code.
clm.c, ais_msg.h:
  Fix a bunch of errors in node get and async node get.

BKrev: 415e032aF1mVsl5HqRqEZTGL5S90VA

------------------------------------------------------------------------
r314 | sakai!sakai | 2004-09-28 18:22:03 -0700 (Tue, 28 Sep 2004) | 4 lines

get rid of compile warning

(Logical change 1.86)

------------------------------------------------------------------------
r313 | sakai!sakai | 2004-09-28 18:22:03 -0700 (Tue, 28 Sep 2004) | 5 lines

testckpt.c:
  get rid of compile warning

BKrev: 415a0e3b7pcmfNPh8_SQDhuaxhArpQ

------------------------------------------------------------------------
r312 | osdl.net!markh | 2004-09-28 12:28:57 -0700 (Tue, 28 Sep 2004) | 7 lines

Auto merged

2004/09/28 11:29:35-07:00 mvista.com!sdake
Configuration change support from Miyotaka Sakai.

(Logical change 1.85)

------------------------------------------------------------------------
r311 | osdl.net!markh | 2004-09-28 12:28:57 -0700 (Tue, 28 Sep 2004) | 9 lines

Merge markh@bk.osdl.org:/var/bk/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_event

2004/09/28 11:29:45-07:00 mvista.com!sdake
parse.h, amf.c:
  Configuration change support from Miyotaka Sakai.

BKrev: 4159bb79gTMIV1ezWSXqMb61zwoXkg

------------------------------------------------------------------------
r310 | osdl.net!markh | 2004-09-28 12:28:57 -0700 (Tue, 28 Sep 2004) | 7 lines

Auto merged

2004/09/28 11:29:17-07:00 mvista.com!sdake
Configuration change support from Miyotaka Sakai.

(Logical change 1.85)

------------------------------------------------------------------------
r309 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 4 lines

Moved the SaNameTisNNameT function to util.c and called it name_match.

(Logical change 1.84)

------------------------------------------------------------------------
r308 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 4 lines

Replace SaNameTisNameT with name_match from util.[ch]

(Logical change 1.84)

------------------------------------------------------------------------
r307 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 9 lines

evt code updated to handle cluster config changes better.  Now,
when a node joins, it is sent any retained events that have time
left on them. Also, if the joining node had been a part of the cluster
in the past, it is sent the next event ID that it should use so as to
not generate duplicate event IDs. Channel open requests are now
completed in the exec handler, with channel close code to follow later.

(Logical change 1.84)

------------------------------------------------------------------------
r306 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 6 lines

Mostly event service updates to handle recovery after a
configuration change. (Selecting next event ID and sending retained
events to the joiner).

BKrev: 4159ad7atHUdo0CF1QjlYHOM-fjAvQ

------------------------------------------------------------------------
r305 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 4 lines

testparse.c needs util.o now.

(Logical change 1.84)

------------------------------------------------------------------------
r304 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 2 lines

(Logical change 1.84)

------------------------------------------------------------------------
r303 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 4 lines

Remove some old TODO comments.

(Logical change 1.84)

------------------------------------------------------------------------
r302 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 5 lines

Added util.[ch] for time and SaNameT match functions.  Also updated
dependencies.

(Logical change 1.84)

------------------------------------------------------------------------
r301 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 4 lines

Updates for evt to handle recovery after a config change.

(Logical change 1.84)

------------------------------------------------------------------------
r300 | osdl.net!markh | 2004-09-28 11:29:14 -0700 (Tue, 28 Sep 2004) | 4 lines

added a semi-quiet mode.

(Logical change 1.84)

------------------------------------------------------------------------
r299 | osdl.net!markh | 2004-09-28 11:29:13 -0700 (Tue, 28 Sep 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r298 | mvista.com!sdake | 2004-09-28 11:14:38 -0700 (Tue, 28 Sep 2004) | 4 lines

Add token callback for recovery routines.

(Logical change 1.83)

------------------------------------------------------------------------
r297 | mvista.com!sdake | 2004-09-28 11:14:38 -0700 (Tue, 28 Sep 2004) | 9 lines

Add token callback for recovery.

gmi.h:
  Add token callback functions to header.
gmi.c:
  Add token callback for recovery routines.

BKrev: 4159aa0ejs1nwJhT7hT1XL-gr9wv2Q

------------------------------------------------------------------------
r296 | mvista.com!sdake | 2004-09-28 11:14:38 -0700 (Tue, 28 Sep 2004) | 4 lines

Add token callback functions to header.

(Logical change 1.83)

------------------------------------------------------------------------
r295 | osdl.net!markh | 2004-09-24 12:44:28 -0700 (Fri, 24 Sep 2004) | 4 lines

Check to see that the message can be sent before proceeding.

(Logical change 1.82)

------------------------------------------------------------------------
r294 | osdl.net!markh | 2004-09-24 12:44:28 -0700 (Fri, 24 Sep 2004) | 5 lines

add assert around clmNodeJoinSend since the call to
gmi_mcast can return a failure now.

(Logical change 1.82)

------------------------------------------------------------------------
r293 | osdl.net!markh | 2004-09-24 12:44:28 -0700 (Fri, 24 Sep 2004) | 4 lines

add assert around gmi_mcast calls since it can return a failure now.

BKrev: 4154791ch3ag3FHVGxaUfrVFsvN3sQ

------------------------------------------------------------------------
r292 | osdl.net!markh | 2004-09-24 12:44:28 -0700 (Fri, 24 Sep 2004) | 4 lines

add assert around gmi_mcast since it can return a failure now.

(Logical change 1.82)

------------------------------------------------------------------------
r291 | mvista.com!sdake | 2004-09-23 15:14:08 -0700 (Thu, 23 Sep 2004) | 5 lines

testparse.c:
  Fix commit error in changeset 1.77.

BKrev: 41534ab0cY4dYHQw-qoPHLMpXQTAAQ

------------------------------------------------------------------------
r290 | mvista.com!sdake | 2004-09-23 15:14:08 -0700 (Thu, 23 Sep 2004) | 4 lines

Fix commit error in changeset 1.77.

(Logical change 1.81)

------------------------------------------------------------------------
r289 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Allow getSaNameT to be compiled in for application reporting.

(Logical change 1.80)

------------------------------------------------------------------------
r288 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Add sectione xpiration and get checkpoint durations working properly.

(Logical change 1.80)

------------------------------------------------------------------------
r287 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Clean up duration and expiration functions.

(Logical change 1.80)

------------------------------------------------------------------------
r286 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Finalize expiration of sections and checkpoints.

(Logical change 1.80)

------------------------------------------------------------------------
r285 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Test expiration timer.

(Logical change 1.80)

------------------------------------------------------------------------
r284 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Fix build error with -DDEBUG set.

(Logical change 1.80)

------------------------------------------------------------------------
r283 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 23 lines

Add final support for duration timers on checkpoints and expiration timers.
This cleans up memory leaks that could occur because checkpoints are expected to
cleanup with the expiration and duration timers.

testckpt.c:
  Test expiration timer.
ckptbenchth.c:
  Reduce number of threads so runs with valgrind operate faster.
ckpt.c:
  Clean up duration and expiration functions.
ais_types.h:
  Add sectione xpiration and get checkpoint durations working properly.
ais_msg.h:
  Add section expiration and get checkpoint durations working properly.
ckpt.h, ckpt.c:
  Finalize expiration of sections and checkpoints.
print.c:
  Allow getSaNameT to be compiled in for application reporting.
evs.c:
  Fix build error with -DDEBUG set.

BKrev: 41534a3dcm_0gpB32jNbsek3bGYwXQ

------------------------------------------------------------------------
r282 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Reduce number of threads so runs with valgrind operate faster.

(Logical change 1.80)

------------------------------------------------------------------------
r281 | mvista.com!sdake | 2004-09-23 15:12:13 -0700 (Thu, 23 Sep 2004) | 4 lines

Add section expiration and get checkpoint durations working properly.

(Logical change 1.80)

------------------------------------------------------------------------
r280 | mvista.com!sdake | 2004-09-22 18:27:22 -0700 (Wed, 22 Sep 2004) | 9 lines

Store handle address in timer structure.  When timer expires, wipe
out the handle address's value, since the timer is no longer valid.
This allows double frees, or frees on handles that haven't been
added.
One note of caution: a handle cannot be moved into another variable
and be expected to work properly for double frees.

(Logical change 1.79)

------------------------------------------------------------------------
r279 | mvista.com!sdake | 2004-09-22 18:27:22 -0700 (Wed, 22 Sep 2004) | 4 lines

Change define for timer handle.

(Logical change 1.79)

------------------------------------------------------------------------
r278 | mvista.com!sdake | 2004-09-22 18:27:22 -0700 (Wed, 22 Sep 2004) | 14 lines

tlist.h:
  Change interface to allow storing of handle address in timer structure.
aispoll.h, aispoll.c:
  Change define for timer handle.
tlist.c:
  Store handle address in timer structure.  When timer expires, wipe
  out the handle address's value, since the timer is no longer valid.
  This allows double frees, or frees on handles that haven't been
  added.
  One note of caution: a handle cannot be moved into another variable
  and be expected to work properly for double frees.

BKrev: 4152267afe09VjiyO_78GrWKiND_oQ

------------------------------------------------------------------------
r277 | mvista.com!sdake | 2004-09-22 18:27:22 -0700 (Wed, 22 Sep 2004) | 4 lines

Change interface to allow storing of handle address in timer structure.

(Logical change 1.79)

------------------------------------------------------------------------
r276 | mvista.com!sdake | 2004-09-22 12:57:18 -0700 (Wed, 22 Sep 2004) | 4 lines

Fix annoying build failure because of code coverage increases.

(Logical change 1.78)

------------------------------------------------------------------------
r275 | mvista.com!sdake | 2004-09-22 12:57:18 -0700 (Wed, 22 Sep 2004) | 5 lines

testparse.c:
  Fix annoying build failure because of code coverage increases.

BKrev: 4151d91edCQRlmhK78LajPaUV35NyQ

------------------------------------------------------------------------
r274 | mvista.com!sdake | 2004-09-20 18:00:16 -0700 (Mon, 20 Sep 2004) | 5 lines

Add retainined events while also cleaning up memory leakage that occurs
because of a lack of retained events.

(Logical change 1.77)

------------------------------------------------------------------------
r273 | mvista.com!sdake | 2004-09-20 18:00:16 -0700 (Mon, 20 Sep 2004) | 9 lines

Add duration timer support.
ckpt.h:
  Add retained checkpoints timer to checkpoint structure.
ckpt.c:
  Add retained checkpoints while also cleaning up memory leakage that occurs
  because of a lack of retained events.

BKrev: 414f7d20vmWMyWW9eWJST5Ew5sw_yw

------------------------------------------------------------------------
r272 | mvista.com!sdake | 2004-09-20 18:00:16 -0700 (Mon, 20 Sep 2004) | 4 lines

Add retained events timer to checkpoint structure.

(Logical change 1.77)

------------------------------------------------------------------------
r271 | mvista.com!sdake | 2004-09-20 17:57:00 -0700 (Mon, 20 Sep 2004) | 4 lines

Get rid of valgrind warning and possible segfault.

(Logical change 1.76)

------------------------------------------------------------------------
r270 | mvista.com!sdake | 2004-09-20 17:57:00 -0700 (Mon, 20 Sep 2004) | 5 lines

gmi.c:
  Get rid of valgrind warning and possible segfault.

BKrev: 414f7c5cf4HwWODMiTAI2PCkLX1fnw

------------------------------------------------------------------------
r269 | mvista.com!sdake | 2004-09-20 15:18:37 -0700 (Mon, 20 Sep 2004) | 4 lines

Missed merge of these two files from last changeset.

(Logical change 1.75)

------------------------------------------------------------------------
r268 | mvista.com!sdake | 2004-09-20 15:18:37 -0700 (Mon, 20 Sep 2004) | 5 lines

handlers.h, gmi.h:
  Missed merge of these two files from last changeset.

BKrev: 414f573d4f7iW8ZMEKLNAImK24Vn3g

------------------------------------------------------------------------
r267 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 5 lines

Add recovery plug support to evs.
l

(Logical change 1.74)

------------------------------------------------------------------------
r266 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 4 lines

Add recovery plug support to amf.

(Logical change 1.74)

------------------------------------------------------------------------
r265 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 26 lines

Add recovery plug support to openais.  This allows messages that are recovery
messages to be blocked until recovery completes.  All low/medium/high messages
cannot be transmitted until all processors have unplugged themselves.  If a
configuration change occurs, the plugs are invalidated and the recovery starts
again.

Makefile:
  Remove two build errors with extra object file included that is not needed.
main.c:
  Add recovery plug support.
gmi.c:
  Add recovery plug support to group messaging.
evt.c:
  Add recovery plug support to evt.
evs.c:
  Add recovery plug support to evs.
  l
clm.c:
  Add recovery plug support to clm.
ckpt.c:
  Add recovery plug support to ckpt.
amf.c:
  Add recovery plug support to amf.

BKrev: 414bddd7HCsNs1rz-sJV92mB6fupCw

------------------------------------------------------------------------
r264 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 4 lines

Add recovery plug support to clm.

(Logical change 1.74)

------------------------------------------------------------------------
r263 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 4 lines

Add recovery plug support to group messaging.

(Logical change 1.74)

------------------------------------------------------------------------
r262 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 4 lines

Add recovery plug support to evt.

(Logical change 1.74)

------------------------------------------------------------------------
r261 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 4 lines

Add recovery plug support.

(Logical change 1.74)

------------------------------------------------------------------------
r260 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 4 lines

Remove two build errors with extra object file included that is not needed.

(Logical change 1.74)

------------------------------------------------------------------------
r259 | mvista.com!sdake | 2004-09-18 00:03:51 -0700 (Sat, 18 Sep 2004) | 4 lines

Add recovery plug support to ckpt.

(Logical change 1.74)

------------------------------------------------------------------------
r258 | mvista.com!sdake | 2004-09-15 17:20:18 -0700 (Wed, 15 Sep 2004) | 6 lines

gmi.c:
  Bug 44.
  Fixes assertion in executive when running ckptbenchth.

BKrev: 4148dc42NSqyi9F4s6exhsVarsF10Q

------------------------------------------------------------------------
r257 | mvista.com!sdake | 2004-09-15 17:20:18 -0700 (Wed, 15 Sep 2004) | 5 lines

Bug 44.
Fixes assertion in executive when running ckptbenchth.

(Logical change 1.73)

------------------------------------------------------------------------
r256 | mvista.com!sdake | 2004-09-15 13:54:42 -0700 (Wed, 15 Sep 2004) | 6 lines

main.c:
  Call poll_destroy when executing ais_done.  This increases code
  coverage from 66.9% to 82.3%.

BKrev: 4148ac12oFAraidHBF8lhdpMgBXc1w

------------------------------------------------------------------------
r255 | mvista.com!sdake | 2004-09-15 13:54:42 -0700 (Wed, 15 Sep 2004) | 5 lines

Call poll_destroy when executing ais_done.  This increases code
coverage from 66.9% to 82.3%.

(Logical change 1.72)

------------------------------------------------------------------------
r254 | mvista.com!sdake | 2004-09-15 13:37:39 -0700 (Wed, 15 Sep 2004) | 6 lines

Increase code coverage from 19.4% to 100% by adding defines
to remove debug print code in production builds.  Also removed
function by ifdef that is never used in the project.

(Logical change 1.71)

------------------------------------------------------------------------
r253 | mvista.com!sdake | 2004-09-15 13:37:39 -0700 (Wed, 15 Sep 2004) | 7 lines

print.c:
  Increase code coverage from 19.4% to 100% by adding defines
  to remove debug print code in production builds.  Also removed
  function by ifdef that is never used in the project.

BKrev: 4148a813APgP44Mw4XR-P--e0qYzTw

------------------------------------------------------------------------
r252 | mvista.com!sdake | 2004-09-15 13:30:02 -0700 (Wed, 15 Sep 2004) | 4 lines

Increased code coverage of tlist.c from 74.5% to 95.9%.

(Logical change 1.70)

------------------------------------------------------------------------
r251 | mvista.com!sdake | 2004-09-15 13:30:02 -0700 (Wed, 15 Sep 2004) | 5 lines

tlist.c:
  Increased code coverage of tlist.c from 74.5% to 95.9%.

BKrev: 4148a64akC3-Hr8RMOSHHChVWBYM5Q

------------------------------------------------------------------------
r250 | mvista.com!sdake | 2004-09-15 13:20:07 -0700 (Wed, 15 Sep 2004) | 4 lines

Remove unused code.

(Logical change 1.69)

------------------------------------------------------------------------
r249 | mvista.com!sdake | 2004-09-15 13:20:07 -0700 (Wed, 15 Sep 2004) | 9 lines

crypto.h:
  Remove unused code.
crypto.c:
  Remove unused code and change some error detection to assertions.
  This increases code covergae from 80.2% to 92.7% with no change
  in functionality.

BKrev: 4148a3f73A3zw2reb3HkDh6RWIrcag

------------------------------------------------------------------------
r248 | mvista.com!sdake | 2004-09-15 13:20:07 -0700 (Wed, 15 Sep 2004) | 6 lines

Remove unused code and change some error detection to assertions.
This increases code covergae from 80.2% to 92.7% with no change
in functionality.

(Logical change 1.69)

------------------------------------------------------------------------
r247 | mvista.com!sdake | 2004-09-09 18:04:29 -0700 (Thu, 09 Sep 2004) | 6 lines

BUG 37.  Fix several leaks during configuration changes.  Also fixes
a possible assert with many large messages being sent from multiple
processors at the same time.

(Logical change 1.68)

------------------------------------------------------------------------
r246 | mvista.com!sdake | 2004-09-09 18:04:29 -0700 (Thu, 09 Sep 2004) | 7 lines

gmi.c:
  BUG 37.  Fix several leaks during configuration changes.  Also fixes
  a possible assert with many large messages being sent from multiple
  processors at the same time.

BKrev: 4140fd9dwjk3xOLpFw3Ivhp0_f_oYw

------------------------------------------------------------------------
r245 | mvista.com!sdake | 2004-09-08 01:11:56 -0700 (Wed, 08 Sep 2004) | 13 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2004/09/08 01:11:43-07:00 mvista.com!sdake
Code coverage support in build environment and test programs.

Many files:
  Add signal handler so code coverage records coverage
Makefile:
  Add code coverage build options and make clean target

BKrev: 413ebecc_2LPT2fuaQZhw9BymLz6bQ

------------------------------------------------------------------------
r244 | mvista.com!sdake | 2004-09-08 01:11:56 -0700 (Wed, 08 Sep 2004) | 4 lines

Add signal handler so code coverage records coverage

(Logical change 1.67)

------------------------------------------------------------------------
r243 | mvista.com!sdake | 2004-09-08 01:11:56 -0700 (Wed, 08 Sep 2004) | 4 lines

Add code coverage build options and make clean target

(Logical change 1.67)

------------------------------------------------------------------------
r242 | broked.org!sdake | 2004-09-07 20:25:56 -0700 (Tue, 07 Sep 2004) | 6 lines

Get rid of magic number 1500 and replace with PACKET_SIZE_MAX.
Also fix a glaring memory overwrite bug in gmi_init which would
init 256k of memory instead of PACKET_SIZE_MAX memory.

(Logical change 1.66)

------------------------------------------------------------------------
r241 | broked.org!sdake | 2004-09-07 20:25:56 -0700 (Tue, 07 Sep 2004) | 7 lines

gmi.c:
  Get rid of magic number 1500 and replace with PACKET_SIZE_MAX.
  Also fix a glaring memory overwrite bug in gmi_init which would
  init 256k of memory instead of PACKET_SIZE_MAX memory.

BKrev: 413e7bc48wgkqG1E4wSbG9KQkBJMkg

------------------------------------------------------------------------
r240 | broked.org!sdake | 2004-09-07 08:18:12 -0700 (Tue, 07 Sep 2004) | 5 lines

EVS library makes compiler warning on some compilers.  Found and fixed by
Sakai Miyotaka.

(Logical change 1.65)

------------------------------------------------------------------------
r239 | osdl.net!markh | 2004-09-07 08:18:12 -0700 (Tue, 07 Sep 2004) | 7 lines

Merge

2004/09/04 16:52:55-07:00 broked.org!sdake
Makefile missing clean target for evs bench.  Found and fixed by Sakai Miyotaka.

(Logical change 1.65)

------------------------------------------------------------------------
r238 | broked.org!sdake | 2004-09-07 08:18:12 -0700 (Tue, 07 Sep 2004) | 2 lines

(Logical change 1.65)

------------------------------------------------------------------------
r237 | osdl.net!markh | 2004-09-07 08:18:12 -0700 (Tue, 07 Sep 2004) | 20 lines

Merge

2004/09/06 13:30:28-07:00 broked.org!sdake
Added man pages and html generation for the EVS interface.

2004/09/04 16:54:20-07:00 broked.org!sdake
One serious bug in AMF and a few minor nits fixed from patch
from Sakai Miyotaka.
Makefile:
  Makefile missing clean target for evs bench.  Found and fixed by Sakai Miyotaka.
evs.c:
  EVS library makes compiler warning on some compilers.  Found and fixed by
  Sakai Miyotaka.
amf.c:
  State change from standby-active to outofservice could
  result in invalid number of active units.  Found and fixed by
  Sakai Miyotaka.

BKrev: 413dd134zK97xpVttMuRVm6GdcbQlg

------------------------------------------------------------------------
r236 | broked.org!sdake | 2004-09-07 08:18:12 -0700 (Tue, 07 Sep 2004) | 6 lines

State change from standby-active to outofservice could
result in invalid number of active units.  Found and fixed by
Sakai Miyotaka.

(Logical change 1.65)

------------------------------------------------------------------------
r235 | broked.org!sdake | 2004-09-07 08:18:11 -0700 (Tue, 07 Sep 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r234 | osdl.net!markh | 2004-09-07 08:14:59 -0700 (Tue, 07 Sep 2004) | 4 lines

Clean up some comments code. (comments, old macro).

(Logical change 1.64)

------------------------------------------------------------------------
r233 | osdl.net!markh | 2004-09-07 08:14:59 -0700 (Tue, 07 Sep 2004) | 4 lines

Add return value to main.

(Logical change 1.64)

------------------------------------------------------------------------
r232 | osdl.net!markh | 2004-09-07 08:14:59 -0700 (Tue, 07 Sep 2004) | 4 lines

Some code cleanup.

BKrev: 413dd073MFU2gjJ72eQd8SOvDfpBwQ

------------------------------------------------------------------------
r231 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 4 lines

Development, updates, and bug fixes to event service lib.

(Logical change 1.63)

------------------------------------------------------------------------
r230 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 5 lines

Added special SA_CLM_LOCAL_NODE_ID case to receive your own
cluster node data.

(Logical change 1.63)

------------------------------------------------------------------------
r229 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 2 lines

(Logical change 1.63)

------------------------------------------------------------------------
r228 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 5 lines

Added event testing programs:
evtbench, subscription, publish

(Logical change 1.63)

------------------------------------------------------------------------
r227 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 4 lines

Add in list_add_tail and list_empty functions

(Logical change 1.63)

------------------------------------------------------------------------
r226 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 5 lines

Check to make sure that sequence ID passed into sq_item_inuse is
valid.

(Logical change 1.63)

------------------------------------------------------------------------
r225 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 4 lines

Event Service Implementation and fixes.

BKrev: 41375569R3AaZBcK1LtaD9gt36SuLQ

------------------------------------------------------------------------
r224 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 4 lines

Add event service message types.

(Logical change 1.63)

------------------------------------------------------------------------
r223 | osdl.net!markh | 2004-09-02 10:16:25 -0700 (Thu, 02 Sep 2004) | 4 lines

Completed most of the event service functionality.

(Logical change 1.63)

------------------------------------------------------------------------
r222 | osdl.net!markh | 2004-09-02 10:16:24 -0700 (Thu, 02 Sep 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r221 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 4 lines

Mark a bug for later resolution

(Logical change 1.62)

------------------------------------------------------------------------
r220 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 5 lines

Added the EVS service and changed the library queue
to 256 entries.

(Logical change 1.62)

------------------------------------------------------------------------
r219 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 9 lines

Major rewrite of saRecvQueue.  Fixed is:
activate poll messages are not sent over and over
The message header is read into the return buffer
if the message doesn't match, a new message is allocated
This allows the message buffer for saRecvQueue to be
small, but allows receiving very large messages.

(Logical change 1.62)

------------------------------------------------------------------------
r218 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 4 lines

Add the evs library

(Logical change 1.62)

------------------------------------------------------------------------
r217 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 4 lines

Added the evs target.

(Logical change 1.62)

------------------------------------------------------------------------
r216 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 49 lines

This changeset includes major fixes to the IPC from the executive
to the library.  Also included is an entirely new API called the
EVS api (Extended Virtual Synchrony).  This API provides EVS semantics
for those developers that require this model of programming.  The
API is defined in include/evs.h and is very simple.

The API provides:
group semantics with 32 byte group keys.
delivery callback
configuration change callback
join one or more groups
leave one or more groups
multicast a message to the instance's joined groups
multicast a message to any other group

Makefile:
  Add the testevs and evsbench targets.
evs.c, testevs.c, evsbench.c, evs.h:
  new file
Makefile:
  Add the evs library
util.c:
  Major rewrite of saRecvQueue.  Fixed is:
  activate poll messages are not sent over and over
  The message header is read into the return buffer
  if the message doesn't match, a new message is allocated
  This allows the message buffer for saRecvQueue to be
  small, but allows receiving very large messages.
amf.c:
  Mark a bug for later resolution
ais_msg.h:
  Add the evs messages and descriptors.
Makefile:
  Added the evs target.
main.h:
  Added the EVS service and changed the library queue
  to 256 entries.
main.c:
  major rewrite of the IPC code for sending messages
  to the library.  What was there previously was very
  broken.
gmi.c:
  Fix bug where transition from multiple members to
  single members would cause messages not to be sent.
  Also fixed an assertion in transition from multiple
  processors to one processor.

BKrev: 41343518pVUD6aQu4urTw6ClPiOl3w

------------------------------------------------------------------------
r215 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 4 lines

Add the testevs and evsbench targets.

(Logical change 1.62)

------------------------------------------------------------------------
r214 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 6 lines

major rewrite of the IPC code for sending messages
to the library.  What was there previously was very
broken.

(Logical change 1.62)

------------------------------------------------------------------------
r213 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 4 lines

Add the evs messages and descriptors.

(Logical change 1.62)

------------------------------------------------------------------------
r212 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 2 lines

(Logical change 1.62)

------------------------------------------------------------------------
r211 | broked.org!sdake | 2004-08-31 01:21:44 -0700 (Tue, 31 Aug 2004) | 7 lines

Fix bug where transition from multiple members to
single members would cause messages not to be sent.
Also fixed an assertion in transition from multiple
processors to one processor.

(Logical change 1.62)

------------------------------------------------------------------------
r210 | broked.org!sdake | 2004-08-31 01:21:43 -0700 (Tue, 31 Aug 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r209 | mvista.com!sdake | 2004-08-27 17:37:34 -0700 (Fri, 27 Aug 2004) | 7 lines

gmi.c:
  Flush all multicast messages by delivering them before
  processing the token.  This ensures that the mcast fd
  doesn't buffer too many old messages and avoids an assert.

BKrev: 412fd3cesE7M-pXl9OZs1X2CyK7Y4A

------------------------------------------------------------------------
r208 | mvista.com!sdake | 2004-08-27 17:37:34 -0700 (Fri, 27 Aug 2004) | 6 lines

Flush all multicast messages by delivering them before
processing the token.  This ensures that the mcast fd
doesn't buffer too many old messages and avoids an assert.

(Logical change 1.61)

------------------------------------------------------------------------
r207 | mvista.com!sdake | 2004-08-23 18:21:33 -0700 (Mon, 23 Aug 2004) | 4 lines

Add initial support for multipathing to group messaging.

(Logical change 1.60)

------------------------------------------------------------------------
r206 | mvista.com!sdake | 2004-08-23 18:21:33 -0700 (Mon, 23 Aug 2004) | 4 lines

Change gmi interface to support multipathing.

(Logical change 1.60)

------------------------------------------------------------------------
r205 | mvista.com!sdake | 2004-08-23 18:21:33 -0700 (Mon, 23 Aug 2004) | 5 lines

Change network configuration parser interface to support
multipathing.

(Logical change 1.60)

------------------------------------------------------------------------
r204 | mvista.com!sdake | 2004-08-23 18:21:33 -0700 (Mon, 23 Aug 2004) | 12 lines

parse.h:
  Change network configuration parser interface to support
  multipathing.
gmi.h, main.c:
  Change gmi interface to support multipathing.
parse.c:
  Change network configuration parser to read multiple interfaces.
gmi.c:
  Add initial support for multipathing to group messaging.

BKrev: 412a981dC8TjKSqUYOtAx6jKoO-UlA

------------------------------------------------------------------------
r203 | mvista.com!sdake | 2004-08-23 18:21:33 -0700 (Mon, 23 Aug 2004) | 4 lines

Change network configuration parser to read multiple interfaces.

(Logical change 1.60)

------------------------------------------------------------------------
r202 | osdl.net!markh | 2004-08-23 15:27:07 -0700 (Mon, 23 Aug 2004) | 4 lines

Need to check the size of the response header here.

(Logical change 1.59)

------------------------------------------------------------------------
r201 | osdl.net!markh | 2004-08-23 15:27:07 -0700 (Mon, 23 Aug 2004) | 5 lines

Need to check the size of the response header instead of the
request header in saRecvQueue.

BKrev: 412a6f3b4NlVb-n94TuM1jqiD4KUgA

------------------------------------------------------------------------
r200 | mvista.com!sdake | 2004-08-22 22:24:21 -0700 (Sun, 22 Aug 2004) | 8 lines

Clean up usage of ais_done.  This includes passing a
value for each done type.  Also, libais_disconnect cleaned up
so it doesn't ais_done when its queues are full.  Instead it
disconnects the library connection.  A new connection state
variable added to the conn_info structure in place of active.

(Logical change 1.58)

------------------------------------------------------------------------
r199 | mvista.com!sdake | 2004-08-22 22:24:21 -0700 (Sun, 22 Aug 2004) | 5 lines

Changed number of queueable messages to the library from 8192
to 128 messages.

(Logical change 1.58)

------------------------------------------------------------------------
r198 | mvista.com!sdake | 2004-08-22 22:24:21 -0700 (Sun, 22 Aug 2004) | 4 lines

Use new connection enumeration with AMF code.

(Logical change 1.58)

------------------------------------------------------------------------
r197 | mvista.com!sdake | 2004-08-22 22:24:21 -0700 (Sun, 22 Aug 2004) | 14 lines

main.h:
  Changed number of queueable messages to the library from 8192
  to 128 messages.
main.c:
  Clean up usage of ais_done.  This includes passing a
  value for each done type.  Also, libais_disconnect cleaned up
  so it doesn't ais_done when its queues are full.  Instead it
  disconnects the library connection.  A new connection state
  variable added to the conn_info structure in place of active.
amf.c:
  Use new connection enumeration with AMF code.

BKrev: 41297f85ZsPdr8oHUfjQ6v_A6b6ybw

------------------------------------------------------------------------
r196 | mvista.com!sdake | 2004-08-22 16:04:53 -0700 (Sun, 22 Aug 2004) | 4 lines

Missed commit to changes for queue.h.

(Logical change 1.57)

------------------------------------------------------------------------
r195 | mvista.com!sdake | 2004-08-22 16:04:53 -0700 (Sun, 22 Aug 2004) | 7 lines

queue.h:
  Missed commit to changes for queue.h.
ais_msg.h:
  Missed commit of changes to ais_msg.h.

BKrev: 41292695YG_qjNyfkNoFlMFaeiR7zg

------------------------------------------------------------------------
r194 | mvista.com!sdake | 2004-08-22 16:04:53 -0700 (Sun, 22 Aug 2004) | 4 lines

Missed commit of changes to ais_msg.h.

(Logical change 1.57)

------------------------------------------------------------------------
r193 | mvista.com!sdake | 2004-08-22 15:46:29 -0700 (Sun, 22 Aug 2004) | 8 lines

Add flow control documentation to devmap.
.l

2004/08/22 15:24:25-07:00 mvista.com!sdake
Add event service to devmap.

(Logical change 1.56)

------------------------------------------------------------------------
r192 | mvista.com!sdake | 2004-08-22 15:46:29 -0700 (Sun, 22 Aug 2004) | 6 lines

README.devmap:
  Add flow control documentation to devmap.
  Add event service to devmap.

BKrev: 412922454HMPjB41f5bgMaos4soalg

------------------------------------------------------------------------
r191 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Cleanup errors in Makefile.

(Logical change 1.55)

------------------------------------------------------------------------
r190 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Change interface so there is a new libais_handler structure.

(Logical change 1.55)

------------------------------------------------------------------------
r189 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add support for flow control to amf library.

(Logical change 1.55)

------------------------------------------------------------------------
r188 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add support to group messaging to get flow control information.

(Logical change 1.55)

------------------------------------------------------------------------
r187 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add flow control support to the checkpoint benchmark program.

(Logical change 1.55)

------------------------------------------------------------------------
r186 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Flow control changes.

(Logical change 1.55)

------------------------------------------------------------------------
r185 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 40 lines

testamf3.c:
  misc flow control changes.
ckptbenchth.c:
  Retry checkpoint writes on threaded writes if SA_ERR_TRY_AGAIn
  received.
ckptbench.c:
  Add flow control support to the checkpoint benchmark program.
util.c:
  Add flow control to saRecvQueue function.
evt.c:
  Add flow control to eventing.
clm.c:
  Add flow control to cluster membership.
ckpt.c:
  Add flow control to checkpointing.
amf.c:
  Add flow control to amf.
Makefile:
  Cleanup errors in Makefile.
main.h:
  Flow control changes.
handlers.h:
  Change interface so there is a new libais_handler structure.
gmi.h:
  Add support to group messaging for another priority level.
main.c:
  Add support to disconnect and dispatch to utilize flow control.
gmi.c:
  Add support to group messaging to get flow control information.
evt.c:
  Add support to eventing for flow control.
clm.c:
  Add support to clm for flow control.
ckpt.c:
  Add support for flow control to ckpt library.
amf.c:
  Add support for flow control to amf library.

BKrev: 412678baBKkyszbWcphf0Vg85SpLXg

------------------------------------------------------------------------
r184 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 5 lines

Retry checkpoint writes on threaded writes if SA_ERR_TRY_AGAIn
received.

(Logical change 1.55)

------------------------------------------------------------------------
r183 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add support to group messaging for another priority level.

(Logical change 1.55)

------------------------------------------------------------------------
r182 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add flow control to eventing.

(Logical change 1.55)

------------------------------------------------------------------------
r181 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add flow control to cluster membership.

(Logical change 1.55)

------------------------------------------------------------------------
r180 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add support to eventing for flow control.

(Logical change 1.55)

------------------------------------------------------------------------
r179 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add support to disconnect and dispatch to utilize flow control.

(Logical change 1.55)

------------------------------------------------------------------------
r178 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add flow control to amf.

(Logical change 1.55)

------------------------------------------------------------------------
r177 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add support for flow control to ckpt library.

(Logical change 1.55)

------------------------------------------------------------------------
r176 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

misc flow control changes.

(Logical change 1.55)

------------------------------------------------------------------------
r175 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add flow control to saRecvQueue function.

(Logical change 1.55)

------------------------------------------------------------------------
r174 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add flow control to checkpointing.

(Logical change 1.55)

------------------------------------------------------------------------
r173 | mvista.com!sdake | 2004-08-20 15:18:34 -0700 (Fri, 20 Aug 2004) | 4 lines

Add support to clm for flow control.

(Logical change 1.55)

------------------------------------------------------------------------
r172 | broked.org!sdake | 2004-08-14 02:25:33 -0700 (Sat, 14 Aug 2004) | 5 lines

Add priority to poll abstraction
Higher priority items will be serviced first

(Logical change 1.54)

------------------------------------------------------------------------
r171 | broked.org!sdake | 2004-08-14 02:25:33 -0700 (Sat, 14 Aug 2004) | 18 lines

Priorites added to dispatch function.  This is in prep for flow
control to allow dispatch functions that haven't been serviced
in awhile to be bumped up in priority when they are not serviced.

The priority of the dispatch handler is passed to the dispatch
function which can modify it in place.  The new priority will be
used the next time the poll system call is executed.

main.c:
  Add library accept handler at lowest priority
gmi.c:
  Make gmi highest priority when adding dispatch functions
aispoll.h, aispoll.c:
  Add priority to poll abstraction
  Higher priority items will be serviced first

BKrev: 411dda8dXGsq4glmjj36km40YZhjCA

------------------------------------------------------------------------
r170 | broked.org!sdake | 2004-08-14 02:25:33 -0700 (Sat, 14 Aug 2004) | 4 lines

Make gmi highest priority when adding dispatch functions

(Logical change 1.54)

------------------------------------------------------------------------
r169 | broked.org!sdake | 2004-08-14 02:25:33 -0700 (Sat, 14 Aug 2004) | 4 lines

Add library accept handler at lowest priority

(Logical change 1.54)

------------------------------------------------------------------------
r168 | broked.org!sdake | 2004-08-09 21:47:05 -0700 (Mon, 09 Aug 2004) | 9 lines

gmi.c:
  When 2 processors are part of the configuration, then one
  of the members leaves, then a new configuration occurs
  with 2 or more members, the "joined" list was not
  being properly passed to the rest of the executive
  services.  This bug fixed.

BKrev: 41185349SwUWKZU-QQ_K91jAnvqYpA

------------------------------------------------------------------------
r167 | broked.org!sdake | 2004-08-09 21:47:05 -0700 (Mon, 09 Aug 2004) | 8 lines

When 2 processors are part of the configuration, then one
of the members leaves, then a new configuration occurs
with 2 or more members, the "joined" list was not
being properly passed to the rest of the executive
services.  This bug fixed.

(Logical change 1.53)

------------------------------------------------------------------------
r166 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 4 lines

Add encryption and authentication to GMI.

(Logical change 1.52)

------------------------------------------------------------------------
r165 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 19 lines

Add encryption and authentication to all messages so that messages are secret
and are always known to come from a source that knows the private key.

SECURITY:
  Describe latest security system using SOBER, SHA1, and HMAC.
QUICKSTART:
  Add details to creating security key to quickstart guide.
LICENSE:
  Add libtomcrypt's license text for crypto.c and crypto.h
Makefile:
  Add crytpo features to makefile
gmi.h:
  Add ability to pass key and keylen to gmi_init.
  Add ability to set security logging value.
gmi.c:
  Add encryption and authentication to GMI.

BKrev: 4117ed75MEkDZv2CoCUYGolBNHy17Q

------------------------------------------------------------------------
r164 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 4 lines

Add details to creating security key to quickstart guide.

(Logical change 1.52)

------------------------------------------------------------------------
r163 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 5 lines

Add ability to pass key and keylen to gmi_init.
Add ability to set security logging value.

(Logical change 1.52)

------------------------------------------------------------------------
r162 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 4 lines

Add libtomcrypt's license text for crypto.c and crypto.h

(Logical change 1.52)

------------------------------------------------------------------------
r161 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 4 lines

Add crytpo features to makefile

(Logical change 1.52)

------------------------------------------------------------------------
r160 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 2 lines

(Logical change 1.52)

------------------------------------------------------------------------
r159 | mvista.com!sdake | 2004-08-09 14:32:37 -0700 (Mon, 09 Aug 2004) | 4 lines

Describe latest security system using SOBER, SHA1, and HMAC.

(Logical change 1.52)

------------------------------------------------------------------------
r158 | mvista.com!sdake | 2004-08-09 14:29:42 -0700 (Mon, 09 Aug 2004) | 5 lines

keygen.c, crypto.h, crypto.c:
New files for cryptography support.

BKrev: 4117ecc6HWTXJ7DG7UZ3E01aKajTBA

------------------------------------------------------------------------
r157 | mvista.com!sdake | 2004-08-09 14:29:42 -0700 (Mon, 09 Aug 2004) | 2 lines

(Logical change 1.51)

------------------------------------------------------------------------
r156 | mvista.com!sdake | 2004-08-09 14:29:41 -0700 (Mon, 09 Aug 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r155 | osdl.net!markh | 2004-07-30 10:51:32 -0700 (Fri, 30 Jul 2004) | 4 lines

Fix compiler warning

(Logical change 1.50)

------------------------------------------------------------------------
r154 | osdl.net!markh | 2004-07-30 10:51:32 -0700 (Fri, 30 Jul 2004) | 4 lines

Fix compiler warning

BKrev: 410a8aa45tOLcJaeS6TU0H7l55hYiQ

------------------------------------------------------------------------
r153 | osdl.net!markh | 2004-07-30 10:49:14 -0700 (Fri, 30 Jul 2004) | 4 lines

Fix queue items memory leak.

(Logical change 1.49)

------------------------------------------------------------------------
r152 | osdl.net!markh | 2004-07-30 10:49:14 -0700 (Fri, 30 Jul 2004) | 4 lines

Fix queue items memory leak.

BKrev: 410a8a1arpYlwWZY9PRvbEkRYy7zkQ

------------------------------------------------------------------------
r151 | mvista.com!sdake | 2004-07-29 16:00:43 -0700 (Thu, 29 Jul 2004) | 6 lines

Change RecvQueue to use a stack structure for receiving the
response instead of passing in the maximum sized value for a
response message.

(Logical change 1.48)

------------------------------------------------------------------------
r150 | mvista.com!sdake | 2004-07-29 16:00:43 -0700 (Thu, 29 Jul 2004) | 7 lines

Clean up RecvQueue users and pass in actual buffer instead
of "overly large" buffer which has changed because of changes
to util.c
Also cleaned up memory leak in the dispatch function.

(Logical change 1.48)

------------------------------------------------------------------------
r149 | mvista.com!sdake | 2004-07-29 16:00:43 -0700 (Thu, 29 Jul 2004) | 15 lines

util.c:
  Change RecvQueue to use a stack structure for receiving the
  response instead of passing in the maximum sized value for a
  response message.
ckpt.c:
  Change all RecvQueue users to use RecvRetry since there is no
  reason to queue out of order messages.
amf.c:
  Clean up RecvQueue users and pass in actual buffer instead
  of "overly large" buffer which has changed because of changes
  to util.c
  Also cleaned up memory leak in the dispatch function.

BKrev: 4109819b_adTTm4cCZmfLJcsYb9hyA

------------------------------------------------------------------------
r148 | mvista.com!sdake | 2004-07-29 16:00:43 -0700 (Thu, 29 Jul 2004) | 5 lines

Change all RecvQueue users to use RecvRetry since there is no
reason to queue out of order messages.

(Logical change 1.48)

------------------------------------------------------------------------
r147 | mvista.com!sdake | 2004-07-29 12:53:46 -0700 (Thu, 29 Jul 2004) | 2 lines

(Logical change 1.47)

------------------------------------------------------------------------
r146 | mvista.com!sdake | 2004-07-29 12:53:46 -0700 (Thu, 29 Jul 2004) | 5 lines

Add function in exec/clm to get the full cluster node information
for any node in the cluster membership

(Logical change 1.47)

------------------------------------------------------------------------
r145 | osdl.net!markh | 2004-07-29 12:53:46 -0700 (Thu, 29 Jul 2004) | 10 lines

Merge bk://bk.osdl.org/openais
into markh1.pdx.osdl.net:/home/localmarkh/views/BK/openais_stage

2004/07/29 12:26:46-07:00 mvista.com!sdake
clm.c:
  Add function in exec/clm to get the full cluster node information
  for any node in the cluster membership

BKrev: 410955capPzVdVwzpMJetS80seWS7g

------------------------------------------------------------------------
r144 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

Added event code and dependencies.

(Logical change 1.46)

------------------------------------------------------------------------
r143 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

added event message types and associated data structures.

(Logical change 1.46)

------------------------------------------------------------------------
r142 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

Event service data types.

(Logical change 1.46)

------------------------------------------------------------------------
r141 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 6 lines

This adds the start of the AIS event service code.  The library code
is mostly complete.  The aisexec part just has placeholders for now
and will be filled in later.

BKrev: 410944e7-oXL5OZSJvizPPH9dGS2GA

------------------------------------------------------------------------
r140 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

Added event library and depend target.

(Logical change 1.46)

------------------------------------------------------------------------
r139 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

added event service handler.

(Logical change 1.46)

------------------------------------------------------------------------
r138 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

added event service.

(Logical change 1.46)

------------------------------------------------------------------------
r137 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

Added clustTimeNow to get current time in nanoseconds.

(Logical change 1.46)

------------------------------------------------------------------------
r136 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 4 lines

Added event test program and depend target.

(Logical change 1.46)

------------------------------------------------------------------------
r135 | osdl.net!markh | 2004-07-29 11:41:43 -0700 (Thu, 29 Jul 2004) | 2 lines

(Logical change 1.46)

------------------------------------------------------------------------
r134 | osdl.net!markh | 2004-07-29 11:41:42 -0700 (Thu, 29 Jul 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r133 | mvista.com!sdake | 2004-07-28 15:36:12 -0700 (Wed, 28 Jul 2004) | 9 lines

README.devmap:
  Document new changes to exec handler function prototype
  and recommend using the source_addr for deferring requests
  instead of recording the ip address in the message itself.
main.c, handlers.h, clm.c, ckpt.c, amf.c:
  Add source_addr to exec message handler for event service.

BKrev: 41082a5cY6cLQK7NG_rxZrkb7lERfw

------------------------------------------------------------------------
r132 | mvista.com!sdake | 2004-07-28 15:36:12 -0700 (Wed, 28 Jul 2004) | 6 lines

Document new changes to exec handler function prototype
and recommend using the source_addr for deferring requests
instead of recording the ip address in the message itself.

(Logical change 1.45)

------------------------------------------------------------------------
r131 | mvista.com!sdake | 2004-07-28 15:36:12 -0700 (Wed, 28 Jul 2004) | 4 lines

Add source_addr to exec message handler for event service.

(Logical change 1.45)

------------------------------------------------------------------------
r130 | mvista.com!sdake | 2004-07-27 16:30:47 -0700 (Tue, 27 Jul 2004) | 6 lines

Major cleanup and use hdb.c abstracted out functions
now instead of internal hacked together stuff that was
there previously.

(Logical change 1.44)

------------------------------------------------------------------------
r129 | mvista.com!sdake | 2004-07-27 16:30:47 -0700 (Tue, 27 Jul 2004) | 9 lines

Remove "old-style" handle database code from aispoll.c and include
instead hdb.c/hdb.h.  These files are copies of the handle database
code used for the library without mutexes.

This work for Mark Haverkamp to use the handle database functionality
as part of the event service.

BKrev: 4106e5a7ANCdXqe3zoIfO1tcYyrQhQ

------------------------------------------------------------------------
r128 | mvista.com!sdake | 2004-07-27 16:30:47 -0700 (Tue, 27 Jul 2004) | 4 lines

Major cleanup to use hdb.c handle database functions.

(Logical change 1.44)

------------------------------------------------------------------------
r127 | mvista.com!sdake | 2004-07-27 16:30:47 -0700 (Tue, 27 Jul 2004) | 4 lines

Add hdb.c to the build.

(Logical change 1.44)

------------------------------------------------------------------------
r126 | mvista.com!sdake | 2004-07-27 16:30:47 -0700 (Tue, 27 Jul 2004) | 2 lines

(Logical change 1.44)

------------------------------------------------------------------------
r125 | mvista.com!sdake | 2004-07-27 16:30:46 -0700 (Tue, 27 Jul 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r124 | mvista.com!sdake | 2004-07-27 16:27:13 -0700 (Tue, 27 Jul 2004) | 6 lines

Remove handle state and handle instance information.
Also cleanup saHandleCreate to return unsigned int
handle instead of int handle.

(Logical change 1.43)

------------------------------------------------------------------------
r123 | mvista.com!sdake | 2004-07-27 16:27:13 -0700 (Tue, 27 Jul 2004) | 5 lines

Hide handle state and handle instance information
in this file instead of in global header file.

(Logical change 1.43)

------------------------------------------------------------------------
r122 | mvista.com!sdake | 2004-07-27 16:27:13 -0700 (Tue, 27 Jul 2004) | 10 lines

util.h:
  Remove handle state and handle instance information.
  Also cleanup saHandleCreate to return unsigned int
  handle instead of int handle.
util.c:
  Hide handle state and handle instance information
  in this file instead of in global header file.

BKrev: 4106e4d1-Ntb973S5ymyNwgL6e0PDw

------------------------------------------------------------------------
r121 | mvista.com!sdake | 2004-07-26 15:17:36 -0700 (Mon, 26 Jul 2004) | 5 lines

Remove BINDTODEVICE socket option and replace with MULTICAST_IF
to be more portable and require less root privs.

(Logical change 1.42)

------------------------------------------------------------------------
r120 | mvista.com!sdake | 2004-07-26 15:17:36 -0700 (Mon, 26 Jul 2004) | 6 lines

gmi.c:
  Remove BINDTODEVICE socket option and replace with MULTICAST_IF
  to be more portable and require less root privs.

BKrev: 410583008afZgkQ66_jDep-8pFf_nw

------------------------------------------------------------------------
r119 | mvista.com!sdake | 2004-07-23 15:15:04 -0700 (Fri, 23 Jul 2004) | 5 lines

Additional information for using the saRecvQueue call in a
library.

(Logical change 1.41)

------------------------------------------------------------------------
r118 | mvista.com!sdake | 2004-07-23 15:15:04 -0700 (Fri, 23 Jul 2004) | 6 lines

README.devmap:
  Additional information for using the saRecvQueue call in a
  library.

BKrev: 41018de8tOmRhu_QtrtzbSGzWHSMKA

------------------------------------------------------------------------
r117 | mvista.com!sdake | 2004-07-20 16:47:28 -0700 (Tue, 20 Jul 2004) | 2 lines

(Logical change 1.40)

------------------------------------------------------------------------
r116 | mvista.com!sdake | 2004-07-20 16:47:28 -0700 (Tue, 20 Jul 2004) | 6 lines

SECURITY:
  Description of the security policy of the openais project.  Includes a
  description of the techniques used in openais.

BKrev: 40fdaf10zR42cuBrfB9UB-Bc-edNsQ

------------------------------------------------------------------------
r115 | mvista.com!sdake | 2004-07-20 16:47:27 -0700 (Tue, 20 Jul 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r114 | mvista.com!sdake | 2004-07-14 17:03:02 -0700 (Wed, 14 Jul 2004) | 4 lines

Major improvements to fragmentation.  It works alot better now.

(Logical change 1.39)

------------------------------------------------------------------------
r113 | mvista.com!sdake | 2004-07-14 17:03:02 -0700 (Wed, 14 Jul 2004) | 8 lines

Major improvements to quality in the GMI.  Previously with 12 processors
and running ckptstress from two nodes, one node would fail to make
forward progress.  Sometimes the nodes would assert or crash.  All the
fragmentation code has been rewritten to be more stable and of better
design (at the cost of a little more memory).

BKrev: 40f5c9b6KnXRw3_UyUgLV-cIvI7YpA

------------------------------------------------------------------------
r112 | mvista.com!sdake | 2004-07-13 10:20:56 -0700 (Tue, 13 Jul 2004) | 6 lines

Allow NULL delivery_fn in gmi_join.  This basically has no
effect but allows the processor to participate in multicasting
and membership.

(Logical change 1.38)

------------------------------------------------------------------------
r111 | mvista.com!sdake | 2004-07-13 10:20:56 -0700 (Tue, 13 Jul 2004) | 7 lines

gmi.c:
  Allow NULL delivery_fn in gmi_join.  This basically has no
  effect but allows the processor to participate in multicasting
  and membership.

BKrev: 40f419f8lTr8W134C7CXrtXRnzoMzw

------------------------------------------------------------------------
r110 | mvista.com!sdake | 2004-07-13 10:19:43 -0700 (Tue, 13 Jul 2004) | 7 lines

Extraneous tokens were not being rejected on token retransmits
that occurred during configuration changes.  The result was bad
behavior, especially with larger rings.  Also cleaned up the
token retransmit timer to be deleted if necessary.

(Logical change 1.37)

------------------------------------------------------------------------
r109 | mvista.com!sdake | 2004-07-13 10:19:43 -0700 (Tue, 13 Jul 2004) | 8 lines

gmi.c:
  Extraneous tokens were not being rejected on token retransmits
  that occurred during configuration changes.  The result was bad
  behavior, especially with larger rings.  Also cleaned up the
  token retransmit timer to be deleted if necessary.

BKrev: 40f419afbeZlmKywfUpsrDkU5kMnHg

------------------------------------------------------------------------
r108 | mvista.com!sdake | 2004-07-12 20:51:52 -0700 (Mon, 12 Jul 2004) | 4 lines

Add ip to deliver_fn callback

(Logical change 1.36)

------------------------------------------------------------------------
r107 | mvista.com!sdake | 2004-07-12 20:51:52 -0700 (Mon, 12 Jul 2004) | 4 lines

Add ip to deliver_fn callback

BKrev: 40f35c58ypi89e5Nq53F73OF8QGakA

------------------------------------------------------------------------
r106 | mvista.com!sdake | 2004-07-12 20:51:52 -0700 (Mon, 12 Jul 2004) | 6 lines

Add ip to deliver_fn callback
Add ip to deliver_fn callback
Add ip to deliver_fn callback

(Logical change 1.36)

------------------------------------------------------------------------
r105 | mvista.com!sdake | 2004-07-12 20:48:48 -0700 (Mon, 12 Jul 2004) | 4 lines

Removed something that was necessary in last changeset.

(Logical change 1.35)

------------------------------------------------------------------------
r104 | mvista.com!sdake | 2004-07-12 20:48:48 -0700 (Mon, 12 Jul 2004) | 5 lines

gmi.c:
  Removed something that was necessary in last changeset.

BKrev: 40f35ba0CGzAzJZVAZx-QxSIYzQlNQ

------------------------------------------------------------------------
r103 | mvista.com!sdake | 2004-07-12 14:46:02 -0700 (Mon, 12 Jul 2004) | 5 lines

gmi.c:
  Fix debug exit.

BKrev: 40f3069ao4cKWSuICZHrMdMIqJDlMw

------------------------------------------------------------------------
r102 | mvista.com!sdake | 2004-07-12 14:46:02 -0700 (Mon, 12 Jul 2004) | 4 lines

Fix debug exit.

(Logical change 1.34)

------------------------------------------------------------------------
r101 | mvista.com!sdake | 2004-07-12 14:40:31 -0700 (Mon, 12 Jul 2004) | 16 lines

Merge sdake@bk.osdl.org:/var/bk/openais
into persist.az.mvista.com:/home/sdake/openais

2004/07/12 14:40:19-07:00 mvista.com!sdake
gmi.c:
  When a processor left the membership, the next configuration would sometimes
  cause a form token timeout.  While not particularly harmful, it was wasteful
  and not part of the original design of the group messaging protocol.
  There was some extra junk code that was added to workaround some other bug
  that has since been fixed.
  This junk code removed and now the form token never times out (woohoo).
  Also removed some extra code that calculates the next ORF processor twice.
  We only really need to do it once.

BKrev: 40f3054fipDDp-KdB8CJpzw0vS3PfA

------------------------------------------------------------------------
r100 | mvista.com!sdake | 2004-07-12 14:40:31 -0700 (Mon, 12 Jul 2004) | 14 lines

Auto merged

2004/07/12 14:37:13-07:00 mvista.com!sdake
When a processor left the membership, the next configuration would sometimes
cause a form token timeout.  While not particularly harmful, it was wasteful
and not part of the original design of the group messaging protocol.
There was some extra junk code that was added to workaround some other bug
that has since been fixed.
This junk code removed and now the form token never times out (woohoo).
Also removed some extra code that calculates the next ORF processor twice.
We only really need to do it once.

(Logical change 1.33)

------------------------------------------------------------------------
r99 | broked.org!sdake | 2004-07-11 21:16:02 -0700 (Sun, 11 Jul 2004) | 8 lines

Retransmit orf token if no multicast or token received within a timeout
period.  This could mean that the token was lost, but no configuration
change has really occured.  Rather then execute the heavyweight
membership protocol, just retry the token and if it fails after the
token timeout, execute a configuration change sequence.

BKrev: 40f21082dvUxH0aOPvKmpqoqlkEgEA

------------------------------------------------------------------------
r98 | broked.org!sdake | 2004-07-11 21:16:02 -0700 (Sun, 11 Jul 2004) | 7 lines

Add retransmit of token if no multicast or token received
within a timeout period (100 msec).  This helps avoid
a reconfiguration when only the token is lost, but no
real configuration changes have occured.

(Logical change 1.32)

------------------------------------------------------------------------
r97 | broked.org!sdake | 2004-07-11 20:49:04 -0700 (Sun, 11 Jul 2004) | 5 lines

Changeset 1.22 introduced problem with managing messages
in the sort queue.  The result was memory leakage.

(Logical change 1.31)

------------------------------------------------------------------------
r96 | broked.org!sdake | 2004-07-11 20:49:04 -0700 (Sun, 11 Jul 2004) | 4 lines

Fix memory leak introduced in changeset 1.22.

BKrev: 40f20a301E28mF_1r27z43zk2MqHeA

------------------------------------------------------------------------
r95 | mvista.com!sdake | 2004-07-11 00:22:12 -0700 (Sun, 11 Jul 2004) | 4 lines

Clean up warnings found with -pedantic.

BKrev: 40f0eaa4fMlsgdXtJH-HQEl5nRh78Q

------------------------------------------------------------------------
r94 | mvista.com!sdake | 2004-07-11 00:22:12 -0700 (Sun, 11 Jul 2004) | 4 lines

Clean up warnings found with -pedantic.

(Logical change 1.30)

------------------------------------------------------------------------
r93 | mvista.com!sdake | 2004-07-11 00:22:12 -0700 (Sun, 11 Jul 2004) | 4 lines

Changed references to C99 initializers after pedantic cleanup

(Logical change 1.30)

------------------------------------------------------------------------
r92 | mvista.com!sdake | 2004-07-09 20:57:32 -0700 (Fri, 09 Jul 2004) | 6 lines

Removes the external dependency from the gmi to the global variable
this_ip.  This is still passed in for gmi_init users to be notified
of which IP was selected, but copied for local use.

BKrev: 40ef692cfv-e5JCQ8T9iC-_i3AaBcg

------------------------------------------------------------------------
r91 | mvista.com!sdake | 2004-07-09 20:57:32 -0700 (Fri, 09 Jul 2004) | 4 lines

Fixes build problem with rename of aispoll.c.

(Logical change 1.29)

------------------------------------------------------------------------
r90 | mvista.com!sdake | 2004-07-09 20:57:32 -0700 (Fri, 09 Jul 2004) | 6 lines

Removes this_ip external dependency and instead copies the
bound to address to storage local to the group messaging
interface.

(Logical change 1.29)

------------------------------------------------------------------------
r89 | mvista.com!sdake | 2004-07-09 14:35:41 -0700 (Fri, 09 Jul 2004) | 4 lines

Rename: exec/poll.h -> exec/aispoll.h

}(Logical change 1.28)

------------------------------------------------------------------------
r88 | mvista.com!sdake | 2004-07-09 14:35:41 -0700 (Fri, 09 Jul 2004) | 5 lines

Rename aispoll.h so that people using the aispoll header file do not
collide with sys/poll.h.

BKrev: 40ef0fadvg4jQb-J9VhBM25mh_mdMQ

------------------------------------------------------------------------
r87 | mvista.com!sdake | 2004-07-09 14:35:41 -0700 (Fri, 09 Jul 2004) | 4 lines

Rename: exec/poll.h -> exec/aispoll.h

(Logical change 1.28)

------------------------------------------------------------------------
r86 | mvista.com!sdake | 2004-07-09 14:35:41 -0700 (Fri, 09 Jul 2004) | 4 lines

Rename: exec/poll.c -> exec/aispoll.c

(Logical change 1.28)

------------------------------------------------------------------------
r85 | mvista.com!sdake | 2004-07-09 14:35:41 -0700 (Fri, 09 Jul 2004) | 4 lines

Rename: exec/poll.c -> exec/aispoll.c

}(Logical change 1.28)

------------------------------------------------------------------------
r84 | mvista.com!sdake | 2004-07-09 14:35:41 -0700 (Fri, 09 Jul 2004) | 4 lines

Rename poll.h to aispoll.h

(Logical change 1.28)

------------------------------------------------------------------------
r83 | mvista.com!sdake | 2004-07-09 14:35:40 -0700 (Fri, 09 Jul 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r82 | mvista.com!sdake | 2004-07-08 13:47:25 -0700 (Thu, 08 Jul 2004) | 6 lines

Fix a merge problem with the previous update to the amf with
the conn_info structure.
the track list was not being initialized at start.

(Logical change 1.27)

------------------------------------------------------------------------
r81 | mvista.com!sdake | 2004-07-08 13:47:25 -0700 (Thu, 08 Jul 2004) | 4 lines

Fix merge bugs from changeset 1.23.

BKrev: 40edb2ddF4jV4bxQYmbXj7nCSPCe2w

------------------------------------------------------------------------
r80 | mvista.com!sdake | 2004-07-08 13:47:25 -0700 (Thu, 08 Jul 2004) | 10 lines

Fix a couple merge problems with the previous update to clm with the
conn_info structure.
the track list was not being initialized.  When track start was called
the tracking wasn't added to a list.  When track stop was called
the tracking was not deleted.
The result of all this is that cluster membership tracking was broken
previously.

(Logical change 1.27)

------------------------------------------------------------------------
r79 | mvista.com!sdake | 2004-07-08 12:45:04 -0700 (Thu, 08 Jul 2004) | 5 lines

Development documentation update.  After reading these docs, it should
be possible to add a service to the AIS.

(Logical change 1.26)

------------------------------------------------------------------------
r78 | mvista.com!sdake | 2004-07-08 12:45:04 -0700 (Thu, 08 Jul 2004) | 4 lines

Learn how to develop an AIS service with README.devmap.

BKrev: 40eda440k9_Mia7kFQvGzgthaN_bWQ

------------------------------------------------------------------------
r77 | mvista.com!sdake | 2004-07-07 15:05:19 -0700 (Wed, 07 Jul 2004) | 4 lines

Fix build errors after previous commit.

(Logical change 1.25)

------------------------------------------------------------------------
r76 | mvista.com!sdake | 2004-07-07 15:05:19 -0700 (Wed, 07 Jul 2004) | 4 lines

Cleanup last commit so build occurs properly.

BKrev: 40ec739f-StbBZFtCXNnVcEbdIqOYg

------------------------------------------------------------------------
r75 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 6 lines

pass conn_info to all messages instead of file descriptor.
This requires changing the initialization phase of the socket
and all calls made.

(Logical change 1.24)

------------------------------------------------------------------------
r74 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 7 lines

Big cleanup of executive to pass connection info by reference instead
of having connection info as an array seperate from the poll interface.
This makes the code alot cleaner and easier to read, plus removes
duplicated code in the connection array management.

BKrev: 40ec72dd7wKGeQDubAA6lmUMc7JjOQ

------------------------------------------------------------------------
r73 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 4 lines

update todo by removing completed items.

(Logical change 1.24)

------------------------------------------------------------------------
r72 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 4 lines

store conn_info field is component structure.

(Logical change 1.24)

------------------------------------------------------------------------
r71 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 4 lines

pass conn_info to all messages instead of file descriptor.

(Logical change 1.24)

------------------------------------------------------------------------
r70 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 6 lines

pass conn_info to all messages instead of file descriptor.
this requires removing the connection structure and replacing
with the conn_info structure.

(Logical change 1.24)

------------------------------------------------------------------------
r69 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 5 lines

when gmi.c changed, full project would not always be rebuilt
fixed this issue.

(Logical change 1.24)

------------------------------------------------------------------------
r68 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 4 lines

Run full tests instead of writing a bunch of checkpoints.

(Logical change 1.24)

------------------------------------------------------------------------
r67 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 4 lines

Add track active variable to keep track of active connections.

(Logical change 1.24)

------------------------------------------------------------------------
r66 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 4 lines

cleanup valgrind warnings.

(Logical change 1.24)

------------------------------------------------------------------------
r65 | mvista.com!sdake | 2004-07-07 15:02:05 -0700 (Wed, 07 Jul 2004) | 6 lines

change message source to use conn_info field instead of fd.
Also removed a few unneeded calls which were moved to the
amf.c file.

(Logical change 1.24)

------------------------------------------------------------------------
r64 | mvista.com!sdake | 2004-07-07 14:12:01 -0700 (Wed, 07 Jul 2004) | 4 lines

Change memcpy to memmove to quiet down valgrind.

(Logical change 1.23)

------------------------------------------------------------------------
r63 | mvista.com!sdake | 2004-07-07 14:12:01 -0700 (Wed, 07 Jul 2004) | 6 lines

valgrind found an off-by-one error in message frees that could lead
to corruption.
l

(Logical change 1.23)

------------------------------------------------------------------------
r62 | mvista.com!sdake | 2004-07-07 14:12:01 -0700 (Wed, 07 Jul 2004) | 4 lines

Clean up some errors found with valgrind 2.1.1.

BKrev: 40ec6721IO7rAWx1t4cNnFNTugIZ1A

------------------------------------------------------------------------
r61 | mvista.com!sdake | 2004-07-07 14:12:01 -0700 (Wed, 07 Jul 2004) | 4 lines

Get rid of some errors from valgrind by initializing variables.

(Logical change 1.23)

------------------------------------------------------------------------
r60 | mvista.com!sdake | 2004-07-06 13:05:14 -0700 (Tue, 06 Jul 2004) | 4 lines

Remove extra unused parameter to exec messages.

(Logical change 1.22)

------------------------------------------------------------------------
r59 | mvista.com!sdake | 2004-07-06 13:05:14 -0700 (Tue, 06 Jul 2004) | 4 lines

Remove extra parameter to exec messages.

(Logical change 1.22)

------------------------------------------------------------------------
r58 | mvista.com!sdake | 2004-07-06 13:05:14 -0700 (Tue, 06 Jul 2004) | 6 lines

Every exec message was of the prototype int func (int fd, void *msg).
The "int fd" was not used by an executive message and was dead code from
a previous implementation.  This dead parameter removed from the tree.

BKrev: 40eb05fa_UbGyISyMyNciMoGXAXDeg

------------------------------------------------------------------------
r57 | mvista.com!sdake | 2004-07-06 12:25:41 -0700 (Tue, 06 Jul 2004) | 4 lines

Add activate poll message.

(Logical change 1.21)

------------------------------------------------------------------------
r56 | mvista.com!sdake | 2004-07-06 12:25:41 -0700 (Tue, 06 Jul 2004) | 4 lines

Use new APIs for handle reference counting

(Logical change 1.21)

------------------------------------------------------------------------
r55 | mvista.com!sdake | 2004-07-06 12:25:41 -0700 (Tue, 06 Jul 2004) | 6 lines

Change clunky locking used in library APIs to use reference counting
instead.  A BIG thanks to Chris Friesen who provided the initial ideas,
additional comments and more ideas leading up to the commit.

BKrev: 40eafcb50VMDbK4i9ZEiu0_90gFlPQ

------------------------------------------------------------------------
r54 | mvista.com!sdake | 2004-07-06 12:25:41 -0700 (Tue, 06 Jul 2004) | 4 lines

Fix example to use component names in example service group.

(Logical change 1.21)

------------------------------------------------------------------------
r53 | mvista.com!sdake | 2004-07-06 12:25:41 -0700 (Tue, 06 Jul 2004) | 5 lines

Change activate poll definitions to be generic instead of AMF
specific.

(Logical change 1.21)

------------------------------------------------------------------------
r52 | mvista.com!sdake | 2004-07-06 12:25:41 -0700 (Tue, 06 Jul 2004) | 4 lines

Use new APIs for handle reference counting.

(Logical change 1.21)

------------------------------------------------------------------------
r51 | mvista.com!sdake | 2004-07-06 12:25:41 -0700 (Tue, 06 Jul 2004) | 4 lines

add activate poll message

(Logical change 1.21)

------------------------------------------------------------------------
r50 | mvista.com!sdake | 2004-07-06 11:26:11 -0700 (Tue, 06 Jul 2004) | 5 lines

Fix segfault during membership changes with multiple leaves
at the same time.

BKrev: 40eaeec3CJrXaOzED0qddXmUUurQdg

------------------------------------------------------------------------
r49 | mvista.com!sdake | 2004-07-06 11:26:11 -0700 (Tue, 06 Jul 2004) | 6 lines

Wrong value being used to determine leave list, resulting in
a memcpy with a -1 value in some cases, and the incorrect memcpy
in other cases.

(Logical change 1.20)

------------------------------------------------------------------------
r48 | mvista.com!sdake | 2004-07-01 13:45:11 -0700 (Thu, 01 Jul 2004) | 6 lines

With a two node cluster and one node killed, the remaining node
didn't sent the appropriate configuration changes to the clm API
or to the rest of the services.

(Logical change 1.19)

------------------------------------------------------------------------
r47 | mvista.com!sdake | 2004-07-01 13:45:11 -0700 (Thu, 01 Jul 2004) | 5 lines

Fix two node cluster membership event not appearing on leave problem
reported by Chris Friesen.

BKrev: 40e477d75L2YauKHr18UGUlPGfAEoA

------------------------------------------------------------------------
r46 | mvista.com!sdake | 2004-07-01 11:03:30 -0700 (Thu, 01 Jul 2004) | 4 lines

remove dead code.

BKrev: 40e451f2-IOwwPNaNm65NetyBme-nw

------------------------------------------------------------------------
r45 | mvista.com!sdake | 2004-07-01 11:03:30 -0700 (Thu, 01 Jul 2004) | 4 lines

remove dead code.

(Logical change 1.18)

------------------------------------------------------------------------
r44 | mvista.com!sdake | 2004-06-30 12:07:39 -0700 (Wed, 30 Jun 2004) | 11 lines

The group messaging interface has been exported as a library for use
in other programs.  The key interfaces are exec/gmi.h and exec/poll.h.
gmi.h describes the interface for group messaging, while poll.h
describes the interface for abstracting poll system call with timers
and integrated with gmi.
By including these headers in programs and linking with libgmi, it is
possible to use the virtual synchrony layer (group messaging interface)
used in AIS for other applications.

BKrev: 40e30f7bM1KpRbp3-Bf2qVPRH1EsFA

------------------------------------------------------------------------
r43 | mvista.com!sdake | 2004-06-30 12:07:39 -0700 (Wed, 30 Jun 2004) | 4 lines

Initialize logging function in group messaging interface.

(Logical change 1.17)

------------------------------------------------------------------------
r42 | mvista.com!sdake | 2004-06-30 12:07:39 -0700 (Wed, 30 Jun 2004) | 4 lines

Build gmi static and shared library for use in other programs.

(Logical change 1.17)

------------------------------------------------------------------------
r41 | mvista.com!sdake | 2004-06-30 12:07:39 -0700 (Wed, 30 Jun 2004) | 4 lines

Add logging function init interface.

(Logical change 1.17)

------------------------------------------------------------------------
r40 | mvista.com!sdake | 2004-06-30 12:07:39 -0700 (Wed, 30 Jun 2004) | 5 lines

Add ability to pass in logging function for people that want to
use their own logging functions in their own programs.

(Logical change 1.17)

------------------------------------------------------------------------
r39 | mvista.com!sdake | 2004-06-30 12:07:39 -0700 (Wed, 30 Jun 2004) | 4 lines

add debug checking version of logging function.

(Logical change 1.17)

------------------------------------------------------------------------
r38 | mvista.com!sdake | 2004-06-30 12:07:39 -0700 (Wed, 30 Jun 2004) | 4 lines

make clean didn't remove ckptbench and ckptbenchth binaries

(Logical change 1.17)

------------------------------------------------------------------------
r37 | mvista.com!sdake | 2004-06-30 00:23:45 -0700 (Wed, 30 Jun 2004) | 8 lines

Chris Friesen reported the testamf programs don't work correctly.
Error in description of quickstart guide about how they
should work which has been corrected.
Also added information about using the ckptbench and
ckptbenchth programs to benchmark checkpoint writes.

(Logical change 1.16)

------------------------------------------------------------------------
r36 | mvista.com!sdake | 2004-06-30 00:23:45 -0700 (Wed, 30 Jun 2004) | 2 lines

(Logical change 1.16)

------------------------------------------------------------------------
r35 | mvista.com!sdake | 2004-06-30 00:23:45 -0700 (Wed, 30 Jun 2004) | 6 lines

Modify QUICKSTART to clarify how testamf{1-6} work and added some
text about using the ckptbench and ckptbenchth test programs.  Also
added the ckptbench and ckptbenchth programs to the build environment.

BKrev: 40e26a810DYCs3LU79Ne-q51pO2TgA

------------------------------------------------------------------------
r34 | mvista.com!sdake | 2004-06-30 00:23:45 -0700 (Wed, 30 Jun 2004) | 4 lines

Add ckptbench and ckptbenchth targets

(Logical change 1.16)

------------------------------------------------------------------------
r33 | mvista.com!sdake | 2004-06-30 00:23:44 -0700 (Wed, 30 Jun 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r32 | mvista.com!sdake | 2004-06-28 15:04:20 -0700 (Mon, 28 Jun 2004) | 5 lines

Cluster membership API not being authenticated by openais executive.
This results in testclm locking on start in saClmInitialize.

BKrev: 40e095e4VUojyuQYOBeAUqjZnbBTCA

------------------------------------------------------------------------
r31 | mvista.com!sdake | 2004-06-28 15:04:20 -0700 (Mon, 28 Jun 2004) | 4 lines

Fix cluster membership API not being authenticated bug.

(Logical change 1.15)

------------------------------------------------------------------------
r30 | mvista.com!sdake | 2004-06-27 14:01:24 -0700 (Sun, 27 Jun 2004) | 6 lines

Make bind to a device really work properly.  Now
it is possible to specify the bind network and
the networking will take place over that interface.

(Logical change 1.14)

------------------------------------------------------------------------
r29 | mvista.com!sdake | 2004-06-27 14:01:24 -0700 (Sun, 27 Jun 2004) | 6 lines

Add priv drop so process doesn't have to run
as root in order to lock, set RR 99, and
bind to a specific ethernet interface for multicast.

(Logical change 1.14)

------------------------------------------------------------------------
r28 | mvista.com!sdake | 2004-06-27 14:01:24 -0700 (Sun, 27 Jun 2004) | 5 lines

Make binding to a specific network really work.  Also added priv
dropping so process doesn't have to run as root for process lifetime.

BKrev: 40df35a4eUCTfC660C7oBwg-P9YE2g

------------------------------------------------------------------------
r27 | mvista.com!sdake | 2004-06-23 14:01:32 -0700 (Wed, 23 Jun 2004) | 7 lines

Yixiong Zou reported a problem where on some OSes the aisexec
couldn't join the multicast group.  This problem fixed.  Also
changed binding rules for sockets relating to the group messaging.
see detailed changlogs for more details.

BKrev: 40d9efacQooUDhv3APjn55QVVjMueg

------------------------------------------------------------------------
r26 | mvista.com!sdake | 2004-06-23 14:01:32 -0700 (Wed, 23 Jun 2004) | 14 lines

Fix binding rules so that instead of binding to INADDR_ANY for
UDP sockets, bind to specific interface defined in network.conf.
This is done by creating two fds.  gmi_fd_token is used for all
token communication.  gmi_fd_mcast is used for all mcast
communication.  I'm not sure if gmi_fd_mcast binding rules is
correct.  Once work begins on multipathing, this will have to
be figured out :)

2004/06/23 13:55:52-07:00 mvista.com!sdake
Use portable mreq instead of mreqn when joining the multicast
group.

(Logical change 1.13)

------------------------------------------------------------------------
r25 | mvista.com!sdake | 2004-06-22 23:19:43 -0700 (Tue, 22 Jun 2004) | 8 lines

QUICKSTART:
  Modified quickstart guide thanks to comments from Yixiong Zou
  Information about adding groups added
  Information about testclm blocking until cluster membership
  event occurs added.

BKrev: 40d920ffgjnZO35fZ2d947AV5TWGWQ

------------------------------------------------------------------------
r24 | mvista.com!sdake | 2004-06-22 23:19:43 -0700 (Tue, 22 Jun 2004) | 7 lines

Modified quickstart guide thanks to comments from Yixiong Zou
Information about adding groups added
Information about testclm blocking until cluster membership
event occurs added.

(Logical change 1.12)

------------------------------------------------------------------------
r23 | mvista.com!sdake | 2004-06-21 01:08:30 -0700 (Mon, 21 Jun 2004) | 9 lines

Buffer with message data used outside lock.  This creates a possible race
where data from another response could be used to execute a dispatch.

2004/06/21 00:59:54-07:00 mvista.com!sdake
Remove double pthread_mutex_unlock on saAmfDispatch routine.  Unlock could
unlock another thread's unlock midthread.

(Logical change 1.11)

------------------------------------------------------------------------
r22 | mvista.com!sdake | 2004-06-21 01:08:30 -0700 (Mon, 21 Jun 2004) | 5 lines

Fix race with saClmDispatch where two threads could race
for access to the response data from the AIS Executive.

(Logical change 1.11)

------------------------------------------------------------------------
r21 | mvista.com!sdake | 2004-06-21 01:08:30 -0700 (Mon, 21 Jun 2004) | 4 lines

Fix race relating to threads and saClmDispatch/saAmfDispatch.

BKrev: 40d6977ewZ8VFYD8mJyEaPWxg0tI7w

------------------------------------------------------------------------
r20 | mvista.com!sdake | 2004-06-20 00:35:39 -0700 (Sun, 20 Jun 2004) | 5 lines

Add support for C++ linkage to cluster membership API.
Without this change, C++ programs will not link to the library.

BKrev: 40d53e4bzcKNiPnfX523_065NBw4gg

------------------------------------------------------------------------
r19 | mvista.com!sdake | 2004-06-20 00:35:39 -0700 (Sun, 20 Jun 2004) | 4 lines

Add support for C++ linkage to cluster membership APIs.

(Logical change 1.10)

------------------------------------------------------------------------
r18 | mvista.com!sdake | 2004-06-20 00:30:46 -0700 (Sun, 20 Jun 2004) | 4 lines

Port not actually set to correct port as found with tcpdump.

BKrev: 40d53d26QDtzR8msp2zMvJ-9Mq6-Tw

------------------------------------------------------------------------
r17 | mvista.com!sdake | 2004-06-20 00:30:46 -0700 (Sun, 20 Jun 2004) | 6 lines

x86 was not setting port to network byte order, which resulted in
port being byte swapped.  This of course, doesn't work well with
xscale boards.

(Logical change 1.9)

------------------------------------------------------------------------
r16 | mvista.com!sdake | 2004-06-18 14:15:44 -0700 (Fri, 18 Jun 2004) | 4 lines

quickstart gives incorrect info about multicast addresses, now corrected.

BKrev: 40d35b80BGcr_8TvtSlrbEZBn14zZA

------------------------------------------------------------------------
r15 | mvista.com!sdake | 2004-06-18 14:15:44 -0700 (Fri, 18 Jun 2004) | 4 lines

fix error in quickstart

(Logical change 1.8)

------------------------------------------------------------------------
r14 | mvista.com!sdake | 2004-06-17 16:50:26 -0700 (Thu, 17 Jun 2004) | 4 lines

Fix single-node AMF assertion failure (cause runaway recursion).

BKrev: 40d22e42IsByk3WqoRIGSlETLqdUgw

------------------------------------------------------------------------
r13 | mvista.com!sdake | 2004-06-17 16:50:26 -0700 (Thu, 17 Jun 2004) | 7 lines

single node AMF would fail because of a recursion bug.  Removed
the recursion by queueing single node message delivery as a timer
with 0 timeout.  This was happening before, but the logic was
wrong.

(Logical change 1.7)

------------------------------------------------------------------------
r12 | mvista.com!sdake | 2004-06-17 14:54:28 -0700 (Thu, 17 Jun 2004) | 4 lines

Crash when no network.conf file present (missing error checking).

(Logical change 1.6)

------------------------------------------------------------------------
r11 | mvista.com!sdake | 2004-06-17 14:54:28 -0700 (Thu, 17 Jun 2004) | 4 lines

Fix crash when error reading network.conf file.

BKrev: 40d21314UfLNnjjrMSt_4U9rJZSVHA

------------------------------------------------------------------------
r10 | mvista.com!sdake | 2004-06-16 15:50:39 -0700 (Wed, 16 Jun 2004) | 11 lines

Fix bug in membership protocol where form token sometimes times out
because the initial send of the token is sent to the wrong address.

2004/06/16 15:42:49-07:00 mvista.com!sdake
Performance enhancements: Allow more messages to be multicast per
token possession to reach 8.8MB/sec checkpoint performance without
remcasts.  Trim gather/commit timeouts to 100 msec to speed up the
membership gathering process.

(Logical change 1.5)

------------------------------------------------------------------------
r9 | mvista.com!sdake | 2004-06-16 15:50:39 -0700 (Wed, 16 Jun 2004) | 4 lines

Bug fix and performance enhancements to the group messaging protocol.

BKrev: 40d0cebf3iPVrudikdxGEhhTs-CQMw

------------------------------------------------------------------------
r8 | mvista.com!sdake | 2004-06-15 23:10:39 -0700 (Tue, 15 Jun 2004) | 5 lines

QUICKSTART:
  Test change

BKrev: 40cfe45fPOa0mbN6jPO9bRiSG_tZWA

------------------------------------------------------------------------
r7 | mvista.com!sdake | 2004-06-15 23:10:39 -0700 (Tue, 15 Jun 2004) | 4 lines

Test change

(Logical change 1.4)

------------------------------------------------------------------------
r6 | osdl.net!cherry | 2004-06-15 15:18:04 -0700 (Tue, 15 Jun 2004) | 4 lines

Import changeset

BKrev: 40cf759cAkpvgQbZ43nWNRClHYqlXQ

------------------------------------------------------------------------
r5 | osdl.net!cherry | 2004-06-15 15:18:04 -0700 (Tue, 15 Jun 2004) | 2 lines

(Logical change 1.3)

------------------------------------------------------------------------
r4 | osdl.net!cherry | 2004-06-15 15:18:03 -0700 (Tue, 15 Jun 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r3 | osdl.net!cem | 2004-06-15 15:16:01 -0700 (Tue, 15 Jun 2004) | 4 lines

Initial repository create

BKrev: 40cf7521T7yNtYdteqiCUMgD7RdOCA

------------------------------------------------------------------------
r2 | osdl.net!cem | 2004-06-15 15:16:00 -0700 (Tue, 15 Jun 2004) | 2 lines

Initial revision

------------------------------------------------------------------------
r1 | (no author) | 2004-06-15 15:16:00 -0700 (Tue, 15 Jun 2004) | 1 line

New repository initialized by cvs2svn.
------------------------------------------------------------------------
